import{_ as E,h as l,c as s,n as V,a as n,d as O,e as w,w as N,k as y,t as p,F as u,M as me,r as B,N as W,O as H,f as D,p as G,j as J,l as M,v as S,o as oe,P as be,Q as ne,S as se,x as ye,E as Q,b as P,R as ge,U as re,L as ie,i as ke,K as Ce,u as $e,s as je,q as Pe,m as we,V as Te,T as Se,A as xe,D as Ie}from"./index.59122350.js";import{A as Ne}from"./AdvancedSearch.c7746a06.js";import{P as Re}from"./ProfilesTable.e7e01bc8.js";import{E as Ae}from"./ErrorMessage.cd21733c.js";const Be={},Ee={class:"tooltip"},Oe={class:"tooltip-text"};function Le(r,e){return l(),s("span",Ee,[V(r.$slots,"default",{},void 0,!0),n("span",Oe,[V(r.$slots,"text",{},void 0,!0)])])}const Ve=E(Be,[["render",Le],["__scopeId","data-v-5b46f6b0"]]),De=["href"],Fe=O({__name:"PredCell",props:{iri:null,qname:null,label:null,description:null,explanation:null},setup(r){const e=r;return(i,C)=>(l(),s("th",null,[(l(),w(me(e.description?Ve:"slot"),null,{text:N(()=>[y(p(e.description),1)]),default:N(()=>[n("a",{href:e.iri,target:"_blank",rel:"noopener noreferrer"},[e.label?(l(),s(u,{key:0},[y(p(e.label),1)],64)):e.qname?(l(),s(u,{key:1},[y(p(e.qname),1)],64)):(l(),s(u,{key:2},[y(p(e.iri),1)],64))],8,De)]),_:1}))]))}}),Ue=r=>(G("data-v-bec69227"),r=r(),J(),r),ze={class:"prop-obj"},Me={class:"obj-value"},qe={key:0},Qe=["href"],We=["href"],He=["href"],Ge=["href"],Je={key:1,class:"geom-cell"},Ke=Ue(()=>n("i",{class:"fa-regular fa-clipboard"},null,-1)),Xe=[Ke],Ye={class:"obj-tag"},Ze={key:0,class:"badge outline",title:"Language"},et=["href"],tt=O({__name:"ObjCell",props:{value:null,qname:null,datatype:null,language:null,description:null,termType:null,label:null,rows:null},setup(r){const e=r,i=["http://www.opengis.net/ont/geosparql#geoJSONLiteral","http://www.opengis.net/ont/geosparql#wktLiteral"],C=100;function $(o){navigator.clipboard.writeText(o.trim())}return(o,g)=>(l(),s("div",ze,[n("div",Me,[e.termType==="BlankNode"?(l(),s("table",qe,[(l(!0),s(u,null,B(e.rows,m=>(l(),w(ue,W(H(m)),null,16))),256))])):e.termType==="NamedNode"?(l(),s(u,{key:1},[e.label?(l(),s("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},p(e.label),9,Qe)):e.qname?(l(),s("a",{key:1,href:e.value,target:"_blank",rel:"noopener noreferrer"},p(e.qname),9,We)):(l(),s("a",{key:2,href:e.value,target:"_blank",rel:"noopener noreferrer"},p(e.value),9,He))],64)):(l(),s(u,{key:2},[e.value.startsWith("http")?(l(),s("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},p(e.value),9,Ge)):e.datatype&&i.includes(e.datatype.value)?(l(),s("div",Je,[n("pre",null,p(e.value.length>C?`${e.value.slice(0,C)}...`:e.value),1),n("button",{class:"btn outline sm",title:"Copy geometry",onClick:g[0]||(g[0]=m=>$(e.value))},Xe)])):(l(),s(u,{key:2},[y(p(e.value),1)],64))],64))]),n("div",Ye,[e.language?(l(),s("span",Ze,p(e.language),1)):e.datatype?(l(),s("a",{key:1,href:e.datatype.value,target:"_blank",rel:"noopener noreferrer",class:"badge outline",title:"Datatype"},[e.datatype.qname?(l(),s(u,{key:0},[y(p(e.datatype.qname),1)],64)):(l(),s(u,{key:1},[y(p(e.datatype.value),1)],64))],8,et)):D("",!0)])]))}});const lt=E(tt,[["__scopeId","data-v-bec69227"]]),at={class:"prop-objs"},nt=O({__name:"PropRow",props:{iri:null,objs:null,qname:null,label:null,description:null,explanation:null,order:null},setup(r){const e=r;return(i,C)=>(l(),s("tr",null,[M(Fe,{iri:e.iri,qname:e.qname,label:e.label,description:e.description,explanation:e.explanation},null,8,["iri","qname","label","description","explanation"]),n("td",at,[(l(!0),s(u,null,B(e.objs,$=>(l(),w(lt,W(H($)),null,16))),256))])]))}});const ue=E(nt,[["__scopeId","data-v-3863cf0a"]]),K=r=>(G("data-v-cbd867fe"),r=r(),J(),r),ot={class:"page-title"},st={class:"iri"},rt=K(()=>n("span",{class:"badge"},"IRI",-1)),it=["href"],ut=K(()=>n("i",{class:"fa-regular fa-clipboard"},null,-1)),ct=[ut],pt={class:"type"},dt=K(()=>n("span",{class:"badge"},"Type",-1)),ft=["href"],_t={key:0},vt=O({__name:"PropTableNew",props:{item:null,properties:null,blankNodes:null,prefixes:null,hiddenPreds:null},setup(r){const e=r,i=S([]);function C(v){let _="";return Object.entries(e.prefixes).forEach(([t,x])=>{v.value.startsWith(x)&&(_=t+":"+v.value.split(x)[1])}),_}function $(v){if(v==="a")return e.prefixes.rdf+"type";{const[_,t]=v.split(":");return e.prefixes[_]+t}}function o(v,_){return v.annotations.find(t=>t.predicate.value===$(_))?.object.value}function g(){navigator.clipboard.writeText(e.item.iri.trim())}function m(v){let _={};return v.forEach(t=>{var x;_[x=t.predicate.value]??(_[x]={iri:t.predicate.value,objs:[],qname:C(t.predicate),label:o(t.predicate,"rdfs:label"),description:o(t.predicate,"dcterms:description"),explanation:o(t.predicate,"dcterms:provenance"),order:0}),_[t.predicate.value].objs.push({value:t.object.value,qname:t.object instanceof be?C(t.object):void 0,datatype:t.object instanceof ne?{value:t.object.datatype.value,qname:C(t.object.datatype)}:void 0,language:t.object instanceof ne?t.object.language:void 0,description:void 0,termType:t.object.termType,label:void 0,rows:t.object instanceof se?m(e.blankNodes.filter(A=>A.subject.id===t.object.id)):[]})}),Object.values(_).sort((t,x)=>t.order-x.order)}return oe(()=>{const v=e.properties.filter(_=>!e.hiddenPreds.includes(_.predicate.value));i.value=m(v)}),(v,_)=>(l(),s(u,null,[n("h1",ot,[y(p(e.item.title||e.item.iri)+" ",1),n("small",st,[rt,n("a",{href:e.item.iri,target:"_blank",rel:"noopener noreferrer"},p(e.item.iri),9,it),n("button",{class:"btn outline sm",title:"Copy IRI",onClick:_[0]||(_[0]=t=>g())},ct)]),n("small",pt,[dt,n("a",{href:e.item.type,target:"_blank",rel:"noopener noreferrer"},p(e.item.type),9,ft)])]),V(v.$slots,"map",{},void 0,!0),e.item.description?(l(),s("p",_t,[n("em",null,p(e.item.description),1)])):D("",!0),n("table",null,[V(v.$slots,"top",{},void 0,!0),(l(!0),s(u,null,B(i.value,t=>(l(),w(ue,W(H(t)),null,16))),256)),V(v.$slots,"bottom",{},void 0,!0)])],64))}});const ht=E(vt,[["__scopeId","data-v-cbd867fe"]]),mt={class:"concept-top"},bt={key:1,class:"concept-left"},yt=O({__name:"ConceptComponent",props:{iri:null,title:null,link:null,children:null,narrower:null,broader:null,baseUrl:null,collapseAll:{type:Boolean}},setup(r){const e=r,i=S(!0);return ye(()=>e.collapseAll,(C,$)=>{i.value=C}),(C,$)=>{const o=ie("ConceptComponent",!0);return l(),s(u,null,[n("div",mt,[e.children?(l(),s("button",{key:0,class:"concept-left btn outline",onClick:$[0]||($[0]=g=>i.value=!i.value)},[n("i",{class:Q(`fa-regular fa-${i.value?"plus":"minus"}`)},null,2)])):(l(),s("div",bt)),M(P(ge),{class:"concept",to:e.link},{default:N(()=>[y(p(e.title||e.iri),1)]),_:1},8,["to"])]),e.children?(l(),s("div",{key:0,class:Q(`concept-children ${i.value?"collapse":""}`)},[(l(!0),s(u,null,B(e.children,g=>(l(),w(o,re(g,{baseUrl:e.baseUrl,collapseAll:e.collapseAll}),null,16,["baseUrl","collapseAll"]))),256))],2)):D("",!0)],64)}}});const gt=E(yt,[["__scopeId","data-v-e0711a9f"]]),L=r=>(G("data-v-63686d0b"),r=r(),J(),r),kt=L(()=>n("th",null,"Concepts",-1)),Ct=L(()=>n("i",{class:"fa-regular fa-chevron-down"},null,-1)),$t=L(()=>n("i",{class:"fa-regular fa-chevron-up"},null,-1)),jt=L(()=>n("i",{class:"fa-regular fa-plus"},null,-1)),Pt=L(()=>n("i",{class:"fa-regular fa-minus"},null,-1)),wt=L(()=>n("i",{class:"fa-regular fa-spinner-third fa-spin"},null,-1)),Tt=O({__name:"PropTableView",props:{type:null,getChildren:{type:Boolean,default:!1},childPred:{default:""},childTitlePred:{default:""},childDisplayTitle:{default:"Members"},childButton:null,enableSearch:{type:Boolean}},setup(r){const e=r,{namedNode:i}=Ie,C=5,$=ke(xe),o=Ce(),g=$e(),{store:m,prefixes:v,parseIntoStore:_,qname:t}=je(),{data:x,profiles:A,loading:ce,error:X,doRequest:pe}=Pe();let Y=[t("a"),t("dcterms:identifier"),t("prez:count"),...e.type==="skos:ConceptScheme"?[t("skos:hasTopConcept")]:[],...e.childPred?[t(e.childPred)]:[]];const R=we(()=>o.path.startsWith("/c/")?"CatPrez":o.path.startsWith("/s/")?"SpacePrez":o.path.startsWith("/v/")?"VocPrez":void 0),k=S({}),Z=S([]),ee=S([]),q=S([]),te=S([]),F=S(!1),U=S(!0),I=S(!1);function le(a,c){return{subject:a.subject,predicate:{termType:a.predicate.termType,value:a.predicate.value,id:a.predicate.id,annotations:c.getQuads(a.predicate,null,null,null)},object:a.object,value:a.value,graph:a.graph,termType:a.termType,equals:a.equals,toJSON:a.toJSON}}function ae(a,c,h){a.object instanceof se&&(h++,c.forEach(b=>{const d=le(b,c);te.value.push(d),h<C&&ae(b,c,h)},a.object,null,null,null))}function de(){const a=m.value.getSubjects(i(t("a")),i(t(e.type)),null)[0];k.value.iri=a.id;const c=A.value.find(d=>d.default);let h=t("rdfs:label"),b=t("dcterms:description");if(Object.keys(g.profiles).includes(c.uri)){const d=g.profiles[c.uri];d.labelPredicate&&(h=d.labelPredicate),d.descPredicate&&(b=d.descPredicate)}Y.push(h,b),m.value.forEach(d=>{if(d.predicate.value===h?k.value.title=d.object.value:d.predicate.value===b?k.value.description=d.object.value:d.predicate.value===t("a")&&(k.value.type=d.object.value),!I.value){const z=le(d,m.value);q.value.push(z);let f=0;ae(d,m.value,f)}},a,null,null,null)}function fe(){let a=[];m.value.forSubjects(f=>{let j={iri:f.id,narrower:[],broader:"",title:"",link:""};m.value.forEach(T=>{T.predicate.value===t(e.childTitlePred)?j.title=T.object.value:T.predicate.value===t("prez:link")?j.link=T.object.value:T.predicate.value===t("skos:narrower")?j.narrower.push(T.object.value):T.predicate.value===t("skos:broader")&&(j.broader=T.object.value)},f,null,null,null),a.push(j)},i(t("skos:inScheme")),i(k.value.iri),null);const c=m.value.getObjects(i(k.value.iri),i(t("skos:hasTopConcept")),null).map(f=>f.id),h=m.value.getSubjects(i(t("skos:topConceptOf")),i(k.value.iri),null).map(f=>f.id),b=[...new Set([...c,...h])],d=a.reduce((f,j,T)=>(f[j.iri]=T,f),{});let z=[];a.forEach(f=>{if(f.narrower.length>0&&f.narrower.forEach(j=>a[d[j]].broader=f.iri),b.includes(f.iri)){z.push(f);return}if(f.broader){const j=a[d[f.broader]];j.children=[...j.children||[],f]}}),ee.value=z}function _e(){e.type==="skos:ConceptScheme"?fe():m.value.forObjects(a=>{let c={iri:a.id};m.value.forEach(h=>{h.predicate.value===t(e.childTitlePred)?c.title=h.object.value:h.predicate.value===t("prez:link")&&(c.link=h.object.value)},a,null,null,null),Z.value.push(c)},i(k.value.iri),i(t(e.childPred)),null)}function ve(){let a=[];return R.value?(a.push({name:R.value,url:`/${R.value[0].toLowerCase()}`}),["ConceptInCollection"].includes(e.type)&&a.push({name:"Collections",url:"/v/collection"}),["ConceptInCollection"].includes(e.type)&&a.push({name:"Collection",url:`/v/collection/${o.params.collectionId}`}),["skos:ConceptScheme","skos:Concept"].includes(e.type)&&a.push({name:"Vocabs",url:"/v/vocab"}),["skos:Concept"].includes(e.type)&&a.push({name:"Vocab",url:`/v/vocab/${o.params.vocabId}`}),["skos:Collection"].includes(e.type)&&a.push({name:"Collections",url:"/v/collection"}),["dcat:Catalog","dcat:Resource"].includes(e.type)&&a.push({name:"Catalogs",url:"/c/catalogs"}),["dcat:Resource"].includes(e.type)&&a.push({name:"Catalog",url:`/c/catalogs/${o.params.catalogId}`}),["dcat:Dataset","geo:FeatureCollection","geo:Feature"].includes(e.type)&&a.push({name:"Datasets",url:"/s/datasets"}),["geo:FeatureCollection","geo:Feature"].includes(e.type)&&(a.push({name:"Dataset",url:`/s/datasets/${o.params.datasetId}`}),a.push({name:"Feature Collections",url:`/s/datasets/${o.params.datasetId}/collections`})),["geo:Feature"].includes(e.type)&&(a.push({name:"Feature Collection",url:`/s/datasets/${o.params.datasetId}/collections/${o.params.featureCollectionId}`}),a.push({name:"Features",url:`/s/datasets/${o.params.datasetId}/collections/${o.params.featureCollectionId}/items`}))):e.type==="prof:Profile"&&a.push({name:"Profiles",url:"/profiles"}),a}function he(){if(e.enableSearch)switch(e.type){case"skos:ConceptScheme":return{vocab:k.value.iri};case"dcat:Catalog":return{catalog:k.value.iri};case"dcat:Dataset":return{dataset:k.value.iri};case"geo:FeatureCollection":return{collection:k.value.iri};default:return{}}else return{}}return oe(()=>{pe(`${$}${o.path}`,()=>{if(o.query&&o.query._profile){const a=A.value.find(c=>c.default);o.query._profile===a.token&&!o.query._mediatype?I.value=!1:o.query._profile==="alt"&&!o.query._mediatype?I.value=!0:window.location.replace(`${$}${o.path}?_profile=${o.query._profile}${o.query._mediatype?`&_mediatype=${o.query._mediatype}`:""}`)}else I.value=!1;_(x.value),de(),!I.value&&e.getChildren&&_e(),I.value?g.rightNavConfig={enabled:!1}:g.rightNavConfig={enabled:!0,profiles:A.value,currentUrl:o.path},document.title=`${k.value.title||e.type.split(":")[1]} | Prez`,R.value?g.pageHeading={name:R.value,url:`/${R.value[0].toLowerCase()}`}:g.pageHeading={name:"Prez",url:"/"},g.breadcrumbs=[...ve(),{name:k.value.title||e.type.split(":")[1],url:o.path},...I.value?[{name:"Alternate Profiles",url:`${o.path}?_profile=alt`}]:[]]})}),(a,c)=>{const h=ie("RouterLink");return I.value?(l(),w(Re,{key:0,profiles:P(A),path:P(o).path},null,8,["profiles","path"])):(l(),s(u,{key:1},[q.value.length>0?(l(),w(ht,{key:0,item:k.value,properties:q.value,blankNodes:te.value,prefixes:P(v),hiddenPreds:P(Y)},Te({_:2},[e.type==="skos:ConceptScheme"?{name:"bottom",fn:N(()=>[n("tr",null,[kt,n("td",null,[n("button",{id:"concept-hide-btn",class:"btn",onClick:c[0]||(c[0]=b=>F.value=!F.value)},[F.value?(l(),s(u,{key:0},[y("Show "),Ct],64)):(l(),s(u,{key:1},[y("Hide "),$t],64))]),n("div",{class:Q(`concepts ${F.value?"collapse":""}`)},[n("button",{id:"collapse-all-btn",onClick:c[1]||(c[1]=b=>U.value=!U.value),class:"btn"},[U.value?(l(),s(u,{key:0},[jt,y(" Expand all")],64)):(l(),s(u,{key:1},[Pt,y(" Collapse all")],64))]),(l(!0),s(u,null,B(ee.value,b=>(l(),w(gt,re(b,{baseUrl:P(o).path,collapseAll:U.value}),null,16,["baseUrl","collapseAll"]))),256))],2)])])]),key:"0"}:e.getChildren?{name:"bottom",fn:N(()=>[n("tr",null,[n("th",null,p(e.childDisplayTitle),1),n("td",null,[n("div",{class:"children-list"},[(l(!0),s(u,null,B(Z.value,b=>(l(),w(h,{to:b.link||""},{default:N(()=>[y(p(b.title||b.iri),1)]),_:2},1032,["to"]))),256))])])])]),key:"1"}:e.childButton?{name:"bottom",fn:N(()=>[n("tr",null,[n("th",null,"Members"),n("td",null,[M(h,{to:`${P(o).path}${e.childButton.url}`,class:"btn"},{default:N(()=>[y(p(e.childButton.name),1)]),_:1},8,["to"])])])]),key:"2"}:void 0]),1032,["item","properties","blankNodes","prefixes","hiddenPreds"])):P(ce)?(l(),s(u,{key:1},[wt,y(" Loading... ")],64)):P(X)?(l(),w(Ae,{key:2,message:P(X)},null,8,["message"])):D("",!0),e.enableSearch?(l(),w(Se,{key:3,to:"#right-bar-content"},[M(Ne,{flavour:P(R),query:he()},null,8,["flavour","query"])])):D("",!0)],64))}}});const Rt=E(Tt,[["__scopeId","data-v-63686d0b"]]);export{Rt as default};
