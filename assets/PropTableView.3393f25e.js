import{_ as L,h as l,c as s,q as U,a as o,d as V,e as P,w as I,k as g,t as f,F as p,O as be,r as A,P as G,Q as H,f as O,p as J,j as K,l as W,x as T,o as se,S as ye,U as ne,V as re,y as ge,G as q,b as w,R as ke,W as ie,N as ue,i as Ce,M as $e,u as je,v as Pe,s as we,m as Te,X as xe,T as Se,B as Ie,n as Ne,D as Be}from"./index.6f5c308d.js";import{A as Re}from"./AdvancedSearch.da6fa321.js";import{P as Ee}from"./ProfilesTable.93f35d90.js";import{E as Oe}from"./ErrorMessage.f3d82b45.js";import{_ as Ae}from"./MapClient.vue_vue_type_script_setup_true_lang.e1a63fa6.js";const Le={},Ve={class:"tooltip"},De={class:"tooltip-text"};function Fe(r,e){return l(),s("span",Ve,[U(r.$slots,"default",{},void 0,!0),o("span",De,[U(r.$slots,"text",{},void 0,!0)])])}const Ue=L(Le,[["render",Fe],["__scopeId","data-v-5b46f6b0"]]),ze=["href"],Me=V({__name:"PredCell",props:{iri:null,qname:null,label:null,description:null,explanation:null},setup(r){const e=r;return(i,$)=>(l(),s("th",null,[(l(),P(be(e.description?Ue:"slot"),null,{text:I(()=>[g(f(e.description),1)]),default:I(()=>[o("a",{href:e.iri,target:"_blank",rel:"noopener noreferrer"},[e.label?(l(),s(p,{key:0},[g(f(e.label),1)],64)):e.qname?(l(),s(p,{key:1},[g(f(e.qname),1)],64)):(l(),s(p,{key:2},[g(f(e.iri),1)],64))],8,ze)]),_:1}))]))}}),We=r=>(J("data-v-bec69227"),r=r(),K(),r),Qe={class:"prop-obj"},qe={class:"obj-value"},Ge={key:0},He=["href"],Je=["href"],Ke=["href"],Xe=["href"],Ye={key:1,class:"geom-cell"},Ze=We(()=>o("i",{class:"fa-regular fa-clipboard"},null,-1)),et=[Ze],tt={class:"obj-tag"},lt={key:0,class:"badge outline",title:"Language"},at=["href"],ot=V({__name:"ObjCell",props:{value:null,qname:null,datatype:null,language:null,description:null,termType:null,label:null,rows:null},setup(r){const e=r,i=["http://www.opengis.net/ont/geosparql#geoJSONLiteral","http://www.opengis.net/ont/geosparql#wktLiteral"],$=100;function j(n){navigator.clipboard.writeText(n.trim())}return(n,k)=>(l(),s("div",Qe,[o("div",qe,[e.termType==="BlankNode"?(l(),s("table",Ge,[(l(!0),s(p,null,A(e.rows,h=>(l(),P(ce,G(H(h)),null,16))),256))])):e.termType==="NamedNode"?(l(),s(p,{key:1},[e.label?(l(),s("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},f(e.label),9,He)):e.qname?(l(),s("a",{key:1,href:e.value,target:"_blank",rel:"noopener noreferrer"},f(e.qname),9,Je)):(l(),s("a",{key:2,href:e.value,target:"_blank",rel:"noopener noreferrer"},f(e.value),9,Ke))],64)):(l(),s(p,{key:2},[e.value.startsWith("http")?(l(),s("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},f(e.value),9,Xe)):e.datatype&&i.includes(e.datatype.value)?(l(),s("div",Ye,[o("pre",null,f(e.value.length>$?`${e.value.slice(0,$)}...`:e.value),1),o("button",{class:"btn outline sm",title:"Copy geometry",onClick:k[0]||(k[0]=h=>j(e.value))},et)])):(l(),s(p,{key:2},[g(f(e.value),1)],64))],64))]),o("div",tt,[e.language?(l(),s("span",lt,f(e.language),1)):e.datatype?(l(),s("a",{key:1,href:e.datatype.value,target:"_blank",rel:"noopener noreferrer",class:"badge outline",title:"Datatype"},[e.datatype.qname?(l(),s(p,{key:0},[g(f(e.datatype.qname),1)],64)):(l(),s(p,{key:1},[g(f(e.datatype.value),1)],64))],8,at)):O("",!0)])]))}});const nt=L(ot,[["__scopeId","data-v-bec69227"]]),st={class:"prop-objs"},rt=V({__name:"PropRow",props:{iri:null,objs:null,qname:null,label:null,description:null,explanation:null,order:null},setup(r){const e=r;return(i,$)=>(l(),s("tr",null,[W(Me,{iri:e.iri,qname:e.qname,label:e.label,description:e.description,explanation:e.explanation},null,8,["iri","qname","label","description","explanation"]),o("td",st,[(l(!0),s(p,null,A(e.objs,j=>(l(),P(nt,G(H(j)),null,16))),256))])]))}});const ce=L(rt,[["__scopeId","data-v-3863cf0a"]]),X=r=>(J("data-v-cbd867fe"),r=r(),K(),r),it={class:"page-title"},ut={class:"iri"},ct=X(()=>o("span",{class:"badge"},"IRI",-1)),pt=["href"],dt=X(()=>o("i",{class:"fa-regular fa-clipboard"},null,-1)),ft=[dt],_t={class:"type"},vt=X(()=>o("span",{class:"badge"},"Type",-1)),ht=["href"],mt={key:0},bt=V({__name:"PropTableNew",props:{item:null,properties:null,blankNodes:null,prefixes:null,hiddenPreds:null},setup(r){const e=r,i=T([]);function $(m){let v="";return Object.entries(e.prefixes).forEach(([t,S])=>{m.value.startsWith(S)&&(v=t+":"+m.value.split(S)[1])}),v}function j(m){if(m==="a")return e.prefixes.rdf+"type";{const[v,t]=m.split(":");return e.prefixes[v]+t}}function n(m,v){return m.annotations.find(t=>t.predicate.value===j(v))?.object.value}function k(){navigator.clipboard.writeText(e.item.iri.trim())}function h(m){let v={};return m.forEach(t=>{var S;v[S=t.predicate.value]??(v[S]={iri:t.predicate.value,objs:[],qname:$(t.predicate),label:n(t.predicate,"rdfs:label"),description:n(t.predicate,"dcterms:description"),explanation:n(t.predicate,"dcterms:provenance"),order:0}),v[t.predicate.value].objs.push({value:t.object.value,qname:t.object instanceof ye?$(t.object):void 0,datatype:t.object instanceof ne?{value:t.object.datatype.value,qname:$(t.object.datatype)}:void 0,language:t.object instanceof ne?t.object.language:void 0,description:void 0,termType:t.object.termType,label:void 0,rows:t.object instanceof re?h(e.blankNodes.filter(R=>R.subject.id===t.object.id)):[]})}),Object.values(v).sort((t,S)=>t.order-S.order)}return se(()=>{const m=e.properties.filter(v=>!e.hiddenPreds.includes(v.predicate.value));i.value=h(m)}),(m,v)=>(l(),s(p,null,[o("h1",it,[g(f(e.item.title||e.item.iri)+" ",1),o("small",ut,[ct,o("a",{href:e.item.iri,target:"_blank",rel:"noopener noreferrer"},f(e.item.iri),9,pt),o("button",{class:"btn outline sm",title:"Copy IRI",onClick:v[0]||(v[0]=t=>k())},ft)]),o("small",_t,[vt,o("a",{href:e.item.type,target:"_blank",rel:"noopener noreferrer"},f(e.item.type),9,ht)])]),U(m.$slots,"map",{},void 0,!0),e.item.description?(l(),s("p",mt,[o("em",null,f(e.item.description),1)])):O("",!0),o("table",null,[U(m.$slots,"top",{},void 0,!0),(l(!0),s(p,null,A(i.value,t=>(l(),P(ce,G(H(t)),null,16))),256)),U(m.$slots,"bottom",{},void 0,!0)])],64))}});const yt=L(bt,[["__scopeId","data-v-cbd867fe"]]),gt={class:"concept-top"},kt={key:1,class:"concept-left"},Ct=V({__name:"ConceptComponent",props:{iri:null,title:null,link:null,children:null,narrower:null,broader:null,baseUrl:null,collapseAll:{type:Boolean}},setup(r){const e=r,i=T(!0);return ge(()=>e.collapseAll,($,j)=>{i.value=$}),($,j)=>{const n=ue("ConceptComponent",!0);return l(),s(p,null,[o("div",gt,[e.children?(l(),s("button",{key:0,class:"concept-left btn outline",onClick:j[0]||(j[0]=k=>i.value=!i.value)},[o("i",{class:q(`fa-regular fa-${i.value?"plus":"minus"}`)},null,2)])):(l(),s("div",kt)),W(w(ke),{class:"concept",to:e.link},{default:I(()=>[g(f(e.title||e.iri),1)]),_:1},8,["to"])]),e.children?(l(),s("div",{key:0,class:q(`concept-children ${i.value?"collapse":""}`)},[(l(!0),s(p,null,A(e.children,k=>(l(),P(n,ie(k,{baseUrl:e.baseUrl,collapseAll:e.collapseAll}),null,16,["baseUrl","collapseAll"]))),256))],2)):O("",!0)],64)}}});const $t=L(Ct,[["__scopeId","data-v-e0711a9f"]]),D=r=>(J("data-v-b68da274"),r=r(),K(),r),jt=D(()=>o("th",null,"Concepts",-1)),Pt=D(()=>o("i",{class:"fa-regular fa-chevron-down"},null,-1)),wt=D(()=>o("i",{class:"fa-regular fa-chevron-up"},null,-1)),Tt=D(()=>o("i",{class:"fa-regular fa-plus"},null,-1)),xt=D(()=>o("i",{class:"fa-regular fa-minus"},null,-1)),St=D(()=>o("i",{class:"fa-regular fa-spinner-third fa-spin"},null,-1)),It=V({__name:"PropTableView",props:{type:null,getChildren:{type:Boolean,default:!1},childPred:{default:""},childTitlePred:{default:""},childDisplayTitle:{default:"Members"},childButton:null,enableSearch:{type:Boolean}},setup(r){const e=r,{namedNode:i}=Be,$=5,j=Ce(Ie),n=$e(),k=je(),{store:h,prefixes:m,parseIntoStore:v,qname:t}=Pe(),{data:S,profiles:R,loading:pe,error:Y,doRequest:de}=we();let Z=[t("a"),t("dcterms:identifier"),t("prez:count"),...e.type==="skos:ConceptScheme"?[t("skos:hasTopConcept")]:[],...e.childPred?[t(e.childPred)]:[]];const B=Te(()=>n.path.startsWith("/c/")?"CatPrez":n.path.startsWith("/s/")?"SpacePrez":n.path.startsWith("/v/")?"VocPrez":void 0),_=T({}),ee=T([]),te=T([]),Q=T([]),le=T([]),z=T(!1),M=T(!0),F=T([]),N=T(!1);function ae(a,d){return{subject:a.subject,predicate:{termType:a.predicate.termType,value:a.predicate.value,id:a.predicate.id,annotations:d.getQuads(a.predicate,null,null,null)},object:a.object,value:a.value,graph:a.graph,termType:a.termType,equals:a.equals,toJSON:a.toJSON}}function oe(a,d,b){a.object instanceof re&&(b++,d.forEach(y=>{const E=ae(y,d);le.value.push(E),b<$&&oe(y,d,b)},a.object,null,null,null))}function fe(){const a=h.value.getSubjects(i(t("a")),i(t(e.type)),null)[0];_.value.iri=a.id;const d=R.value.find(u=>u.default);let b=[t("rdfs:label")],y=[t("dcterms:description")];const E=[t("geo:hasBoundingBox"),t("geo:hasGeometry")];if(Object.keys(k.profiles).includes(d.uri)){const u=k.profiles[d.uri];u.labelPredicates.length>0&&(b=u.labelPredicates),u.descriptionPredicates.length>0&&(y=u.descriptionPredicates)}Z.push(...b,...y),h.value.forEach(u=>{if(b.includes(u.predicate.value)?_.value.title=u.object.value:y.includes(u.predicate.value)?_.value.description=u.object.value:u.predicate.value===t("a")?_.value.type=u.object.value:E.indexOf(u.predicate.value)>=0&&(h.value.forEach(c=>{F.value.push({label:"",fcLabel:"",wkt:c.object.value,uri:_.value.iri,link:`/object?uri=${_.value.iri}`})},u.object,i(t("geo:asWKT")),null,null),console.log(F.value)),!N.value){const c=ae(u,h.value);Q.value.push(c);let C=0;oe(u,h.value,C)}},a,null,null,null),F.value.forEach(u=>{u.label=_.value.title?_.value.title:_.value.iri})}function _e(){let a=[];h.value.forSubjects(c=>{let C={iri:c.id,narrower:[],broader:"",title:"",link:""};h.value.forEach(x=>{x.predicate.value===t(e.childTitlePred)?C.title=x.object.value:x.predicate.value===t("prez:link")?C.link=x.object.value:x.predicate.value===t("skos:narrower")?C.narrower.push(x.object.value):x.predicate.value===t("skos:broader")&&(C.broader=x.object.value)},c,null,null,null),a.push(C)},i(t("skos:inScheme")),i(_.value.iri),null);const d=h.value.getObjects(i(_.value.iri),i(t("skos:hasTopConcept")),null).map(c=>c.id),b=h.value.getSubjects(i(t("skos:topConceptOf")),i(_.value.iri),null).map(c=>c.id),y=[...new Set([...d,...b])],E=a.reduce((c,C,x)=>(c[C.iri]=x,c),{});let u=[];a.forEach(c=>{if(c.narrower.length>0&&c.narrower.forEach(C=>a[E[C]].broader=c.iri),y.includes(c.iri)){u.push(c);return}if(c.broader){const C=a[E[c.broader]];C.children=[...C.children||[],c]}}),te.value=u}function ve(){e.type==="skos:ConceptScheme"?_e():h.value.forObjects(a=>{let d={iri:a.id};h.value.forEach(b=>{b.predicate.value===t(e.childTitlePred)?d.title=b.object.value:b.predicate.value===t("prez:link")&&(d.link=b.object.value)},a,null,null,null),ee.value.push(d)},i(_.value.iri),i(t(e.childPred)),null)}function he(){let a=[];return B.value?(a.push({name:Ne(B.value)+" Home",url:`/${B.value[0].toLowerCase()}`}),["ConceptInCollection"].includes(e.type)&&a.push({name:"Collections",url:"/v/collection"}),["ConceptInCollection"].includes(e.type)&&a.push({name:"Collection",url:`/v/collection/${n.params.collectionId}`}),["skos:ConceptScheme","skos:Concept"].includes(e.type)&&a.push({name:"Vocabularies",url:"/v/vocab"}),["skos:Concept"].includes(e.type)&&a.push({name:"Vocabulary",url:`/v/vocab/${n.params.vocabId}`}),["skos:Collection"].includes(e.type)&&a.push({name:"Collections",url:"/v/collection"}),["dcat:Catalog","dcat:Resource"].includes(e.type)&&a.push({name:"Catalogs",url:"/c/catalogs"}),["dcat:Resource"].includes(e.type)&&a.push({name:"Catalog",url:`/c/catalogs/${n.params.catalogId}`}),["dcat:Dataset","geo:FeatureCollection","geo:Feature"].includes(e.type)&&a.push({name:"Datasets",url:"/s/datasets"}),["geo:FeatureCollection","geo:Feature"].includes(e.type)&&(a.push({name:"Dataset",url:`/s/datasets/${n.params.datasetId}`}),a.push({name:"Feature Collections",url:`/s/datasets/${n.params.datasetId}/collections`})),["geo:Feature"].includes(e.type)&&(a.push({name:"Feature Collection",url:`/s/datasets/${n.params.datasetId}/collections/${n.params.featureCollectionId}`}),a.push({name:"Features",url:`/s/datasets/${n.params.datasetId}/collections/${n.params.featureCollectionId}/items`}))):e.type==="prof:Profile"&&a.push({name:"Profiles",url:"/profiles"}),a}function me(){if(e.enableSearch)switch(e.type){case"skos:ConceptScheme":return{vocab:_.value.iri};case"dcat:Catalog":return{catalog:_.value.iri};case"dcat:Dataset":return{dataset:_.value.iri};case"geo:FeatureCollection":return{collection:_.value.iri};default:return{}}else return{}}return se(()=>{de(`${j}${n.path}`,()=>{if(n.query&&n.query._profile){const a=R.value.find(d=>d.default);n.query._profile===a.token&&!n.query._mediatype?N.value=!1:n.query._profile==="alt"&&!n.query._mediatype?N.value=!0:window.location.replace(`${j}${n.path}?_profile=${n.query._profile}${n.query._mediatype?`&_mediatype=${n.query._mediatype}`:""}`)}else N.value=!1;v(S.value),fe(),!N.value&&e.getChildren&&ve(),N.value?k.rightNavConfig={enabled:!1}:k.rightNavConfig={enabled:!0,profiles:R.value,currentUrl:n.path},document.title=`${_.value.title||e.type.split(":")[1]} | Prez`,B.value?k.pageHeading={name:B.value,url:`/${B.value[0].toLowerCase()}`}:k.pageHeading={name:"Prez",url:"/"},k.breadcrumbs=[...he(),{name:_.value.title||e.type.split(":")[1],url:n.path},...N.value?[{name:"Alternate Profiles",url:`${n.path}?_profile=alt`}]:[]]})}),(a,d)=>{const b=ue("RouterLink");return N.value?(l(),P(Ee,{key:0,profiles:w(R),path:w(n).path},null,8,["profiles","path"])):(l(),s(p,{key:1},[Q.value.length>0?(l(),P(yt,{key:0,item:_.value,properties:Q.value,blankNodes:le.value,prefixes:w(m),hiddenPreds:w(Z)},xe({map:I(()=>[F.value.length?(l(),P(Ae,{key:0,ref:"searchMapRef","geo-w-k-t":F.value},null,8,["geo-w-k-t"])):O("",!0)]),_:2},[e.type==="skos:ConceptScheme"?{name:"bottom",fn:I(()=>[o("tr",null,[jt,o("td",null,[o("button",{id:"concept-hide-btn",class:"btn",onClick:d[0]||(d[0]=y=>z.value=!z.value)},[z.value?(l(),s(p,{key:0},[g("Show "),Pt],64)):(l(),s(p,{key:1},[g("Hide "),wt],64))]),o("div",{class:q(`concepts ${z.value?"collapse":""}`)},[o("button",{id:"collapse-all-btn",onClick:d[1]||(d[1]=y=>M.value=!M.value),class:"btn"},[M.value?(l(),s(p,{key:0},[Tt,g(" Expand all")],64)):(l(),s(p,{key:1},[xt,g(" Collapse all")],64))]),(l(!0),s(p,null,A(te.value,y=>(l(),P($t,ie(y,{baseUrl:w(n).path,collapseAll:M.value}),null,16,["baseUrl","collapseAll"]))),256))],2)])])]),key:"0"}:e.getChildren?{name:"bottom",fn:I(()=>[o("tr",null,[o("th",null,f(e.childDisplayTitle),1),o("td",null,[o("div",{class:"children-list"},[(l(!0),s(p,null,A(ee.value,y=>(l(),P(b,{to:y.link||""},{default:I(()=>[g(f(y.title||y.iri),1)]),_:2},1032,["to"]))),256))])])])]),key:"1"}:e.childButton?{name:"bottom",fn:I(()=>[o("tr",null,[o("th",null,"Members"),o("td",null,[W(b,{to:`${w(n).path}${e.childButton.url}`,class:"btn"},{default:I(()=>[g(f(e.childButton.name),1)]),_:1},8,["to"])])])]),key:"2"}:void 0]),1032,["item","properties","blankNodes","prefixes","hiddenPreds"])):w(pe)?(l(),s(p,{key:1},[St,g(" Loading... ")],64)):w(Y)?(l(),P(Oe,{key:2,message:w(Y)},null,8,["message"])):O("",!0),e.enableSearch?(l(),P(Se,{key:3,to:"#right-bar-content"},[W(Re,{flavour:w(B),query:me()},null,8,["flavour","query"])])):O("",!0)],64))}}});const At=L(It,[["__scopeId","data-v-b68da274"]]);export{At as default};
