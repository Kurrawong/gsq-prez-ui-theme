import{d as N,c as i,F as D,r as q,h as l,e as y,w as j,a as n,t as p,f as b,b as c,R as T,H as ne,k as _,_ as R,L as ie,x as k,y as H,l as E,M as ue,m as Q,z as ce,A as de,J as pe,p as fe,j as _e,i as ve,N as he,u as ge,v as me,s as be,O as Pe,o as ke,T as ye,B as $e,n as Ce,D as Le}from"./index.65cb3f6a.js";import{A as Se}from"./AdvancedSearch.af91f3dc.js";import{P as Ie}from"./ProfilesTable.251f4b0e.js";import{E as we}from"./ErrorMessage.bc6adef0.js";const ze={class:"list"},Ee={class:"list-item-left"},De={class:"list-item-title"},je={key:0,class:"list-item-desc"},Te=N({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(f){const a=f,o=200;return(t,d)=>(l(),i("div",ze,[(l(!0),i(D,null,q(a.items,s=>(l(),y(c(T),{class:"list-item",to:s.link?s.link:""},{default:j(()=>[n("div",Ee,[n("h4",De,p(s.title||s.iri),1),s.description?(l(),i("div",je,p(s.description.length>=o?s.description.slice(0,o)+"...":s.description),1)):b("",!0)]),a.childLink?(l(),y(c(T),{key:0,onClick:d[0]||(d[0]=ne(()=>{},["stop"])),to:s.link+a.childLink,class:"btn outline sm child-btn"},{default:j(()=>[_(p(a.childName),1)]),_:2},1032,["to"])):b("",!0)]),_:2},1032,["to"]))),256))]))}});const Me=R(Te,[["__scopeId","data-v-2f043e05"]]),Ve={key:0,class:"fa-solid fa-arrow-up-a-z"},Be={key:1,class:"fa-solid fa-arrow-down-z-a"},Ne={key:2,class:"fa-thin fa-arrow-up-a-z"},Fe=N({__name:"ItemListSortButton",props:{id:null,state:{type:[Boolean,null]}},emits:["clicked"],setup(f){return(a,o)=>(l(),i("span",{class:"pointer",onClick:o[0]||(o[0]=t=>a.$emit("clicked",f.id))},[f.state===!0?(l(),i("i",Ve)):f.state===!1?(l(),i("i",Be)):(l(),i("i",Ne))]))}});const x=R(Fe,[["__scopeId","data-v-977b01d0"]]),Ae={class:"table",role:"grid"},xe={role:"row"},Re={class:"row",role:"row"},Oe={key:0},Ke={key:0},Ue=["href"],qe={key:0},We=["href"],Ge=N({__name:"VocabItemList",props:{items:null,childName:null,childLink:null},setup(f){const a=f,o=ie({label:!0,description:null,status:null,derivationMode:null}),t=k(a.items),d=s=>{const u=["label","description","status","derivationMode"],e=o[s];for(const $ of u)o[$]=null;typeof e=="boolean"?e===!0?o[s]=!1:e===!1?o[s]=!0:o[s]=null:o[s]=!0};return H(o,()=>{const s=["label","description","status","derivationMode"],u={label:"title",description:"description",status:"status",derivationMode:"derivationMode"};for(const e of s)o[e]===!0?t.value=a.items.sort(($,I)=>{const S=u[e];return $.hasOwnProperty(S)?$[S].localeCompare(I[S]):0}):o[e]===!1&&(t.value=a.items.sort(($,I)=>{const S=u[e];return I.hasOwnProperty(S)?I[S].localeCompare($[S]):0}))}),(s,u)=>(l(),i("table",Ae,[n("thead",null,[n("tr",xe,[n("th",null,[_("Label "),E(x,{id:"label",state:o.label,onClicked:u[0]||(u[0]=e=>d(e))},null,8,["state"])]),n("th",null,[_("Description "),E(x,{id:"description",state:o.description,onClicked:u[1]||(u[1]=e=>d(e))},null,8,["state"])]),n("th",null,[_("Status "),E(x,{id:"status",state:o.status,onClicked:u[2]||(u[2]=e=>d(e))},null,8,["state"])]),n("th",null,[_("Derivation mode "),E(x,{id:"derivationMode",state:o.derivationMode,onClicked:u[3]||(u[3]=e=>d(e))},null,8,["state"])])])]),n("tbody",null,[(l(!0),i(D,null,q(a.items,e=>(l(),i("tr",Re,[n("td",null,[E(c(T),{to:e.link?e.link:""},{default:j(()=>[_(p(e.title||e.iri),1)]),_:2},1032,["to"])]),n("td",null,[e.description?(l(),i("div",Oe,p(e.description.substring(0,80)+"..."),1)):b("",!0)]),n("td",null,[e.status?(l(),i("div",Ke,[n("a",{href:e.status.iri,target:"_blank"},p(e.status.label),9,Ue),_(),n("span",{style:ue(`color: ${e.status.color}`),class:"fa-solid fa-circle fa-2xs"},null,4)])):b("",!0)]),n("td",null,[e.derivationMode?(l(),i("div",qe,[n("a",{href:e.derivationMode.iri},p(e.derivationMode.label),9,We)])):b("",!0)])]))),256))])]))}});const He=R(Ge,[["__scopeId","data-v-28f06472"]]),J=f=>(fe("data-v-1eadacad"),f=f(),_e(),f),Qe={class:"pagination"},Je={key:1},Xe=J(()=>n("i",{class:"fa-regular fa-ellipsis"},null,-1)),Ye=[Xe],Ze=["value"],et={key:4},tt=J(()=>n("i",{class:"fa-regular fa-ellipsis"},null,-1)),at=[tt],lt=N({__name:"PaginationComponent",props:{totalCount:null,perPage:null,currentPage:null,url:null},setup(f){const a=f,o=10,t=k(a.currentPage),d=Q(()=>{const s=a.perPage||o;return Math.ceil(a.totalCount/s)});return H(t,(s,u)=>{s!==u&&pe.push(`${a.url}?page=${s}${a.perPage?`&per_page=${a.perPage}`:""}`)}),(s,u)=>(l(),i("div",Qe,[a.currentPage>2?(l(),y(c(T),{key:0,to:`${a.url}?page=1${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[_(" 1 ")]),_:1},8,["to"])):b("",!0),a.currentPage>3?(l(),i("div",Je,Ye)):b("",!0),a.currentPage>1?(l(),y(c(T),{key:2,to:`${a.url}?page=${a.currentPage-1}${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[_(p(a.currentPage-1),1)]),_:1},8,["to"])):b("",!0),ce(n("select",{class:"pagination-btn",name:"",id:"",title:"Select page","onUpdate:modelValue":u[0]||(u[0]=e=>t.value=e)},[(l(!0),i(D,null,q([...Array(c(d))].map((e,$)=>$+1),e=>(l(),i("option",{value:e},p(e),9,Ze))),256))],512),[[de,t.value]]),a.currentPage<c(d)?(l(),y(c(T),{key:3,to:`${a.url}?page=${a.currentPage+1}${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[_(p(a.currentPage+1),1)]),_:1},8,["to"])):b("",!0),a.currentPage<c(d)-2?(l(),i("div",et,at)):b("",!0),a.currentPage<c(d)-1?(l(),y(c(T),{key:5,to:`${a.url}?page=${c(d)}${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[_(p(c(d)),1)]),_:1},8,["to"])):b("",!0)]))}});const st=R(lt,[["__scopeId","data-v-1eadacad"]]),ot={class:"page-title"},rt=["href"],nt={key:0},it=n("i",{class:"fa-regular fa-spinner-third fa-spin"},null,-1),ft=N({__name:"ItemListView",setup(f){const{namedNode:a}=Le,o=ve($e),t=he(),d=ge(),{store:s,parseIntoStore:u,qname:e}=me(),{data:$,profiles:I,loading:S,error:W,doRequest:X}=be(),Y=[e("rdfs:label")],Z=[e("dcterms:description")],ee=[e("dcat:Catalog"),e("dcat:Dataset"),e("skos:ConceptScheme"),e("skos:Collection"),e("prof:Profile"),e("prez:CatPrezProfile"),e("prez:SpacePrezProfile"),e("prez:VocPrezProfile")],O="lt-prfl:alt-profile",w=k([]),v=k({uri:"",label:""}),K=k(0),F=k(!1),h=k(null),M=k(null),te=k(!1),ae=k({}),A=k({showButton:!1,buttonTitle:"",buttonLink:""}),le=Q(()=>t.query&&t.query.page?parseInt(t.query.page):1);function C(r){switch(v.value.uri=r,r){case e("dcat:Catalog"):v.value.label="Catalogs";break;case e("dcat:Dataset"):v.value.label="Datasets",A.value={showButton:!0,buttonTitle:"Collections",buttonLink:"/collections"};break;case e("geo:FeatureCollection"):v.value.label="Feature Collections",A.value={showButton:!0,buttonTitle:"Features",buttonLink:"/items"};break;case e("geo:Feature"):v.value.label="Features";break;case e("skos:ConceptScheme"):v.value.label="Vocabularies";break;case e("skos:Collection"):v.value.label="Collections";break;case e("prof:Profile"):case e("prez:CatPrezProfile"):case e("prez:SpacePrezProfile"):case e("prez:VocPrezProfile"):v.value.label="Profiles";break}}function se(){let r=[];h.value&&r.push({name:Ce(h.value)+" Home",url:`/${h.value[0].toLowerCase()}`});const g=t.path.split("/").slice(1);let V=!1;return g.forEach((U,L)=>{if(V){V=!1;return}switch(U){case"catalogs":r.push({name:"Catalogs",url:"/c/catalogs"});break;case"datasets":r.push({name:"Datasets",url:"/s/datasets"}),L+1!==g.length&&(r.push({name:"Dataset",url:`/s/datasets/${t.params.datasetId}`}),V=!0);break;case"collections":r.push({name:"Feature Collections",url:`/s/datasets/${t.params.datasetId}/collections`}),L+1!==g.length&&(r.push({name:"Feature Collection",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}`}),V=!0);break;case"items":r.push({name:"Features",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}/items`});break;case"vocab":r.push({name:"Vocabularies",url:"/v/vocab"});break;case"collection":r.push({name:"Collections",url:"/v/collection"});break;case"profiles":r.push({name:"Profiles",url:`${h.value?h.value[0].toLowerCase():""}/profiles`});break}}),F.value&&r.push({name:"Alternate Profiles",url:`${t.path}?_profile=${O}`}),r}function oe(){let r=[];const g=s.value.getQuads(null,a(e("prez:count")),null,null)[0];K.value=parseInt(g.object.value),ee.includes(g.subject.value)?r=s.value.getSubjects(a(e("a")),g.subject,null):r=s.value.getObjects(g.subject,a(e("rdfs:member")),null);const V=M.value.labelPredicates.length>0?M.value.labelPredicates:Y,U=M.value.descriptionPredicates.length>0?M.value.labelPredicates:Z;r.forEach(L=>{let P={iri:L.id};s.value.forEach(m=>{if(V.includes(m.predicate.value))P.title=m.object.value;else if(U.includes(m.predicate.value))P.description=m.object.value;else if(m.predicate.value===e("prez:link"))P.link=m.object.value;else if(h.value==="VocPrez"&&m.predicate.value===e("reg:status")){const z={iri:m.object.value,label:G(m.object.value)};s.value.forObjects(B=>{z.label=B.value},m.object,e("rdfs:label"),null),s.value.forObjects(B=>{z.color=B.value},m.object,e("sdo:color"),null),P.status=z}else h.value==="VocPrez"&&m.predicate.value===e("prov:qualifiedDerivation")&&s.value.forObjects(z=>{const B={iri:z.value,label:G(z.value)};s.value.forObjects(re=>{B.label=re.value},z,e("rdfs:label"),null),P.derivationMode=B},m.object,e("prov:hadRole"),null)},L,null,null,null),w.value.push(P)}),w.value.sort((L,P)=>L.title&&P.title?L.title.localeCompare(P.title):L.title?-1:P.title?1:L.iri.localeCompare(P.iri))}function G(r){let g=r.split("#");return g.length===1?g[0].split("/").slice(-1)[0]:g.slice(-1)[0]}return Pe(()=>{t.path.startsWith("/c/")?(h.value="CatPrez",t.path.match(/c\/profiles/)?C(e("prof:Profile")):t.path.match(/c\/catalogs/)&&C(e("dcat:Catalog"))):t.path.startsWith("/s/")&&(h.value="SpacePrez",t.path.match(/s\/profiles/)?C(e("prof:Profile")):t.path.match(/s\/datasets\/.+\/collections\/.+\/items/)?C(e("geo:Feature")):t.path.match(/s\/datasets\/.+\/collections/)?C(e("geo:FeatureCollection")):t.path.match(/s\/datasets/)&&C(e("dcat:Dataset"))),t.path.startsWith("/v/")?(h.value="VocPrez",t.path.match(/v\/profiles/)?C(e("prof:Profile")):t.path.match(/v\/vocab/)?C(e("skos:ConceptScheme")):t.path.match(/v\/collection/)&&C(e("skos:Collection"))):t.path.startsWith("/profiles")&&C(e("prof:Profile")),t.query._profile===O&&!t.query._mediatype&&(F.value=!0)}),ke(()=>{X(`${o}${t.fullPath}`,()=>{M.value=d.profiles[I.value.find(r=>r.default).uri],t.query&&t.query._profile&&(t.query._mediatype||![M.value.token,O].includes(t.query._profile))&&window.location.replace(`${o}${t.path}?_profile=${t.query._profile}${t.query._mediatype?`&_mediatype=${t.query._mediatype}`:""}`),F.value?d.rightNavConfig={enabled:!1}:d.rightNavConfig={enabled:!0,profiles:I.value,currentUrl:t.path},u($.value),oe(),document.title=`${v.value.label} | Prez`,d.breadcrumbs=se()})}),(r,g)=>F.value?(l(),y(Ie,{key:0,profiles:c(I),path:c(t).path},null,8,["profiles","path"])):(l(),i(D,{key:1},[n("h1",ot,p(v.value.label),1),n("p",null,[_("A list of "),n("a",{href:v.value.uri,target:"_blank",rel:"noopener noreferrer"},p(v.value.label)+".",9,rt)]),w.value.length>0?(l(),i("p",nt,"Showing "+p(w.value.length)+" of "+p(K.value)+" items.",1)):b("",!0),c(W)?(l(),y(we,{key:1,message:c(W)},null,8,["message"])):c(S)?(l(),i(D,{key:2},[it,_(" Loading... ")],64)):w.value.length>0?(l(),i(D,{key:3},[h.value==="VocPrez"?(l(),y(He,{key:0,items:w.value},null,8,["items"])):(l(),y(Me,{key:1,items:w.value,childName:A.value.buttonTitle,childLink:A.value.buttonLink},null,8,["items","childName","childLink"])),E(st,{url:c(t).path,totalCount:K.value,currentPage:c(le)},null,8,["url","totalCount","currentPage"])],64)):(l(),i(D,{key:4},[_("No "+p(v.value.label)+" found.",1)],64)),te.value&&h.value?(l(),y(ye,{key:5,to:"#right-bar-content"},[E(Se,{flavour:h.value,query:ae.value},null,8,["flavour","query"])])):b("",!0)],64))}});export{ft as default};
