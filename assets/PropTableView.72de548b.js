import{_ as O,h as l,c as o,n as L,a as n,d as E,e as S,w as I,k as b,t as c,F as u,M as be,r as B,N as W,O as H,f as V,p as G,j as J,l as M,v as T,o as ne,P as me,Q as oe,S as se,x as ye,E as Q,b as P,R as ge,U as re,L as ie,i as ke,K as Ce,u as $e,s as je,q as Pe,m as we,V as Te,T as Se,A as xe,D as Ne}from"./index.7e3210b0.js";import{A as Ie}from"./AdvancedSearch.04406c3e.js";import{P as Re}from"./ProfilesTable.671881b3.js";const Ae={},Be={class:"tooltip"},Oe={class:"tooltip-text"};function Ee(r,e){return l(),o("span",Be,[L(r.$slots,"default",{},void 0,!0),n("span",Oe,[L(r.$slots,"text",{},void 0,!0)])])}const Le=O(Ae,[["render",Ee],["__scopeId","data-v-5b46f6b0"]]),Ve=["href"],De=E({__name:"PredCell",props:{iri:null,qname:null,label:null,description:null,explanation:null},setup(r){const e=r;return(i,C)=>(l(),o("th",null,[(l(),S(be(e.description?Le:"slot"),null,{text:I(()=>[b(c(e.description),1)]),default:I(()=>[n("a",{href:e.iri,target:"_blank",rel:"noopener noreferrer"},[e.label?(l(),o(u,{key:0},[b(c(e.label),1)],64)):e.qname?(l(),o(u,{key:1},[b(c(e.qname),1)],64)):(l(),o(u,{key:2},[b(c(e.iri),1)],64))],8,Ve)]),_:1}))]))}}),Fe=r=>(G("data-v-bec69227"),r=r(),J(),r),Ue={class:"prop-obj"},ze={class:"obj-value"},Me={key:0},qe=["href"],Qe=["href"],We=["href"],He=["href"],Ge={key:1,class:"geom-cell"},Je=Fe(()=>n("i",{class:"fa-regular fa-clipboard"},null,-1)),Ke=[Je],Xe={class:"obj-tag"},Ye={key:0,class:"badge outline",title:"Language"},Ze=["href"],et=E({__name:"ObjCell",props:{value:null,qname:null,datatype:null,language:null,description:null,termType:null,label:null,rows:null},setup(r){const e=r,i=["http://www.opengis.net/ont/geosparql#geoJSONLiteral","http://www.opengis.net/ont/geosparql#wktLiteral"],C=100;function $(s){navigator.clipboard.writeText(s.trim())}return(s,g)=>(l(),o("div",Ue,[n("div",ze,[e.termType==="BlankNode"?(l(),o("table",Me,[(l(!0),o(u,null,B(e.rows,m=>(l(),S(ue,W(H(m)),null,16))),256))])):e.termType==="NamedNode"?(l(),o(u,{key:1},[e.label?(l(),o("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},c(e.label),9,qe)):e.qname?(l(),o("a",{key:1,href:e.value,target:"_blank",rel:"noopener noreferrer"},c(e.qname),9,Qe)):(l(),o("a",{key:2,href:e.value,target:"_blank",rel:"noopener noreferrer"},c(e.value),9,We))],64)):(l(),o(u,{key:2},[e.value.startsWith("http")?(l(),o("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},c(e.value),9,He)):e.datatype&&i.includes(e.datatype.value)?(l(),o("div",Ge,[n("pre",null,c(e.value.length>C?`${e.value.slice(0,C)}...`:e.value),1),n("button",{class:"btn outline sm",title:"Copy geometry",onClick:g[0]||(g[0]=m=>$(e.value))},Ke)])):(l(),o(u,{key:2},[b(c(e.value),1)],64))],64))]),n("div",Xe,[e.language?(l(),o("span",Ye,c(e.language),1)):e.datatype?(l(),o("a",{key:1,href:e.datatype.value,target:"_blank",rel:"noopener noreferrer",class:"badge outline",title:"Datatype"},[e.datatype.qname?(l(),o(u,{key:0},[b(c(e.datatype.qname),1)],64)):(l(),o(u,{key:1},[b(c(e.datatype.value),1)],64))],8,Ze)):V("",!0)])]))}});const tt=O(et,[["__scopeId","data-v-bec69227"]]),lt={class:"prop-objs"},at=E({__name:"PropRow",props:{iri:null,objs:null,qname:null,label:null,description:null,explanation:null,order:null},setup(r){const e=r;return(i,C)=>(l(),o("tr",null,[M(De,{iri:e.iri,qname:e.qname,label:e.label,description:e.description,explanation:e.explanation},null,8,["iri","qname","label","description","explanation"]),n("td",lt,[(l(!0),o(u,null,B(e.objs,$=>(l(),S(tt,W(H($)),null,16))),256))])]))}});const ue=O(at,[["__scopeId","data-v-3863cf0a"]]),K=r=>(G("data-v-cbd867fe"),r=r(),J(),r),ot={class:"page-title"},nt={class:"iri"},st=K(()=>n("span",{class:"badge"},"IRI",-1)),rt=["href"],it=K(()=>n("i",{class:"fa-regular fa-clipboard"},null,-1)),ut=[it],ct={class:"type"},dt=K(()=>n("span",{class:"badge"},"Type",-1)),pt=["href"],ft={key:0},_t=E({__name:"PropTableNew",props:{item:null,properties:null,blankNodes:null,prefixes:null,hiddenPreds:null},setup(r){const e=r,i=T([]);function C(v){let _="";return Object.entries(e.prefixes).forEach(([t,x])=>{v.value.startsWith(x)&&(_=t+":"+v.value.split(x)[1])}),_}function $(v){if(v==="a")return e.prefixes.rdf+"type";{const[_,t]=v.split(":");return e.prefixes[_]+t}}function s(v,_){return v.annotations.find(t=>t.predicate.value===$(_))?.object.value}function g(){navigator.clipboard.writeText(e.item.iri.trim())}function m(v){let _={};return v.forEach(t=>{var x;_[x=t.predicate.value]??(_[x]={iri:t.predicate.value,objs:[],qname:C(t.predicate),label:s(t.predicate,"rdfs:label"),description:s(t.predicate,"dcterms:description"),explanation:s(t.predicate,"dcterms:provenance"),order:0}),_[t.predicate.value].objs.push({value:t.object.value,qname:t.object instanceof me?C(t.object):void 0,datatype:t.object instanceof oe?{value:t.object.datatype.value,qname:C(t.object.datatype)}:void 0,language:t.object instanceof oe?t.object.language:void 0,description:void 0,termType:t.object.termType,label:void 0,rows:t.object instanceof se?m(e.blankNodes.filter(A=>A.subject.id===t.object.id)):[]})}),Object.values(_).sort((t,x)=>t.order-x.order)}return ne(()=>{const v=e.properties.filter(_=>!e.hiddenPreds.includes(_.predicate.value));i.value=m(v)}),(v,_)=>(l(),o(u,null,[n("h1",ot,[b(c(e.item.title||e.item.iri)+" ",1),n("small",nt,[st,n("a",{href:e.item.iri,target:"_blank",rel:"noopener noreferrer"},c(e.item.iri),9,rt),n("button",{class:"btn outline sm",title:"Copy IRI",onClick:_[0]||(_[0]=t=>g())},ut)]),n("small",ct,[dt,n("a",{href:e.item.type,target:"_blank",rel:"noopener noreferrer"},c(e.item.type),9,pt)])]),L(v.$slots,"map",{},void 0,!0),e.item.description?(l(),o("p",ft,[n("em",null,c(e.item.description),1)])):V("",!0),n("table",null,[L(v.$slots,"top",{},void 0,!0),(l(!0),o(u,null,B(i.value,t=>(l(),S(ue,W(H(t)),null,16))),256)),L(v.$slots,"bottom",{},void 0,!0)])],64))}});const vt=O(_t,[["__scopeId","data-v-cbd867fe"]]),ht={class:"concept-top"},bt={key:1,class:"concept-left"},mt=E({__name:"ConceptComponent",props:{iri:null,title:null,link:null,children:null,narrower:null,broader:null,baseUrl:null,collapseAll:{type:Boolean}},setup(r){const e=r,i=T(!0);return ye(()=>e.collapseAll,(C,$)=>{i.value=C}),(C,$)=>{const s=ie("ConceptComponent",!0);return l(),o(u,null,[n("div",ht,[e.children?(l(),o("button",{key:0,class:"concept-left btn outline",onClick:$[0]||($[0]=g=>i.value=!i.value)},[n("i",{class:Q(`fa-regular fa-${i.value?"plus":"minus"}`)},null,2)])):(l(),o("div",bt)),M(P(ge),{class:"concept",to:e.link},{default:I(()=>[b(c(e.title||e.iri),1)]),_:1},8,["to"])]),e.children?(l(),o("div",{key:0,class:Q(`concept-children ${i.value?"collapse":""}`)},[(l(!0),o(u,null,B(e.children,g=>(l(),S(s,re(g,{baseUrl:e.baseUrl,collapseAll:e.collapseAll}),null,16,["baseUrl","collapseAll"]))),256))],2)):V("",!0)],64)}}});const yt=O(mt,[["__scopeId","data-v-e0711a9f"]]),D=r=>(G("data-v-1c02d492"),r=r(),J(),r),gt=D(()=>n("th",null,"Concepts",-1)),kt=D(()=>n("i",{class:"fa-regular fa-chevron-down"},null,-1)),Ct=D(()=>n("i",{class:"fa-regular fa-chevron-up"},null,-1)),$t=D(()=>n("i",{class:"fa-regular fa-plus"},null,-1)),jt=D(()=>n("i",{class:"fa-regular fa-minus"},null,-1)),Pt=E({__name:"PropTableView",props:{type:null,getChildren:{type:Boolean,default:!1},childPred:{default:""},childTitlePred:{default:""},childDisplayTitle:{default:"Members"},childButton:null,enableSearch:{type:Boolean}},setup(r){const e=r,{namedNode:i}=Ne,C=5,$=ke(xe),s=Ce(),g=$e(),{store:m,prefixes:v,parseIntoStore:_,qname:t}=je(),{data:x,profiles:A,loading:ce,error:X,doRequest:de}=Pe();let Y=[t("a"),t("dcterms:identifier"),t("prez:count"),...e.type==="skos:ConceptScheme"?[t("skos:hasTopConcept")]:[],...e.childPred?[t(e.childPred)]:[]];const R=we(()=>s.path.startsWith("/c/")?"CatPrez":s.path.startsWith("/s/")?"SpacePrez":s.path.startsWith("/v/")?"VocPrez":void 0),k=T({}),Z=T([]),ee=T([]),q=T([]),te=T([]),F=T(!0),U=T(!0),N=T(!1);function le(a,d){return{subject:a.subject,predicate:{termType:a.predicate.termType,value:a.predicate.value,id:a.predicate.id,annotations:d.getQuads(a.predicate,null,null,null)},object:a.object,value:a.value,graph:a.graph,termType:a.termType,equals:a.equals,toJSON:a.toJSON}}function ae(a,d,h){a.object instanceof se&&(h++,d.forEach(y=>{const p=le(y,d);te.value.push(p),h<C&&ae(y,d,h)},a.object,null,null,null))}function pe(){const a=m.value.getSubjects(i(t("a")),i(t(e.type)),null)[0];k.value.iri=a.id;const d=A.value.find(p=>p.default);let h=t("rdfs:label"),y=t("dcterms:description");if(Object.keys(g.profiles).includes(d.token)){const p=g.profiles[d.token];p.labelPredicate&&(h=p.labelPredicate),p.descPredicate&&(y=p.descPredicate)}Y.push(h,y),m.value.forEach(p=>{if(p.predicate.value===h?k.value.title=p.object.value:p.predicate.value===y?k.value.description=p.object.value:p.predicate.value===t("a")&&(k.value.type=p.object.value),!N.value){const z=le(p,m.value);q.value.push(z);let f=0;ae(p,m.value,f)}},a,null,null,null)}function fe(){let a=[];m.value.forSubjects(f=>{let j={iri:f.id,narrower:[],broader:"",title:"",link:""};m.value.forEach(w=>{w.predicate.value===t(e.childTitlePred)?j.title=w.object.value:w.predicate.value===t("prez:link")?j.link=w.object.value:w.predicate.value===t("skos:narrower")?j.narrower.push(w.object.value):w.predicate.value===t("skos:broader")&&(j.broader=w.object.value)},f,null,null,null),a.push(j)},i(t("skos:inScheme")),i(k.value.iri),null);const d=m.value.getObjects(i(k.value.iri),i(t("skos:hasTopConcept")),null).map(f=>f.id),h=m.value.getSubjects(i(t("skos:topConceptOf")),i(k.value.iri),null).map(f=>f.id),y=[...new Set([...d,...h])],p=a.reduce((f,j,w)=>(f[j.iri]=w,f),{});let z=[];a.forEach(f=>{if(f.narrower.length>0&&f.narrower.forEach(j=>a[p[j]].broader=f.iri),y.includes(f.iri)){z.push(f);return}if(f.broader){const j=a[p[f.broader]];j.children=[...j.children||[],f]}}),ee.value=z}function _e(){e.type==="skos:ConceptScheme"?fe():m.value.forObjects(a=>{let d={iri:a.id};m.value.forEach(h=>{h.predicate.value===t(e.childTitlePred)?d.title=h.object.value:h.predicate.value===t("prez:link")&&(d.link=h.object.value)},a,null,null,null),Z.value.push(d)},i(k.value.iri),i(t(e.childPred)),null)}function ve(){let a=[];return R.value?(a.push({name:R.value,url:`/${R.value[0].toLowerCase()}`}),["skos:ConceptScheme","skos:Concept"].includes(e.type)&&a.push({name:"Vocabs",url:"/v/vocab"}),["skos:Concept"].includes(e.type)&&a.push({name:"Vocab",url:`/v/vocab/${s.params.vocabId}`}),["skos:Collection"].includes(e.type)&&a.push({name:"Collections",url:"/v/collection"}),["dcat:Catalog","dcat:Resource"].includes(e.type)&&a.push({name:"Catalogs",url:"/c/catalogs"}),["dcat:Resource"].includes(e.type)&&a.push({name:"Catalog",url:`/c/catalogs/${s.params.catalogId}`}),["dcat:Dataset","geo:FeatureCollection","geo:Feature"].includes(e.type)&&a.push({name:"Datasets",url:"/s/datasets"}),["geo:FeatureCollection","geo:Feature"].includes(e.type)&&(a.push({name:"Dataset",url:`/s/datasets/${s.params.datasetId}`}),a.push({name:"Feature Collections",url:`/s/datasets/${s.params.datasetId}/collections`})),["geo:Feature"].includes(e.type)&&(a.push({name:"Feature Collection",url:`/s/datasets/${s.params.datasetId}/collections/${s.params.featureCollectionId}`}),a.push({name:"Features",url:`/s/datasets/${s.params.datasetId}/collections/${s.params.featureCollectionId}/items`}))):e.type==="prof:Profile"&&a.push({name:"Profiles",url:"/profiles"}),a}function he(){if(e.enableSearch)switch(e.type){case"skos:ConceptScheme":return{vocab:k.value.iri};case"dcat:Catalog":return{catalog:k.value.iri};case"dcat:Dataset":return{dataset:k.value.iri};case"geo:FeatureCollection":return{collection:k.value.iri};default:return{}}else return{}}return ne(()=>{de(`${$}${s.path}`,()=>{if(s.query&&s.query._profile){const a=A.value.find(d=>d.default);s.query._profile===a.token&&!s.query._mediatype?N.value=!1:s.query._profile==="alt"&&!s.query._mediatype?N.value=!0:window.location.replace(`${$}${s.path}?_profile=${s.query._profile}${s.query._mediatype?`&_mediatype=${s.query._mediatype}`:""}`)}else N.value=!1;_(x.value),pe(),!N.value&&e.getChildren&&_e(),N.value?g.rightNavConfig={enabled:!1}:g.rightNavConfig={enabled:!0,profiles:A.value,currentUrl:s.path},document.title=`${k.value.title||e.type.split(":")[1]} | Prez`,R.value?g.pageHeading={name:R.value,url:`/${R.value[0].toLowerCase()}`}:g.pageHeading={name:"Prez",url:"/"},g.breadcrumbs=[...ve(),{name:k.value.title||e.type.split(":")[1],url:s.path},...N.value?[{name:"Alternate Profiles",url:`${s.path}?_profile=alt`}]:[]]})}),(a,d)=>{const h=ie("RouterLink");return N.value?(l(),S(Re,{key:0,profiles:P(A),path:P(s).path},null,8,["profiles","path"])):(l(),o(u,{key:1},[q.value.length>0?(l(),S(vt,{key:0,item:k.value,properties:q.value,blankNodes:te.value,prefixes:P(v),hiddenPreds:P(Y)},Te({_:2},[e.type==="skos:ConceptScheme"?{name:"bottom",fn:I(()=>[n("tr",null,[gt,n("td",null,[n("button",{id:"concept-hide-btn",class:"btn",onClick:d[0]||(d[0]=y=>F.value=!F.value)},[F.value?(l(),o(u,{key:0},[b("Show "),kt],64)):(l(),o(u,{key:1},[b("Hide "),Ct],64))]),n("div",{class:Q(`concepts ${F.value?"collapse":""}`)},[n("button",{id:"collapse-all-btn",onClick:d[1]||(d[1]=y=>U.value=!U.value),class:"btn"},[U.value?(l(),o(u,{key:0},[$t,b(" Expand all")],64)):(l(),o(u,{key:1},[jt,b(" Collapse all")],64))]),(l(!0),o(u,null,B(ee.value,y=>(l(),S(yt,re(y,{baseUrl:P(s).path,collapseAll:U.value}),null,16,["baseUrl","collapseAll"]))),256))],2)])])]),key:"0"}:e.getChildren?{name:"bottom",fn:I(()=>[n("tr",null,[n("th",null,c(e.childDisplayTitle),1),n("td",null,[n("div",{class:"children-list"},[(l(!0),o(u,null,B(Z.value,y=>(l(),S(h,{to:y.link||""},{default:I(()=>[b(c(y.title||y.iri),1)]),_:2},1032,["to"]))),256))])])])]),key:"1"}:e.childButton?{name:"bottom",fn:I(()=>[n("tr",null,[n("th",null,"Members"),n("td",null,[M(h,{to:`${P(s).path}${e.childButton.url}`,class:"btn"},{default:I(()=>[b(c(e.childButton.name),1)]),_:1},8,["to"])])])]),key:"2"}:void 0]),1032,["item","properties","blankNodes","prefixes","hiddenPreds"])):P(ce)?(l(),o(u,{key:1},[b("loading...")],64)):P(X)?(l(),o(u,{key:2},[b("Network error: "+c(P(X)),1)],64)):V("",!0),e.enableSearch?(l(),S(Se,{key:3,to:"#right-bar-content"},[M(Ie,{flavour:P(R),query:he()},null,8,["flavour","query"])])):V("",!0)],64))}}});const xt=O(Pt,[["__scopeId","data-v-1c02d492"]]);export{xt as default};
