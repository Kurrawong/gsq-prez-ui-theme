import{d as M,c as o,F as L,r as O,h as l,e as $,w as I,a as d,t as v,f as h,b as u,R as S,H as X,k as y,_ as V,L as Y,x as B,y as A,l as C,m as K,z as Z,A as ee,J as te,p as ae,j as le,i as se,M as re,u as ne,v as oe,s as ie,o as ue,T as ce,D as de,B as pe,n as fe}from"./index.f075a561.js";import{A as _e}from"./AdvancedSearch.203eee67.js";import{P as ve}from"./ProfilesTable.7ce1e453.js";import{E as ge}from"./ErrorMessage.a2ab9afd.js";const he={class:"list"},me={class:"list-item-left"},ye={class:"list-item-title"},be={key:0,class:"list-item-desc"},$e=M({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(f){const e=f;return(r,m)=>(l(),o("div",he,[(l(!0),o(L,null,O(e.items,t=>(l(),$(u(S),{class:"list-item",to:t.link?t.link:""},{default:I(()=>[d("div",me,[d("h4",ye,v(t.title||t.iri),1),t.description?(l(),o("div",be,v(t.description),1)):h("",!0)]),e.childLink?(l(),$(u(S),{key:0,onClick:m[0]||(m[0]=X(()=>{},["stop"])),to:t.link+e.childLink,class:"btn outline sm child-btn"},{default:I(()=>[y(v(e.childName),1)]),_:2},1032,["to"])):h("",!0)]),_:2},1032,["to"]))),256))]))}});const Pe=V($e,[["__scopeId","data-v-c351f6e5"]]),ke={key:0,class:"fa-solid fa-arrow-up-a-z"},Ce={key:1,class:"fa-solid fa-arrow-down-z-a"},Le={key:2,class:"fa-thin fa-arrow-up-a-z"},Ie=M({__name:"ItemListSortButton",props:{id:null,state:{type:[Boolean,null]}},emits:["clicked"],setup(f){return(e,r)=>(l(),o("span",{class:"pointer",onClick:r[0]||(r[0]=m=>e.$emit("clicked",f.id))},[f.state===!0?(l(),o("i",ke)):f.state===!1?(l(),o("i",Ce)):(l(),o("i",Le))]))}});const x=V(Ie,[["__scopeId","data-v-977b01d0"]]),Se={class:"table",role:"grid"},we={role:"row"},je={class:"row",role:"row"},Be={key:0},Me={key:0},ze={key:0},Ne=M({__name:"VocabItemList",props:{items:null,childName:null,childLink:null},setup(f){const e=f,r=Y({label:!0,description:null,status:null,derivationMode:null}),m=B(e.items),t=i=>{const s=["label","description","status","derivationMode"],a=r[i];for(const n of s)r[n]=null;typeof a=="boolean"?a===!0?r[i]=!1:a===!1?r[i]=!0:r[i]=null:r[i]=!0};return A(r,()=>{const i=["label","description","status","derivationMode"],s={label:"title",description:"description",status:"status",derivationMode:"derivationMode"};for(const a of i)r[a]===!0?m.value=e.items.sort((n,w)=>{const b=s[a];return n.hasOwnProperty(b)?n[b].localeCompare(w[b]):0}):r[a]===!1&&(m.value=e.items.sort((n,w)=>{const b=s[a];return w.hasOwnProperty(b)?w[b].localeCompare(n[b]):0}))}),(i,s)=>(l(),o("table",Se,[d("thead",null,[d("tr",we,[d("th",null,[y("Label "),C(x,{id:"label",state:r.label,onClicked:s[0]||(s[0]=a=>t(a))},null,8,["state"])]),d("th",null,[y("Description "),C(x,{id:"description",state:r.description,onClicked:s[1]||(s[1]=a=>t(a))},null,8,["state"])]),d("th",null,[y("Status "),C(x,{id:"status",state:r.status,onClicked:s[2]||(s[2]=a=>t(a))},null,8,["state"])]),d("th",null,[y("Derivation mode "),C(x,{id:"derivationMode",state:r.derivationMode,onClicked:s[3]||(s[3]=a=>t(a))},null,8,["state"])])])]),d("tbody",null,[(l(!0),o(L,null,O(e.items,a=>(l(),o("tr",je,[d("td",null,[C(u(S),{to:a.link?a.link:""},{default:I(()=>[y(v(a.title||a.iri),1)]),_:2},1032,["to"])]),d("td",null,[a.description?(l(),o("div",Be,v(a.description.substring(0,80)+"..."),1)):h("",!0)]),d("td",null,[a.status?(l(),o("div",Me,v(a.status),1)):h("",!0)]),d("td",null,[a.derivationMode?(l(),o("div",ze,v(a.derivationMode),1)):h("",!0)])]))),256))])]))}});const xe=V(Ne,[["__scopeId","data-v-b18a3829"]]),F=f=>(ae("data-v-1eadacad"),f=f(),le(),f),Ve={class:"pagination"},De={key:1},Te=F(()=>d("i",{class:"fa-regular fa-ellipsis"},null,-1)),qe=[Te],Ee=["value"],Ke={key:4},Oe=F(()=>d("i",{class:"fa-regular fa-ellipsis"},null,-1)),Re=[Oe],Ae=M({__name:"PaginationComponent",props:{totalCount:null,perPage:null,currentPage:null,url:null},setup(f){const e=f,r=10,m=B(e.currentPage),t=K(()=>{const i=e.perPage||r;return Math.ceil(e.totalCount/i)});return A(m,(i,s)=>{i!==s&&te.push(`${e.url}?page=${i}${e.perPage?`&per_page=${e.perPage}`:""}`)}),(i,s)=>(l(),o("div",Ve,[e.currentPage>2?(l(),$(u(S),{key:0,to:`${e.url}?page=1${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:I(()=>[y(" 1 ")]),_:1},8,["to"])):h("",!0),e.currentPage>3?(l(),o("div",De,qe)):h("",!0),e.currentPage>1?(l(),$(u(S),{key:2,to:`${e.url}?page=${e.currentPage-1}${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:I(()=>[y(v(e.currentPage-1),1)]),_:1},8,["to"])):h("",!0),Z(d("select",{class:"pagination-btn",name:"",id:"",title:"Select page","onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a)},[(l(!0),o(L,null,O([...Array(u(t))].map((a,n)=>n+1),a=>(l(),o("option",{value:a},v(a),9,Ee))),256))],512),[[ee,m.value]]),e.currentPage<u(t)?(l(),$(u(S),{key:3,to:`${e.url}?page=${e.currentPage+1}${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:I(()=>[y(v(e.currentPage+1),1)]),_:1},8,["to"])):h("",!0),e.currentPage<u(t)-2?(l(),o("div",Ke,Re)):h("",!0),e.currentPage<u(t)-1?(l(),$(u(S),{key:5,to:`${e.url}?page=${u(t)}${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:I(()=>[y(v(u(t)),1)]),_:1},8,["to"])):h("",!0)]))}});const Fe=V(Ae,[["__scopeId","data-v-1eadacad"]]),He={class:"page-title"},Ue=["innerHTML"],We={key:1},Ge=d("i",{class:"fa-regular fa-spinner-third fa-spin"},null,-1),Ze=M({__name:"ItemListView",props:{title:null,parentType:null,class:null,childButton:null,enableSearch:{type:Boolean},content:null},setup(f){const e=f,{namedNode:r}=de,m=se(pe),t=re(),i=ne(),{store:s,parseIntoStore:a,qname:n}=oe(),{data:w,profiles:b,loading:H,error:R,doRequest:U}=ie(),k=B([]),z=B(0),j=B(!1),P=K(()=>t.path.startsWith("/c/")?"CatPrez":t.path.startsWith("/s/")?"SpacePrez":t.path.startsWith("/v/")?"VocPrez":void 0),W=K(()=>t.query&&t.query.page?parseInt(t.query.page):1);function G(){let g=[];return P.value?(g.push({name:fe(P.value)+" Home",url:`/${P.value[0].toLowerCase()}`}),e.parentType&&(["dcat:Dataset","geo:FeatureCollection"].includes(e.parentType)&&(g.push({name:"Datasets",url:"/s/datasets"}),g.push({name:"Dataset",url:`/s/datasets/${t.params.datasetId}`})),["geo:FeatureCollection"].includes(e.parentType)&&(g.push({name:"Feature Collections",url:`/s/datasets/${t.params.datasetId}/collections`}),g.push({name:"Feature Collection",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}`})))):e.parentType==="prof:Profile"&&g.push({name:"Profiles",url:"/profiles"}),g}function J(){return e.enableSearch?{}:{}}return ue(()=>{let g="";t.query&&(t.query.page&&(g+=`?page=${t.query.page}`),t.query.per_page&&(t.query.page?g+="&":g+="?",g+=`per_page=${t.query.per_page}`)),U(`${m}${t.path}${g}`,()=>{const N=b.value.find(c=>c.default);t.query&&t.query._profile?t.query._profile===N.token&&!t.query._mediatype?j.value=!1:t.query._profile==="alt"&&!t.query._mediatype?j.value=!0:window.location.replace(`${m}${t.path}?_profile=${t.query._profile}${t.query._mediatype?`&_mediatype=${t.query._mediatype}`:""}`):j.value=!1,a(w.value);let D=n("rdfs:label"),T=n("dcterms:description");if(Object.keys(i.profiles).includes(N.uri)){const c=i.profiles[N.uri];c.labelPredicate&&(D=c.labelPredicate),c.descPredicate&&(T=c.descPredicate)}let q=[];if(e.class)z.value=parseInt(s.value.getObjects(r(n(e.class)),r(n("prez:count")),null)[0].value),q=s.value.getSubjects(r(n("a")),r(n(e.class)),null);else{const c=s.value.getQuads(null,r(n("prez:count")),null,null)[0];z.value=parseInt(c.object.value),q=s.value.getObjects(c.subject,r(n("rdfs:member")),null)}q.forEach(c=>{let _={iri:c.id};P.value==="VocPrez"?(s.value.forEach(p=>{p.predicate.value===D?_.title=p.object.value:p.predicate.value===T?_.description=p.object.value:p.predicate.value===n("prez:link")?_.link=p.object.value:p.predicate.value===n("reg:status")?s.value.forObjects(E=>{_.status=E.value},p.object,n("rdfs:label"),null):p.predicate.value===n("prov:qualifiedDerivation")&&s.value.forObjects(E=>{s.value.forObjects(Q=>{_.derivationMode=Q.value},E,n("rdfs:label"),null)},p.object,n("prov:hadRole"),null)},c,null,null,null),k.value.push(_)):(s.value.forEach(p=>{p.predicate.value===D?_.title=p.object.value:p.predicate.value===T?_.description=p.object.value:p.predicate.value===n("prez:link")&&(_.link=p.object.value)},c,null,null,null),k.value.push(_))}),k.value.sort((c,_)=>c.title&&_.title?c.title.localeCompare(_.title):c.title?-1:_.title?1:c.iri.localeCompare(_.iri)),j.value?i.rightNavConfig={enabled:!1}:i.rightNavConfig={enabled:!0,profiles:b.value,currentUrl:t.path},document.title=`${e.title} | Prez`,P.value?i.pageHeading={name:P.value,url:`/${P.value[0].toLowerCase()}`}:i.pageHeading={name:"Prez",url:"/"},i.breadcrumbs=[...G(),{name:e.title,url:t.path},...j.value?[{name:"Alternate Profiles",url:`${t.path}?_profile=alt`}]:[]]})}),(g,N)=>j.value?(l(),$(ve,{key:0,profiles:u(b),path:u(t).path},null,8,["profiles","path"])):(l(),o(L,{key:1},[d("h1",He,v(e.title),1),e.content?(l(),o("p",{key:0,innerHTML:e.content},null,8,Ue)):h("",!0),k.value.length>0?(l(),o("p",We,"Showing "+v(k.value.length)+" of "+v(z.value)+" items.",1)):h("",!0),u(R)?(l(),$(ge,{key:2,message:u(R)},null,8,["message"])):u(H)?(l(),o(L,{key:3},[Ge,y(" Loading... ")],64)):k.value.length>0?(l(),o(L,{key:4},[u(P)==="VocPrez"?(l(),$(xe,{key:0,items:k.value,childName:e.childButton?.name,childLink:e.childButton?.url},null,8,["items","childName","childLink"])):(l(),$(Pe,{key:1,items:k.value,childName:e.childButton?.name,childLink:e.childButton?.url},null,8,["items","childName","childLink"])),C(Fe,{url:u(t).path,totalCount:z.value,currentPage:u(W)},null,8,["url","totalCount","currentPage"])],64)):(l(),o(L,{key:5},[y("No "+v(e.title)+" found.",1)],64)),e.enableSearch?(l(),$(ce,{key:6,to:"#right-bar-content"},[C(_e,{flavour:u(P),query:J()},null,8,["flavour","query"])])):h("",!0)],64))}});export{Ze as default};
