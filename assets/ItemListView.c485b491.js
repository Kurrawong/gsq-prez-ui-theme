import{d as q,c as i,F as y,r as F,g as a,e as m,w as B,a as k,t as h,f as _,b as s,R as S,G as V,k as P,_ as z,u as R,s as A,q as H,v as T,m as M,o as U,l as W,T as E,D as G,i as K,K as O,A as J}from"./index.2f0f5a6c.js";import{A as Q}from"./AdvancedSearch.c0fd3635.js";import{P as X}from"./ProfilesTable.0c861769.js";const Y={class:"list"},Z={class:"list-item-left"},ee={class:"list-item-title"},te={key:0,class:"list-item-desc"},ae=q({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(b){const t=b;return(v,d)=>(a(),i("div",Y,[(a(!0),i(y,null,F(t.items,e=>(a(),m(s(S),{class:"list-item",to:e.link?e.link:""},{default:B(()=>[k("div",Z,[k("h4",ee,h(e.title||e.iri),1),e.description?(a(),i("div",te,h(e.description),1)):_("",!0)]),t.childLink?(a(),m(s(S),{key:0,onClick:d[0]||(d[0]=V(()=>{},["stop"])),to:e.link+t.childLink,class:"btn outline sm child-btn"},{default:B(()=>[P(h(t.childName),1)]),_:2},1032,["to"])):_("",!0)]),_:2},1032,["to"]))),256))]))}});const le=z(ae,[["__scopeId","data-v-b886a2c8"]]),se={class:"page-title"},re=["innerHTML"],ue=q({__name:"ItemListView",props:{title:null,parentType:null,itemPred:null,childButton:null,titlePred:null,descPred:null,enableSearch:{type:Boolean},content:null},setup(b){const t=b,{namedNode:v}=G,d=K(J),e=O(),p=R(),{store:g,parseIntoStore:w,qname:n}=A(),{data:C,profiles:$,loading:I,error:L,doRequest:j}=H(),N=T([]),o=T(!1),r=M(()=>e.path.startsWith("/c/")?"CatPrez":e.path.startsWith("/s/")?"SpacePrez":e.path.startsWith("/v/")?"VocPrez":void 0);function x(){let l=[];return r.value?(l.push({name:r.value,url:`/${r.value[0].toLowerCase()}`}),t.parentType&&(["dcat:Dataset","geo:FeatureCollection"].includes(t.parentType)&&(l.push({name:"Datasets",url:"/s/datasets"}),l.push({name:"Dataset",url:`/s/datasets/${e.params.datasetId}`})),["geo:FeatureCollection"].includes(t.parentType)&&(l.push({name:"Feature Collections",url:`/s/datasets/${e.params.datasetId}/collections`}),l.push({name:"Feature Collection",url:`/s/datasets/${e.params.datasetId}/collections/${e.params.featureCollectionId}`})))):t.parentType==="prof:Profile"&&l.push({name:"Profiles",url:"/profiles"}),l}function D(){return t.enableSearch?{}:{}}return U(()=>{j(`${d}${e.path}`,()=>{if(e.query&&e.query._profile){const f=$.value.find(u=>u.default);e.query._profile===f.token&&!e.query._mediatype?o.value=!1:e.query._profile==="alt"&&!e.query._mediatype?o.value=!0:window.location.replace(`${d}${e.path}?_profile=${e.query._profile}${e.query._mediatype?`&_mediatype=${e.query._mediatype}`:""}`)}else o.value=!1;w(C.value);const l=g.value.getSubjects(v(n("a")),v(n("rdf:bag")),null)[0];g.value.forObjects(f=>{let u={iri:f.id};g.value.forEach(c=>{c.predicate.value===n(t.titlePred)?u.title=c.object.value:c.predicate.value===n(t.descPred)?u.description=c.object.value:c.predicate.value===n("prez:link")&&(u.link=c.object.value)},f,null,null,null),N.value.push(u)},l,v(n(t.itemPred)),null),o.value?p.rightNavConfig={enabled:!1}:p.rightNavConfig={enabled:!0,profiles:$.value,currentUrl:e.path},document.title=`${t.title} | Prez`,r.value?p.pageHeading={name:r.value,url:`/${r.value[0].toLowerCase()}`}:p.pageHeading={name:"Prez",url:"/"},p.breadcrumbs=[...x(),{name:t.title,url:e.path},...o.value?[{name:"Alternate Profiles",url:`${e.path}?_profile=alt`}]:[]]})}),(l,f)=>o.value?(a(),m(X,{key:0,profiles:s($),path:s(e).path},null,8,["profiles","path"])):(a(),i(y,{key:1},[k("h1",se,h(t.title),1),t.content?(a(),i("p",{key:0,innerHTML:t.content},null,8,re)):_("",!0),k("div",null,[s(C)?(a(),m(le,{key:0,items:N.value,childName:t.childButton?.name,childLink:t.childButton?.url},null,8,["items","childName","childLink"])):s(I)?(a(),i(y,{key:1},[P("loading...")],64)):s(L)?(a(),i(y,{key:2},[P("Network error: "+h(s(L)),1)],64)):_("",!0)]),t.enableSearch?(a(),m(E,{key:1,to:"#right-bar-content"},[W(Q,{flavour:s(r),query:D()},null,8,["flavour","query"])])):_("",!0)],64))}});export{ue as default};
