import{d as M,c as f,F as D,r as W,h as o,e as d,w as j,a as k,t as v,f as b,b as r,R as T,H as oe,q as L,_ as G,x as m,k as H,y as re,z as ie,A as ne,J as ue,p as ce,j as pe,i as de,L as fe,u as ve,v as he,s as _e,M as ge,o as me,m as U,T as be,B as Pe,l as ke,D as ye}from"./index.e25ce7c1.js";import{A as Ce}from"./AdvancedSearch.d44f83a4.js";import{e as $e,P as Le,S as Se}from"./helpers.2cb481e8.js";import{E as Ee}from"./ErrorMessage.f8fd7f98.js";import{L as ze}from"./LoadingMessage.0f6680de.js";const Ie={class:"list"},je={class:"list-item-left"},Te={class:"list-item-title"},De={key:0,class:"list-item-desc"},we=M({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(P){const a=P,y=200;return(t,i)=>(o(),f("div",Ie,[(o(!0),f(D,null,W(a.items,l=>(o(),d(r(T),{class:"list-item",to:l.link?l.link:""},{default:j(()=>[k("div",je,[k("h4",Te,v(l.title||l.iri),1),l.description?(o(),f("div",De,v(l.description.length>=y?l.description.slice(0,y)+"...":l.description),1)):b("",!0)]),a.childLink?(o(),d(r(T),{key:0,onClick:i[0]||(i[0]=oe(()=>{},["stop"])),to:l.link+a.childLink,class:"btn outline sm child-btn"},{default:j(()=>[L(v(a.childName),1)]),_:2},1032,["to"])):b("",!0)]),_:2},1032,["to"]))),256))]))}});const Fe=G(we,[["__scopeId","data-v-2f043e05"]]),K=P=>(ce("data-v-1eadacad"),P=P(),pe(),P),Ae={class:"pagination"},Ne={key:1},Ve=K(()=>k("i",{class:"fa-regular fa-ellipsis"},null,-1)),Be=[Ve],xe=["value"],Re={key:4},Me=K(()=>k("i",{class:"fa-regular fa-ellipsis"},null,-1)),Oe=[Me],qe=M({__name:"PaginationComponent",props:{totalCount:null,perPage:null,currentPage:null,url:null},setup(P){const a=P,y=10,t=m(a.currentPage),i=H(()=>{const l=a.perPage||y;return Math.ceil(a.totalCount/l)});return re(t,(l,S)=>{l!==S&&ue.push(`${a.url}?page=${l}${a.perPage?`&per_page=${a.perPage}`:""}`)}),(l,S)=>(o(),f("div",Ae,[a.currentPage>2?(o(),d(r(T),{key:0,to:`${a.url}?page=1${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[L(" 1 ")]),_:1},8,["to"])):b("",!0),a.currentPage>3?(o(),f("div",Ne,Be)):b("",!0),a.currentPage>1?(o(),d(r(T),{key:2,to:`${a.url}?page=${a.currentPage-1}${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[L(v(a.currentPage-1),1)]),_:1},8,["to"])):b("",!0),ie(k("select",{class:"pagination-btn",name:"",id:"",title:"Select page","onUpdate:modelValue":S[0]||(S[0]=e=>t.value=e)},[(o(!0),f(D,null,W([...Array(r(i))].map((e,A)=>A+1),e=>(o(),f("option",{value:e},v(e),9,xe))),256))],512),[[ne,t.value]]),a.currentPage<r(i)?(o(),d(r(T),{key:3,to:`${a.url}?page=${a.currentPage+1}${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[L(v(a.currentPage+1),1)]),_:1},8,["to"])):b("",!0),a.currentPage<r(i)-2?(o(),f("div",Re,Oe)):b("",!0),a.currentPage<r(i)-1?(o(),d(r(T),{key:5,to:`${a.url}?page=${r(i)}${a.perPage?`&per_page=${a.perPage}`:""}`,class:"btn outline pagination-btn"},{default:j(()=>[L(v(r(i)),1)]),_:1},8,["to"])):b("",!0)]))}});const Ue=G(qe,[["__scopeId","data-v-1eadacad"]]),We={class:"page-title"},Ge=["href"],He={key:0},Ze=M({__name:"ItemListView",setup(P){const{namedNode:a}=ye,y=de(Pe),t=fe(),i=ve(),{store:l,parseIntoStore:S,qname:e}=he(),{data:A,profiles:N,loading:V,error:O,doRequest:Q}=_e(),J=[e("rdfs:label")],X=[e("dcterms:description")],Y=[e("dcat:Catalog"),e("dcat:Dataset"),e("skos:ConceptScheme"),e("skos:Collection"),e("prof:Profile"),e("prez:CatPrezProfile"),e("prez:SpacePrezProfile"),e("prez:VocPrezProfile")],B="lt-prfl:alt-profile",C=m([]),n=m({uri:"",label:""}),x=m(0),w=m(!1),u=m(null),E=m(null),Z=m(!1),ee=m({}),F=m({showButton:!1,buttonTitle:"",buttonLink:""}),te=H(()=>t.query&&t.query.page?parseInt(t.query.page):1);function _(s){switch(n.value.uri=s,s){case e("dcat:Catalog"):n.value.label="Catalogs";break;case e("dcat:Dataset"):n.value.label="Datasets",F.value={showButton:!0,buttonTitle:"Collections",buttonLink:"/collections"};break;case e("geo:FeatureCollection"):n.value.label="Feature Collections",F.value={showButton:!0,buttonTitle:"Features",buttonLink:"/items"};break;case e("geo:Feature"):n.value.label="Features";break;case e("skos:ConceptScheme"):n.value.label="Vocabularies";break;case e("skos:Collection"):n.value.label="Collections";break;case e("prof:Profile"):case e("prez:CatPrezProfile"):case e("prez:SpacePrezProfile"):case e("prez:VocPrezProfile"):n.value.label="Profiles";break}}function ae(){let s=[];u.value&&s.push({name:ke(u.value)+" Home",url:`/${u.value[0].toLowerCase()}`});const c=t.path.split("/").slice(1);let z=!1;return c.forEach((R,g)=>{if(z){z=!1;return}switch(R){case"catalogs":s.push({name:"Catalogs",url:"/c/catalogs"});break;case"datasets":s.push({name:"Datasets",url:"/s/datasets"}),g+1!==c.length&&(s.push({name:"Dataset",url:`/s/datasets/${t.params.datasetId}`}),z=!0);break;case"collections":s.push({name:"Feature Collections",url:`/s/datasets/${t.params.datasetId}/collections`}),g+1!==c.length&&(s.push({name:"Feature Collection",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}`}),z=!0);break;case"items":s.push({name:"Features",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}/items`});break;case"vocab":s.push({name:"Vocabularies",url:"/v/vocab"});break;case"collection":s.push({name:"Collections",url:"/v/collection"});break;case"profiles":s.push({name:"Profiles",url:`${u.value?u.value[0].toLowerCase():""}/profiles`});break}}),w.value&&s.push({name:"Alternate Profiles",url:`${t.path}?_profile=${B}`}),s}function le(){let s=[];const c=l.value.getQuads(null,a(e("prez:count")),null,null)[0];x.value=parseInt(c.object.value),Y.includes(c.subject.value)?s=l.value.getSubjects(a(e("a")),c.subject,null):s=l.value.getObjects(c.subject,a(e("rdfs:member")),null);const z=E.value.labelPredicates.length>0?E.value.labelPredicates:J,R=E.value.descriptionPredicates.length>0?E.value.labelPredicates:X;s.forEach(g=>{let h={iri:g.id,extras:{}};l.value.forEach(p=>{if(z.includes(p.predicate.value))h.title=p.object.value;else if(R.includes(p.predicate.value))h.description=p.object.value;else if(p.predicate.value===e("prez:link"))h.link=p.object.value;else if(u.value==="VocPrez"&&p.predicate.value===e("reg:status")){const $={iri:p.object.value,label:q(p.object.value)};l.value.forObjects(I=>{$.label=I.value},p.object,e("rdfs:label"),null),l.value.forObjects(I=>{$.color=I.value},p.object,e("sdo:color"),null),h.extras.status=$}else u.value==="VocPrez"&&p.predicate.value===e("prov:qualifiedDerivation")&&l.value.forObjects($=>{const I={iri:$.value,label:q($.value)};l.value.forObjects(se=>{I.label=se.value},$,e("rdfs:label"),null),h.extras.derivationMode=I},p.object,e("prov:hadRole"),null)},g,null,null,null),C.value.push(h)}),C.value.sort((g,h)=>g.title&&h.title?g.title.localeCompare(h.title):g.title?-1:h.title?1:g.iri.localeCompare(h.iri))}function q(s){let c=s.split("#");return c.length===1?c[0].split("/").slice(-1)[0]:c.slice(-1)[0]}return ge(()=>{t.path.startsWith("/c/")?(u.value="CatPrez",t.path.match(/c\/profiles/)?_(e("prof:Profile")):t.path.match(/c\/catalogs/)&&_(e("dcat:Catalog"))):t.path.startsWith("/s/")&&(u.value="SpacePrez",t.path.match(/s\/profiles/)?_(e("prof:Profile")):t.path.match(/s\/datasets\/.+\/collections\/.+\/items/)?_(e("geo:Feature")):t.path.match(/s\/datasets\/.+\/collections/)?_(e("geo:FeatureCollection")):t.path.match(/s\/datasets/)&&_(e("dcat:Dataset"))),t.path.startsWith("/v/")?(u.value="VocPrez",t.path.match(/v\/profiles/)?_(e("prof:Profile")):t.path.match(/v\/vocab/)?_(e("skos:ConceptScheme")):t.path.match(/v\/collection/)&&_(e("skos:Collection"))):t.path.startsWith("/profiles")&&_(e("prof:Profile")),t.query._profile===B&&!t.query._mediatype&&(w.value=!0)}),me(()=>{V.value=!0,$e().then(()=>{Q(`${y}${t.fullPath}`,()=>{E.value=i.profiles[N.value.find(s=>s.default).uri],t.query&&t.query._profile&&(t.query._mediatype||![E.value.token,B].includes(t.query._profile))&&window.location.replace(`${y}${t.path}?_profile=${t.query._profile}${t.query._mediatype?`&_mediatype=${t.query._mediatype}`:""}`),w.value?i.rightNavConfig={enabled:!1}:i.rightNavConfig={enabled:!0,profiles:N.value,currentUrl:t.path},S(A.value),le(),document.title=`${n.value.label} | Prez`,i.breadcrumbs=ae()})})}),(s,c)=>w.value?(o(),d(Le,{key:0,profiles:r(N),path:r(t).path},null,8,["profiles","path"])):(o(),f(D,{key:1},[k("h1",We,v(n.value.label),1),k("p",null,[L("A list of "),k("a",{href:n.value.uri,target:"_blank",rel:"noopener noreferrer"},v(n.value.label)+".",9,Ge)]),!r(V)&&C.value.length>0?(o(),f("p",He,"Showing "+v(C.value.length)+" of "+v(x.value)+" items.",1)):b("",!0),r(O)?(o(),d(Ee,{key:1,message:r(O)},null,8,["message"])):r(V)?(o(),d(ze,{key:2})):C.value.length>0?(o(),f(D,{key:3},[u.value==="VocPrez"?(o(),d(Se,{key:0,items:C.value,predicates:["description","status","derivationMode"]},null,8,["items"])):(o(),d(Fe,{key:1,items:C.value,childName:F.value.buttonTitle,childLink:F.value.buttonLink},null,8,["items","childName","childLink"])),U(Ue,{url:r(t).path,totalCount:x.value,currentPage:r(te)},null,8,["url","totalCount","currentPage"])],64)):(o(),f(D,{key:4},[L("No "+v(n.value.label)+" found.",1)],64)),Z.value&&u.value?(o(),d(be,{key:5,to:"#right-bar-content"},[U(Ce,{flavour:u.value,query:ee.value},null,8,["flavour","query"])])):b("",!0)],64))}});export{Ze as default};
