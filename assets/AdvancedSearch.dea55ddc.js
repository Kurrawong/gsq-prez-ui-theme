import{d as M,i as T,s as P,v as V,x as v,y as B,o as L,c as o,z as m,A as z,a as l,F as k,r as I,D as N,B as Q,h as s,t as O,C as ae,E as Y,u as oe,G as Z,f as C,b as W,H as X,q as D,I as E,m as R,g as se,p as ne,j as ue,J as re,_ as ie}from"./index.cba3b563.js";const ce={class:"search-form"},de=l("label",{for:"catalog"},"Catalogs",-1),ve=["value"],pe=M({__name:"CatPrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(b,{emit:a}){const S=b,{namedNode:h}=N,y=T(Q),{data:i,loading:d,error:U,doRequest:g}=P(),{store:f,parseIntoStore:j,qnameToIri:p}=V(),$=v([]),u=v(S.defaultSelected?.split(",")||[]);return B(()=>S.defaultSelected,(t,e)=>{t&&t!==""&&(u.value=t.split(","),a("updateOptions",{catalog:u.value.join(",")}))}),L(()=>{g(`${y}/c/catalogs`,()=>{j(i.value),f.value.forSubjects(t=>{let e={iri:t.value};f.value.forEach(n=>{n.predicate.value===p("rdfs:label")&&(e.title=n.object.value)},t,null,null,null),$.value.push(e)},h(p("a")),h(p("dcat:Catalog")),null)})}),(t,e)=>(s(),o("div",ce,[de,m(l("select",{name:"catalog",id:"catalog","onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),onChange:e[1]||(e[1]=n=>a("updateOptions",{catalog:u.value.join(",")})),multiple:""},[(s(!0),o(k,null,I($.value,n=>(s(),o("option",{value:n.iri},O(n.title||n.iri),9,ve))),256))],544),[[z,u.value]])]))}}),fe={class:"search-form"},_e=l("label",{for:"dataset"},"Datasets",-1),he=["disabled"],me=["value"],be=l("label",{for:"collection"},"Feature Collections",-1),Se=["disabled"],ye=["value"],ge=l("label",{for:"use-cql"},"Use CQL",-1),$e=l("label",{for:"cql"},"CQL Query",-1),qe=["disabled"],Ce=M({__name:"SpacePrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(b,{emit:a}){const S=b,{namedNode:h}=N,y=T(Q),{data:i,loading:d,error:U,doRequest:g}=P(),{store:f,parseIntoStore:j,qnameToIri:p}=V(),$=v([]),u=v(S.defaultSelected?.dataset?.split(",")||[]),t=v([]),e=v(S.defaultSelected?.collection?.split(",")||[]),n=v(!1),F=v("");function A(){let _={};u.value.length>0&&(_.dataset=u.value.join(",")),e.value.length>0&&(_.collection=e.value.join(",")),a("updateOptions",_)}return B(()=>S.defaultSelected,(_,c)=>{_&&!Object.values(_).every(r=>r==="")&&(u.value=_.dataset?.split(",")||[],e.value=_.collection?.split(",")||[],A())},{deep:!0}),L(()=>{g(`${y}/s/datasets`,()=>{j(i.value),f.value.forSubjects(_=>{let c={iri:_.value},r="",ee=_.value;if(f.value.forEach(x=>{x.predicate.value===p("dcterms:title")?c.title=x.object.value:x.predicate.value===p("prez:link")&&(r=x.object.value)},_,null,null,null),$.value.push(c),r!==""){const{data:x,loading:et,error:tt,doRequest:te}=P(),{store:G,parseIntoStore:le,qnameToIri:K}=V();te(`${y}${r}/collections`,()=>{le(x.value),G.value.forObjects(w=>{let H={iri:w.value};G.value.forEach(J=>{J.predicate.value===K("rdfs:label")&&(H.title=J.object.value)},w,null,null,null),t.value.push(H)},h(ee),h(K("rdfs:member")),null)})}},h(p("a")),h(p("dcat:Dataset")),null)})}),(_,c)=>(s(),o("div",fe,[_e,m(l("select",{name:"dataset",id:"dataset","onUpdate:modelValue":c[0]||(c[0]=r=>u.value=r),onChange:c[1]||(c[1]=r=>A()),multiple:"",disabled:n.value},[(s(!0),o(k,null,I($.value,r=>(s(),o("option",{value:r.iri},O(r.title||r.iri),9,me))),256))],40,he),[[z,u.value]]),be,m(l("select",{name:"collection",id:"collection","onUpdate:modelValue":c[2]||(c[2]=r=>e.value=r),onChange:c[3]||(c[3]=r=>A()),multiple:"",disabled:n.value},[(s(!0),o(k,null,I(t.value,r=>(s(),o("option",{value:r.iri},O(r.title||r.iri),9,ye))),256))],40,Se),[[z,e.value]]),ge,m(l("input",{type:"checkbox",name:"use-cql",id:"use-cql","onUpdate:modelValue":c[4]||(c[4]=r=>n.value=r)},null,512),[[ae,n.value]]),$e,m(l("textarea",{name:"cql",id:"cql","onUpdate:modelValue":c[5]||(c[5]=r=>F.value=r),cols:"30",rows:"3",placeholder:"CQL query",disabled:!n.value},null,8,qe),[[Y,F.value]])]))}}),ke={class:"search-form"},Ue=l("label",{for:"vocab"},"Vocabs",-1),je=["value"],xe=M({__name:"VocPrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(b,{emit:a}){const S=b,{namedNode:h}=N,y=T(Q),{data:i,loading:d,error:U,doRequest:g}=P(),{store:f,parseIntoStore:j,qnameToIri:p}=V(),$=v([]),u=v(S.defaultSelected?.split(",")||[]);return B(()=>S.defaultSelected,(t,e)=>{t&&t!==""&&(u.value=t.split(","),a("updateOptions",{vocab:u.value.join(",")}))}),L(()=>{g(`${y}/v/vocab`,()=>{j(i.value),f.value.forSubjects(t=>{let e={iri:t.value};f.value.forEach(n=>{n.predicate.value===p("skos:prefLabel")&&(e.title=n.object.value)},t,null,null,null),$.value.push(e)},h(p("a")),h(p("skos:ConceptScheme")),null)})}),(t,e)=>(s(),o("div",ke,[Ue,m(l("select",{name:"vocab",id:"vocab","onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),onChange:e[1]||(e[1]=n=>a("updateOptions",{vocab:u.value.join(",")})),multiple:""},[(s(!0),o(k,null,I($.value,n=>(s(),o("option",{value:n.iri},O(n.title||n.iri),9,je))),256))],544),[[z,u.value]])]))}}),q=b=>(ne("data-v-7aa7c560"),b=b(),ue(),b),ze={class:"search-bar-container"},Ie=["placeholder"],Oe=q(()=>l("i",{class:"fa-regular fa-xmark"},null,-1)),Pe=[Oe],Ve={key:0,type:"submit",class:"btn submit-btn"},Me=q(()=>l("i",{class:"fa-regular fa-magnifying-glass"},null,-1)),Te=[Me],Be={class:"search-below"},Ae={key:0},De=q(()=>l("label",{for:"subsystem"},"Subsystem",-1)),Ee=q(()=>l("br",null,null,-1)),Re=q(()=>l("option",{value:"all"},"All",-1)),Le=["value"],Ne={key:1},Qe=q(()=>l("label",{for:"search-method"},"Search Method",-1)),Fe=q(()=>l("br",null,null,-1)),Ge=["value"],Ke=q(()=>l("i",{class:"fa-regular fa-chevron-up"},null,-1)),we=q(()=>l("i",{class:"fa-regular fa-chevron-down"},null,-1)),He={key:0},Je={key:1},Ze={key:2},We={key:3,type:"submit",class:"btn submit-btn"},Xe=q(()=>l("i",{class:"fa-regular fa-magnifying-glass"},null,-1)),Ye=M({__name:"AdvancedSearch",props:{flavour:null,query:null,fullPage:{type:Boolean,default:!1}},setup(b){const a=b,S=T(se),h=oe(),y="exactMatch",i=v(!1),d=v(a.flavour?a.flavour:a.query&&a.query.prez||"all"),U=v(a.query?a.query.term:""),g=v(a.query&&a.query.method?a.query.method:y),f=v({});B(d,(u,t)=>{u!==t&&u==="all"&&(i.value=!1),g.value=y});function j(){re.push({name:"search",query:{term:U.value,prez:d.value!=="all"?d.value:void 0,method:g.value||void 0,...f.value}})}function p(){U.value=""}function $(u){const t=u.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}return(u,t)=>(s(),o("form",{onSubmit:t[8]||(t[8]=X(e=>j(),["stop","prevent"]))},[l("div",{class:Z(`search-form ${a.fullPage?"lg":""}`)},[l("div",ze,[l("div",{class:Z(`search-bar ${i.value?"full-width":""}`)},[m(l("input",{type:"search",name:"term",id:"",class:"search-input","onUpdate:modelValue":t[0]||(t[0]=e=>U.value=e),placeholder:`${d.value==="all"?"Global search...":"Search..."}`},null,8,Ie),[[Y,U.value]]),l("button",{type:"button",onClick:t[1]||(t[1]=e=>p()),class:"clear-btn"},Pe)],2),i.value?C("",!0):(s(),o("button",Ve,Te))]),l("div",Be,[a.flavour?C("",!0):(s(),o("div",Ae,[De,Ee,m(l("select",{name:"prez",id:"",class:"subsystem","onUpdate:modelValue":t[2]||(t[2]=e=>d.value=e)},[Re,(s(!0),o(k,null,I(W(S),e=>(s(),o("option",{value:e},O(e),9,Le))),256))],512),[[z,d.value]])])),d.value!=="all"?(s(),o("div",Ne,[Qe,Fe,m(l("select",{name:"search-method",id:"search-method","onUpdate:modelValue":t[3]||(t[3]=e=>g.value=e)},[(s(!0),o(k,null,I(W(h).searchMethods[d.value],e=>(s(),o("option",{value:e},O($(e)),9,Ge))),256))],512),[[z,g.value]])])):C("",!0),d.value!=="all"?(s(),o("button",{key:2,type:"button",class:"collapse-btn",onClick:t[4]||(t[4]=X(e=>i.value=!i.value,["prevent"]))},[i.value?(s(),o(k,{key:0},[D("Collapse "),Ke],64)):(s(),o(k,{key:1},[D("Expand "),we],64))])):C("",!0)]),!a.flavour||a.flavour==="CatPrez"?m((s(),o("div",He,[R(pe,{onUpdateOptions:t[5]||(t[5]=e=>f.value=e),defaultSelected:a.query?.catalog},null,8,["defaultSelected"])],512)),[[E,d.value==="CatPrez"&&i.value]]):C("",!0),!a.flavour||a.flavour==="SpacePrez"?m((s(),o("div",Je,[R(Ce,{onUpdateOptions:t[6]||(t[6]=e=>f.value=e),defaultSelected:{dataset:a.query?.dataset,collection:a.query?.collection}},null,8,["defaultSelected"])],512)),[[E,d.value==="SpacePrez"&&i.value]]):C("",!0),!a.flavour||a.flavour==="VocPrez"?m((s(),o("div",Ze,[R(xe,{onUpdateOptions:t[7]||(t[7]=e=>f.value=e),defaultSelected:a.query?.vocab},null,8,["defaultSelected"])],512)),[[E,d.value==="VocPrez"&&i.value]]):C("",!0),i.value?(s(),o("button",We,[D("Search "),Xe])):C("",!0)],2)],32))}});const at=ie(Ye,[["__scopeId","data-v-7aa7c560"]]);export{at as A};
