import{d as z,c as i,F as I,r as K,h as l,e as $,w as S,a as p,t as g,f as h,b as u,R as w,H as Y,k as y,_ as D,L as Z,x as B,y as F,l as L,m as E,z as ee,A as te,J as ae,p as le,j as se,i as ne,M as re,u as ie,v as oe,s as ue,o as ce,T as de,D as pe,B as fe,n as _e}from"./index.6f5c308d.js";import{A as ve}from"./AdvancedSearch.da6fa321.js";import{P as ge}from"./ProfilesTable.93f35d90.js";import{E as he}from"./ErrorMessage.f3d82b45.js";const me={class:"list"},ye={class:"list-item-left"},be={class:"list-item-title"},$e={key:0,class:"list-item-desc"},Pe=z({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(v){const e=v;return(n,m)=>(l(),i("div",me,[(l(!0),i(I,null,K(e.items,t=>(l(),$(u(w),{class:"list-item",to:t.link?t.link:""},{default:S(()=>[p("div",ye,[p("h4",be,g(t.title||t.iri),1),t.description?(l(),i("div",$e,g(t.description),1)):h("",!0)]),e.childLink?(l(),$(u(w),{key:0,onClick:m[0]||(m[0]=Y(()=>{},["stop"])),to:t.link+e.childLink,class:"btn outline sm child-btn"},{default:S(()=>[y(g(e.childName),1)]),_:2},1032,["to"])):h("",!0)]),_:2},1032,["to"]))),256))]))}});const ke=D(Pe,[["__scopeId","data-v-c351f6e5"]]),Ce={key:0,class:"fa-solid fa-arrow-up-a-z"},Le={key:1,class:"fa-solid fa-arrow-down-z-a"},Ie={key:2,class:"fa-thin fa-arrow-up-a-z"},Se=z({__name:"ItemListSortButton",props:{id:null,state:{type:[Boolean,null]}},emits:["clicked"],setup(v){return(e,n)=>(l(),i("span",{class:"pointer",onClick:n[0]||(n[0]=m=>e.$emit("clicked",v.id))},[v.state===!0?(l(),i("i",Ce)):v.state===!1?(l(),i("i",Le)):(l(),i("i",Ie))]))}});const V=D(Se,[["__scopeId","data-v-977b01d0"]]),we={class:"table",role:"grid"},je={role:"row"},Me={class:"row",role:"row"},Be={key:0},ze={key:0},Ne={key:0},xe=z({__name:"VocabItemList",props:{items:null,childName:null,childLink:null},setup(v){const e=v,n=Z({label:!0,description:null,status:null,derivationMode:null}),m=B(e.items),t=o=>{const s=["label","description","status","derivationMode"],a=n[o];for(const r of s)n[r]=null;typeof a=="boolean"?a===!0?n[o]=!1:a===!1?n[o]=!0:n[o]=null:n[o]=!0};return F(n,()=>{const o=["label","description","status","derivationMode"],s={label:"title",description:"description",status:"status",derivationMode:"derivationMode"};for(const a of o)n[a]===!0?m.value=e.items.sort((r,j)=>{const b=s[a];return r.hasOwnProperty(b)?r[b].localeCompare(j[b]):0}):n[a]===!1&&(m.value=e.items.sort((r,j)=>{const b=s[a];return j.hasOwnProperty(b)?j[b].localeCompare(r[b]):0}))}),(o,s)=>(l(),i("table",we,[p("thead",null,[p("tr",je,[p("th",null,[y("Label "),L(V,{id:"label",state:n.label,onClicked:s[0]||(s[0]=a=>t(a))},null,8,["state"])]),p("th",null,[y("Description "),L(V,{id:"description",state:n.description,onClicked:s[1]||(s[1]=a=>t(a))},null,8,["state"])]),p("th",null,[y("Status "),L(V,{id:"status",state:n.status,onClicked:s[2]||(s[2]=a=>t(a))},null,8,["state"])]),p("th",null,[y("Derivation mode "),L(V,{id:"derivationMode",state:n.derivationMode,onClicked:s[3]||(s[3]=a=>t(a))},null,8,["state"])])])]),p("tbody",null,[(l(!0),i(I,null,K(e.items,a=>(l(),i("tr",Me,[p("td",null,[L(u(w),{to:a.link?a.link:""},{default:S(()=>[y(g(a.title||a.iri),1)]),_:2},1032,["to"])]),p("td",null,[a.description?(l(),i("div",Be,g(a.description.substring(0,80)+"..."),1)):h("",!0)]),p("td",null,[a.status?(l(),i("div",ze,g(a.status),1)):h("",!0)]),p("td",null,[a.derivationMode?(l(),i("div",Ne,g(a.derivationMode),1)):h("",!0)])]))),256))])]))}});const Ve=D(xe,[["__scopeId","data-v-b18a3829"]]),H=v=>(le("data-v-1eadacad"),v=v(),se(),v),De={class:"pagination"},Te={key:1},qe=H(()=>p("i",{class:"fa-regular fa-ellipsis"},null,-1)),Re=[qe],Ee=["value"],Ke={key:4},Oe=H(()=>p("i",{class:"fa-regular fa-ellipsis"},null,-1)),Ae=[Oe],Fe=z({__name:"PaginationComponent",props:{totalCount:null,perPage:null,currentPage:null,url:null},setup(v){const e=v,n=10,m=B(e.currentPage),t=E(()=>{const o=e.perPage||n;return Math.ceil(e.totalCount/o)});return F(m,(o,s)=>{o!==s&&ae.push(`${e.url}?page=${o}${e.perPage?`&per_page=${e.perPage}`:""}`)}),(o,s)=>(l(),i("div",De,[e.currentPage>2?(l(),$(u(w),{key:0,to:`${e.url}?page=1${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:S(()=>[y(" 1 ")]),_:1},8,["to"])):h("",!0),e.currentPage>3?(l(),i("div",Te,Re)):h("",!0),e.currentPage>1?(l(),$(u(w),{key:2,to:`${e.url}?page=${e.currentPage-1}${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:S(()=>[y(g(e.currentPage-1),1)]),_:1},8,["to"])):h("",!0),ee(p("select",{class:"pagination-btn",name:"",id:"",title:"Select page","onUpdate:modelValue":s[0]||(s[0]=a=>m.value=a)},[(l(!0),i(I,null,K([...Array(u(t))].map((a,r)=>r+1),a=>(l(),i("option",{value:a},g(a),9,Ee))),256))],512),[[te,m.value]]),e.currentPage<u(t)?(l(),$(u(w),{key:3,to:`${e.url}?page=${e.currentPage+1}${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:S(()=>[y(g(e.currentPage+1),1)]),_:1},8,["to"])):h("",!0),e.currentPage<u(t)-2?(l(),i("div",Ke,Ae)):h("",!0),e.currentPage<u(t)-1?(l(),$(u(w),{key:5,to:`${e.url}?page=${u(t)}${e.perPage?`&per_page=${e.perPage}`:""}`,class:"btn outline pagination-btn"},{default:S(()=>[y(g(u(t)),1)]),_:1},8,["to"])):h("",!0)]))}});const He=D(Fe,[["__scopeId","data-v-1eadacad"]]),Ue={class:"page-title"},We=["innerHTML"],Ge={key:1},Je=p("i",{class:"fa-regular fa-spinner-third fa-spin"},null,-1),et=z({__name:"ItemListView",props:{title:null,parentType:null,class:null,childButton:null,enableSearch:{type:Boolean},content:null},setup(v){const e=v,{namedNode:n}=pe,m=ne(fe),t=re(),o=ie(),{store:s,parseIntoStore:a,qname:r}=oe(),{data:j,profiles:b,loading:U,error:O,doRequest:W}=ue(),k=B([]),N=B(0),M=B(!1),P=E(()=>t.path.startsWith("/c/")?"CatPrez":t.path.startsWith("/s/")?"SpacePrez":t.path.startsWith("/v/")?"VocPrez":void 0),G=E(()=>t.query&&t.query.page?parseInt(t.query.page):1);function J(){let _=[];return P.value?(_.push({name:_e(P.value)+" Home",url:`/${P.value[0].toLowerCase()}`}),e.parentType&&(["dcat:Dataset","geo:FeatureCollection"].includes(e.parentType)&&(_.push({name:"Datasets",url:"/s/datasets"}),_.push({name:"Dataset",url:`/s/datasets/${t.params.datasetId}`})),["geo:FeatureCollection"].includes(e.parentType)&&(_.push({name:"Feature Collections",url:`/s/datasets/${t.params.datasetId}/collections`}),_.push({name:"Feature Collection",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}`})))):e.parentType==="prof:Profile"&&_.push({name:"Profiles",url:"/profiles"}),_}function Q(){return e.enableSearch?{}:{}}function A(_){let C=_.split("#");return C.length===1?C[0].split("/").slice(-1)[0]:C.slice(-1)[0]}return ce(()=>{let _="";t.query&&(t.query.page&&(_+=`?page=${t.query.page}`),t.query.per_page&&(t.query.page?_+="&":_+="?",_+=`per_page=${t.query.per_page}`)),W(`${m}${t.path}${_}`,()=>{const C=b.value.find(c=>c.default);t.query&&t.query._profile?t.query._profile===C.token&&!t.query._mediatype?M.value=!1:t.query._profile==="alt"&&!t.query._mediatype?M.value=!0:window.location.replace(`${m}${t.path}?_profile=${t.query._profile}${t.query._mediatype?`&_mediatype=${t.query._mediatype}`:""}`):M.value=!1,a(j.value);let T=[r("rdfs:label")],q=[r("dcterms:description")];if(Object.keys(o.profiles).includes(C.uri)){const c=o.profiles[C.uri];c.labelPredicates.length>0&&(T=c.labelPredicates),c.descriptionPredicates.length>0&&(q=c.descriptionPredicates)}let R=[];if(e.class)N.value=parseInt(s.value.getObjects(n(r(e.class)),n(r("prez:count")),null)[0].value),R=s.value.getSubjects(n(r("a")),n(r(e.class)),null);else{const c=s.value.getQuads(null,n(r("prez:count")),null,null)[0];N.value=parseInt(c.object.value),R=s.value.getObjects(c.subject,n(r("rdfs:member")),null)}R.forEach(c=>{let f={iri:c.id};P.value==="VocPrez"?(s.value.forEach(d=>{T.includes(d.predicate.value)?f.title=d.object.value:q.includes(d.predicate.value)?f.description=d.object.value:d.predicate.value===r("prez:link")?f.link=d.object.value:d.predicate.value===r("reg:status")?(f.status=A(d.object.value),s.value.forObjects(x=>{f.status=x.value},d.object,r("rdfs:label"),null)):d.predicate.value===r("prov:qualifiedDerivation")&&s.value.forObjects(x=>{f.derivationMode=A(x.value),s.value.forObjects(X=>{f.derivationMode=X.value},x,r("rdfs:label"),null)},d.object,r("prov:hadRole"),null)},c,null,null,null),k.value.push(f)):(s.value.forEach(d=>{T.includes(d.predicate.value)?f.title=d.object.value:q.includes(d.predicate.value)?f.description=d.object.value:d.predicate.value===r("prez:link")&&(f.link=d.object.value)},c,null,null,null),k.value.push(f))}),k.value.sort((c,f)=>c.title&&f.title?c.title.localeCompare(f.title):c.title?-1:f.title?1:c.iri.localeCompare(f.iri)),M.value?o.rightNavConfig={enabled:!1}:o.rightNavConfig={enabled:!0,profiles:b.value,currentUrl:t.path},document.title=`${e.title} | Prez`,P.value?o.pageHeading={name:P.value,url:`/${P.value[0].toLowerCase()}`}:o.pageHeading={name:"Prez",url:"/"},o.breadcrumbs=[...J(),{name:e.title,url:t.path},...M.value?[{name:"Alternate Profiles",url:`${t.path}?_profile=alt`}]:[]]})}),(_,C)=>M.value?(l(),$(ge,{key:0,profiles:u(b),path:u(t).path},null,8,["profiles","path"])):(l(),i(I,{key:1},[p("h1",Ue,g(e.title),1),e.content?(l(),i("p",{key:0,innerHTML:e.content},null,8,We)):h("",!0),k.value.length>0?(l(),i("p",Ge,"Showing "+g(k.value.length)+" of "+g(N.value)+" items.",1)):h("",!0),u(O)?(l(),$(he,{key:2,message:u(O)},null,8,["message"])):u(U)?(l(),i(I,{key:3},[Je,y(" Loading... ")],64)):k.value.length>0?(l(),i(I,{key:4},[u(P)==="VocPrez"?(l(),$(Ve,{key:0,items:k.value,childName:e.childButton?.name,childLink:e.childButton?.url},null,8,["items","childName","childLink"])):(l(),$(ke,{key:1,items:k.value,childName:e.childButton?.name,childLink:e.childButton?.url},null,8,["items","childName","childLink"])),L(He,{url:u(t).path,totalCount:N.value,currentPage:u(G)},null,8,["url","totalCount","currentPage"])],64)):(l(),i(I,{key:5},[y("No "+g(e.title)+" found.",1)],64)),e.enableSearch?(l(),$(de,{key:6,to:"#right-bar-content"},[L(ve,{flavour:u(P),query:Q()},null,8,["flavour","query"])])):h("",!0)],64))}});export{et as default};
