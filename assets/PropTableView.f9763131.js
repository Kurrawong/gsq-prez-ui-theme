import{_ as O,h as a,c as n,n as z,a as i,d as U,e as k,w as I,q as m,t as v,F as f,P as Y,r as B,Q as Z,S as q,b as w,f as A,p as ee,j as te,m as le,x as g,o as _e,y as Le,G as he,R as Ne,U as me,N as ge,i as Re,L as Ae,u as Be,v as De,s as Oe,M as Ue,V as Fe,T as Ve,B as Me,l as ze,W as be,X as Qe,D as We}from"./index.5e35a7b7.js";import{c as ye,e as Ge}from"./helpers.34d8ef61.js";import{A as He}from"./AdvancedSearch.032ef9f0.js";import{P as Je,S as Ke}from"./SortableTabularList.62fe1cc8.js";import{E as Xe,L as Ye}from"./LoadingMessage.be1fd6d6.js";import{_ as Ze}from"./MapClient.vue_vue_type_script_setup_true_lang.35e5d990.js";const qe={},et={class:"tooltip"},tt={class:"tooltip-text"};function lt(h,e){return a(),n("span",et,[z(h.$slots,"default",{},void 0,!0),i("span",tt,[z(h.$slots,"text",{},void 0,!0)])])}const ae=O(qe,[["render",lt],["__scopeId","data-v-5b46f6b0"]]),at=["href"],st=U({__name:"PredCell",props:{iri:null,qname:null,label:null,description:null,explanation:null},setup(h){const e=h;return(C,s)=>(a(),n("th",null,[(a(),k(Y(e.description?ae:"slot"),null,{text:I(()=>[m(v(e.description),1)]),default:I(()=>[i("a",{href:e.iri,target:"_blank",rel:"noopener noreferrer"},[e.label?(a(),n(f,{key:0},[m(v(e.label),1)],64)):e.qname?(a(),n(f,{key:1},[m(v(e.qname),1)],64)):(a(),n(f,{key:2},[m(v(e.iri),1)],64))],8,at)]),_:1}))]))}}),ot=h=>(ee("data-v-22deab1f"),h=h(),te(),h),rt={class:"prop-obj"},nt={class:"obj-value"},it={key:0},ut=["href"],ct=["href"],pt={key:1,class:"geom-cell"},dt=ot(()=>i("i",{class:"fa-regular fa-clipboard"},null,-1)),vt=[dt],ft={class:"obj-tag"},ht={key:0,class:"badge outline",title:"Language"},bt=["href"],_t=U({__name:"ObjCell",props:{value:null,qname:null,datatype:null,language:null,description:null,explanation:null,termType:null,label:null,rows:null},setup(h){const e=h,C=["http://www.opengis.net/ont/geosparql#geoJSONLiteral","http://www.opengis.net/ont/geosparql#wktLiteral"],s=100;return(P,d)=>(a(),n("div",rt,[i("div",nt,[e.termType==="BlankNode"?(a(),n("table",it,[(a(!0),n(f,null,B(e.rows,L=>(a(),k(ke,Z(q(L)),null,16))),256))])):e.termType==="NamedNode"?(a(),k(Y(e.description?ae:"slot"),{key:1},{text:I(()=>[m(v(e.description),1)]),default:I(()=>[i("a",{href:e.value,target:"_blank",rel:"noopener noreferrer"},[e.label?(a(),n(f,{key:0},[m(v(e.label),1)],64)):e.qname?(a(),n(f,{key:1},[m(v(e.qname),1)],64)):(a(),n(f,{key:2},[m(v(e.value),1)],64))],8,ut)]),_:1})):(a(),n(f,{key:2},[e.value.startsWith("http")?(a(),n("a",{key:0,href:e.value,target:"_blank",rel:"noopener noreferrer"},v(e.value),9,ct)):e.datatype&&C.includes(e.datatype.value)?(a(),n("div",pt,[i("pre",null,v(e.value.length>s?`${e.value.slice(0,s)}...`:e.value),1),i("button",{class:"btn outline sm",title:"Copy geometry",onClick:d[0]||(d[0]=L=>w(ye)(e.value))},vt)])):(a(),n(f,{key:2},[m(v(e.value),1)],64))],64))]),i("div",ft,[e.language?(a(),n("span",ht,v(e.language),1)):e.datatype?(a(),n("a",{key:1,href:e.datatype.value,target:"_blank",rel:"noopener noreferrer",class:"badge outline",title:"Datatype"},[e.datatype.qname?(a(),n(f,{key:0},[m(v(e.datatype.qname),1)],64)):(a(),n(f,{key:1},[m(v(e.datatype.value),1)],64))],8,bt)):A("",!0)])]))}});const mt=O(_t,[["__scopeId","data-v-22deab1f"]]),gt={class:"prop-objs"},yt=U({__name:"PropRow",props:{iri:null,objs:null,qname:null,label:null,description:null,explanation:null,order:null},setup(h){const e=h;return(C,s)=>(a(),n("tr",null,[le(st,{iri:e.iri,qname:e.qname,label:e.label,description:e.description,explanation:e.explanation},null,8,["iri","qname","label","description","explanation"]),i("td",gt,[(a(!0),n(f,null,B(e.objs,P=>(a(),k(mt,Z(q(P)),null,16))),256))])]))}});const ke=O(yt,[["__scopeId","data-v-3863cf0a"]]),se=h=>(ee("data-v-974c65c3"),h=h(),te(),h),kt={class:"page-title"},Ct={class:"iri"},jt=se(()=>i("span",{class:"badge"},"IRI",-1)),$t=["href"],Tt=se(()=>i("i",{class:"fa-regular fa-clipboard"},null,-1)),Pt=[Tt],wt={class:"type"},It=se(()=>i("span",{class:"badge"},"Type",-1)),St={class:"types"},xt=["href"],Et={key:0},Lt={key:0},Nt=U({__name:"PropTable",props:{item:null,properties:null,blankNodes:null,prefixes:null,hiddenPreds:null},setup(h){const e=h,C=g([]);function s(y){let t="";return Object.entries(e.prefixes).forEach(([r,E])=>{y.startsWith(E)&&(t=r+":"+y.split(E)[1])}),t}function P(y){if(y==="a")return e.prefixes.rdf+"type";{const[t,r]=y.split(":");return e.prefixes[t]+r}}function d(y,t){return y.annotations.find(r=>r.predicate.value===P(t))?.object.value}function L(y){let t={};return y.forEach(r=>{var E;t[E=r.predicate.value]??(t[E]={iri:r.predicate.value,objs:[],qname:s(r.predicate.value),label:d(r.predicate,"rdfs:label"),description:d(r.predicate,"dcterms:description"),explanation:d(r.predicate,"dcterms:provenance"),order:0}),t[r.predicate.value].objs.push({value:r.object.value,qname:r.object.termType==="NamedNode"?s(r.object.value):void 0,datatype:r.object.termType==="Literal"?{value:r.object.datatype.value,qname:s(r.object.datatype.value)}:void 0,language:r.object.termType==="Literal"?r.object.language:void 0,termType:r.object.termType,label:d(r.object,"rdfs:label"),description:d(r.object,"dcterms:description"),explanation:d(r.object,"dcterms:provenance"),rows:r.object.termType==="BlankNode"?L(e.blankNodes.filter(F=>F.subject.id===r.object.id)):[]})}),Object.values(t).sort((r,E)=>r.order-E.order)}return _e(()=>{const y=e.properties.filter(t=>!e.hiddenPreds.includes(t.predicate.value));C.value=L(y)}),(y,t)=>(a(),n(f,null,[i("h1",kt,[m(v(e.item.title||e.item.iri)+" ",1),i("small",Ct,[jt,i("a",{href:e.item.iri,target:"_blank",rel:"noopener noreferrer"},v(e.item.iri),9,$t),i("button",{class:"btn outline sm",title:"Copy IRI",onClick:t[0]||(t[0]=r=>w(ye)(e.item.iri))},Pt)]),i("small",wt,[It,i("div",St,[(a(!0),n(f,null,B(e.item.types,(r,E)=>(a(),n(f,null,[(a(),k(Y(r.description?ae:"slot"),null,{text:I(()=>[m(v(r.description),1)]),default:I(()=>[i("a",{href:r.value,target:"_blank",rel:"noopener noreferrer"},[r.label?(a(),n(f,{key:0},[m(v(r.label),1)],64)):r.qname?(a(),n(f,{key:1},[m(v(r.qname),1)],64)):(a(),n(f,{key:2},[m(v(r.value),1)],64))],8,xt)]),_:2},1024)),E<e.item.types.length-1?(a(),n("span",Et,", ")):A("",!0)],64))),256))])])]),z(y.$slots,"map",{},void 0,!0),e.item.description?(a(),n("p",Lt,[i("em",null,v(e.item.description),1)])):A("",!0),i("table",null,[z(y.$slots,"top",{},void 0,!0),(a(!0),n(f,null,B(C.value,r=>(a(),k(ke,Z(q(r)),null,16))),256)),z(y.$slots,"bottom",{},void 0,!0)])],64))}});const Rt=O(Nt,[["__scopeId","data-v-974c65c3"]]),At={class:"concept-top"},Bt={key:1,class:"concept-left"},Dt=U({__name:"ConceptComponent",props:{iri:null,title:null,link:null,children:null,narrower:null,broader:null,baseUrl:null,collapseAll:{type:Boolean}},setup(h){const e=h,C=g(!0);return Le(()=>e.collapseAll,(s,P)=>{C.value=s}),(s,P)=>{const d=ge("ConceptComponent",!0);return a(),n(f,null,[i("div",At,[e.children?(a(),n("button",{key:0,class:"concept-left btn outline",onClick:P[0]||(P[0]=L=>C.value=!C.value)},[i("i",{class:he(`fa-regular fa-${C.value?"plus":"minus"}`)},null,2)])):(a(),n("div",Bt)),le(w(Ne),{class:"concept",to:e.link},{default:I(()=>[m(v(e.title||e.iri),1)]),_:1},8,["to"])]),e.children?(a(),n("div",{key:0,class:he(`concept-children ${C.value?"collapse":""}`)},[(a(!0),n(f,null,B(e.children,L=>(a(),k(d,me(L,{baseUrl:e.baseUrl,collapseAll:e.collapseAll}),null,16,["baseUrl","collapseAll"]))),256))],2)):A("",!0)],64)}}});const Ot=O(Dt,[["__scopeId","data-v-e0711a9f"]]),oe=h=>(ee("data-v-ef639ea3"),h=h(),te(),h),Ut=oe(()=>i("th",null,"Concepts",-1)),Ft={class:"concepts"},Vt=oe(()=>i("i",{class:"fa-regular fa-plus"},null,-1)),Mt=oe(()=>i("i",{class:"fa-regular fa-minus"},null,-1)),zt=U({__name:"PropTableView",setup(h){const{namedNode:e}=We,C=Re(Me),s=Ae(),P=Be(),{store:d,prefixes:L,parseIntoStore:y,qnameToIri:t,iriToQname:r}=De(),{data:E,profiles:F,loading:re,error:ne,doRequest:Ce}=Oe(),ie=[t("rdfs:label")],je=[t("dcterms:description")],$e=[t("geo:hasBoundingBox"),t("geo:hasGeometry")],Te=[t("rdfs:member"),t("skos:member"),t("dcterms:hasPart")],Pe=5,K="lt-prfl:alt-profile",p=g({}),Q=g([]),ue=g([]),X=g([]),ce=g([]),W=g(!0),G=g([]),D=g(!1),H=g(!1),N=g(null),V=g(!1),M=g({}),pe=g(""),J=g([t("a"),t("dcterms:identifier"),t("prez:count")]),R=g(null),j=g({showChildren:!1,childrenTitle:"",showButton:!1,buttonTitle:"",buttonLink:""});function $(l){switch(p.value.baseClass=l,l){case t("dcat:Catalog"):V.value=!0,M.value={catalog:p.value.iri},j.value={...j.value,showChildren:!0,childrenTitle:"Resources"};break;case t("dcat:Resource"):break;case t("dcat:Dataset"):V.value=!0,M.value={dataset:p.value.iri},j.value={showChildren:!1,showButton:!0,childrenTitle:"Members",buttonTitle:"Collections",buttonLink:"/collections"};break;case t("geo:FeatureCollection"):V.value=!0,M.value={collection:p.value.iri},j.value={showChildren:!1,showButton:!0,childrenTitle:"Members",buttonTitle:"Features",buttonLink:"/items"};break;case t("geo:Feature"):break;case t("skos:ConceptScheme"):V.value=!0,M.value={vocab:p.value.iri},J.value.push(t("skos:hasTopConcept")),j.value.showChildren=!0;break;case t("skos:Collection"):j.value={...j.value,showChildren:!0,childrenTitle:"Concepts"};break;case t("skos:Concept"):break;case t("prof:Profile"):break}}function we(){const l=H.value?e(s.query.uri):d.value.getSubjects(e(t("a")),e(p.value.baseClass),null)[0];p.value={iri:l.id,types:[]};const u=R.value.labelPredicates.length>0?R.value.labelPredicates:ie,c=R.value.descriptionPredicates.length>0?R.value.labelPredicates:je;J.value.push(...u,...c),d.value.forEach(o=>{if(u.includes(o.predicate.value))p.value.title=o.object.value;else if(c.includes(o.predicate.value))p.value.description=o.object.value;else if(Te.includes(o.predicate.value))pe.value=o.predicate.value,J.value.push(o.predicate.value);else if(o.predicate.value===t("a")){$(o.object.value);const b=d.value.getObjects(o.object,e(t("rdfs:label")),null),S=d.value.getObjects(o.object,e(t("dcterms:description")),null),_=r(o.object.value);p.value.types.push({value:o.object.value,qname:_!==""?_:void 0,label:b.length>0?b[0].value:void 0,description:S.length>0?S[0].value:void 0})}else $e.indexOf(o.predicate.value)>=0&&d.value.forEach(b=>{G.value.push({label:"",fcLabel:"",wkt:b.object.value,uri:p.value.iri,link:`/object?uri=${p.value.iri}`})},o.object,e(t("geo:asWKT")),null,null);if(!D.value){const b=ve(o,d.value);X.value.push(b);let S=0;fe(o,d.value,S)}},l,null,null,null),G.value.forEach(o=>{o.label=p.value.title?p.value.title:p.value.iri})}function Ie(){let l=[];if(H.value)l.push({name:"Get Object by URI",url:"/object"});else{N.value&&l.push({name:ze(N.value)+" Home",url:`/${N.value[0].toLowerCase()}`});const u=s.path.split("/").slice(1,-1);let c=!1;u.forEach((o,b)=>{if(c){c=!1;return}switch(o){case"catalogs":l.push({name:"Catalogs",url:"/c/catalogs"}),b+1!==u.length&&(l.push({name:"Catalog",url:`/c/catalogs/${s.params.catalogId}`}),c=!0);break;case"datasets":l.push({name:"Datasets",url:"/s/datasets"}),b+1!==u.length&&(l.push({name:"Dataset",url:`/s/datasets/${s.params.datasetId}`}),c=!0);break;case"collections":l.push({name:"Feature Collections",url:`/s/datasets/${s.params.datasetId}/collections`}),b+1!==u.length&&(l.push({name:"Feature Collection",url:`/s/datasets/${s.params.datasetId}/collections/${s.params.featureCollectionId}`}),c=!0);break;case"items":l.push({name:"Features",url:`/s/datasets/${s.params.datasetId}/collections/${s.params.featureCollectionId}/items`});break;case"vocab":l.push({name:"Vocabularies",url:"/v/vocab"}),b+1!==u.length&&(l.push({name:"Vocabulary",url:`/v/vocab/${s.params.vocabId}`}),c=!0);break;case"collection":l.push({name:"Collections",url:"/v/collection"}),b+1!==u.length&&(l.push({name:"Collection",url:`/v/vocab/${s.params.collectionId}`}),c=!0);break;case"profiles":l.push({name:"Profiles",url:`${N.value?N.value[0].toLowerCase():""}/profiles`});break}})}return l.push({name:p.value.title||p.value.iri,url:s.path}),D.value&&l.push({name:"Alternate Profiles",url:`${s.path}?_profile=${K}`}),l}function de(l){let u=l.split("#");return u.length===1?u[0].split("/").slice(-1)[0]:u.slice(-1)[0]}function Se(){if(p.value.baseClass===t("skos:ConceptScheme"))xe();else{const l=R.value.labelPredicates.length>0?R.value.labelPredicates:ie;d.value.forObjects(u=>{let c={iri:u.id,extras:{}};d.value.forEach(o=>{if(l.includes(o.predicate.value))c.title=o.object.value;else if(o.predicate.value===t("prez:link"))c.link=o.object.value;else if(o.predicate.value===t("a"))c.baseClass=o.object.value;else if(p.value.baseClass===t("dcat:Catalog")&&o.predicate.value===t("dcterms:publisher")){const b={iri:o.object.value,label:de(o.object.value)};d.value.forObjects(S=>{b.label=S.value},o.object,t("rdfs:label"),null),c.extras.publisher=b}else if(p.value.baseClass===t("dcat:Catalog")&&o.predicate.value===t("dcterms:creator")){const b={iri:o.object.value,label:de(o.object.value)};d.value.forObjects(S=>{b.label=S.value},o.object,t("rdfs:label"),null),c.extras.creator=b}else if(p.value.baseClass===t("dcat:Catalog")&&o.predicate.value===t("dcterms:issued")){const b={label:o.object.value};c.extras.issued=b}},u,null,null,null),Q.value.push(c)},e(p.value.iri),e(pe.value),null),Q.value.sort((u,c)=>u.title&&c.title?u.title.localeCompare(c.title):u.title?-1:c.title?1:u.iri.localeCompare(c.iri))}}function xe(){let l=[];d.value.forSubjects(_=>{let T={iri:_.id,narrower:[],broader:"",title:"",link:""};d.value.forEach(x=>{x.predicate.value===t("skos:prefLabel")?T.title=x.object.value:x.predicate.value===t("prez:link")?T.link=x.object.value:x.predicate.value===t("skos:narrower")?T.narrower.push(x.object.value):x.predicate.value===t("skos:broader")&&(T.broader=x.object.value)},_,null,null,null),l.push(T)},e(t("skos:inScheme")),e(p.value.iri),null);const u=d.value.getObjects(e(p.value.iri),e(t("skos:hasTopConcept")),null).map(_=>_.id),c=d.value.getSubjects(e(t("skos:topConceptOf")),e(p.value.iri),null).map(_=>_.id),o=[...new Set([...u,...c])],b=l.reduce((_,T,x)=>(_[T.iri]=x,_),{});let S=[];l.forEach(_=>{if(_.narrower.length>0&&_.narrower.forEach(T=>l[b[T]].broader=_.iri),o.includes(_.iri)){S.push(_);return}if(_.broader){const T=l[b[_.broader]];T.children=[...T.children||[],_].sort((x,Ee)=>x.title.localeCompare(Ee.title))}}),S.sort((_,T)=>_.title.localeCompare(T.title)),ue.value=S}function ve(l,u){return{subject:l.subject,predicate:{termType:l.predicate.termType,value:l.predicate.value,id:l.predicate.id,annotations:u.getQuads(l.predicate,null,null,null)},object:{termType:l.object.termType,value:l.object.value,id:l.object.id,datatype:l.object instanceof be?l.object.datatype:void 0,language:l.object instanceof be?l.object.language:void 0,annotations:u.getQuads(l.object,null,null,null)},value:l.value,graph:l.graph,termType:l.termType,equals:l.equals,toJSON:l.toJSON}}function fe(l,u,c){l.object instanceof Qe&&(c++,u.forEach(o=>{const b=ve(o,u);ce.value.push(b),c<Pe&&fe(o,u,c)},l.object,null,null,null))}return Ue(()=>{s.path.startsWith("/c/")?(N.value="CatPrez",s.path.match(/c\/profiles\/.+/)?$(t("prof:Profile")):s.path.match(/c\/catalogs\/.+\/.+/)?$(t("dcat:Resource")):s.path.match(/c\/catalogs\/.+/)&&$(t("dcat:Catalog"))):s.path.startsWith("/s/")?(N.value="SpacePrez",s.path.match(/s\/profiles\/.+/)?$(t("prof:Profile")):s.path.match(/s\/datasets\/.+\/collections\/.+\/items\/.+/)?$(t("geo:Feature")):s.path.match(/s\/datasets\/.+\/collections\/.+/)?$(t("geo:FeatureCollection")):s.path.match(/s\/datasets\/.+/)&&$(t("dcat:Dataset"))):s.path.startsWith("/v/")?(N.value="VocPrez",s.path.match(/v\/profiles\/.+/)?$(t("prof:Profile")):s.path.match(/v\/vocab\/.+\/.+/)||s.path.match(/v\/collection\/.+\/.+/)?$(t("skos:Concept")):s.path.match(/v\/vocab\/.+/)?$(t("skos:ConceptScheme")):s.path.match(/v\/collection\/.+/)&&$(t("skos:Collection"))):s.path.startsWith("/profiles/")?$(t("prof:Profile")):s.path.startsWith("/object")&&(H.value=!0),s.query._profile===K&&!s.query._mediatype&&(D.value=!0)}),_e(()=>{re.value=!0,Ge().then(()=>{console.log("profiles ready"),Ce(`${C}${s.fullPath}`,()=>{R.value=P.profiles[F.value.find(l=>l.default).uri],s.query&&s.query._profile&&(s.query._mediatype||![R.value.token,K].includes(s.query._profile))&&window.location.replace(`${C}${s.path}?_profile=${s.query._profile}${s.query._mediatype?`&_mediatype=${s.query._mediatype}`:""}`),D.value?P.rightNavConfig={enabled:!1}:P.rightNavConfig={enabled:!0,profiles:F.value,currentUrl:s.path},y(E.value),we(),!D.value&&j.value.showChildren&&Se(),document.title=p.value.title?`${p.value.title} | Prez`:"Prez",P.breadcrumbs=Ie()})})}),(l,u)=>{const c=ge("RouterLink");return D.value?(a(),k(Je,{key:0,profiles:w(F),path:w(s).path},null,8,["profiles","path"])):(a(),n(f,{key:1},[X.value.length>0?(a(),k(Rt,{key:0,item:p.value,properties:X.value,blankNodes:ce.value,prefixes:w(L),hiddenPreds:J.value},Fe({map:I(()=>[G.value.length?(a(),k(Ze,{key:0,ref:"searchMapRef","geo-w-k-t":G.value},null,8,["geo-w-k-t"])):A("",!0)]),_:2},[p.value.baseClass===w(t)("skos:ConceptScheme")?{name:"bottom",fn:I(()=>[i("tr",null,[Ut,i("td",null,[i("div",Ft,[i("button",{id:"collapse-all-btn",onClick:u[0]||(u[0]=o=>W.value=!W.value),class:"btn"},[W.value?(a(),n(f,{key:0},[Vt,m(" Expand all")],64)):(a(),n(f,{key:1},[Mt,m(" Collapse all")],64))]),(a(!0),n(f,null,B(ue.value,o=>(a(),k(Ot,me(o,{baseUrl:w(s).path,collapseAll:W.value}),null,16,["baseUrl","collapseAll"]))),256))])])])]),key:"0"}:j.value.showChildren?{name:"bottom",fn:I(()=>[i("tr",null,[i("th",null,v(j.value.childrenTitle),1),p.value.baseClass===w(t)("dcat:Catalog")?(a(),k(Ke,{key:0,items:Q.value,predicates:["publisher","creator","issued"]},null,8,["items"])):(a(),n("td",{key:1},[i("div",{class:"children-list"},[(a(!0),n(f,null,B(Q.value,o=>(a(),k(c,{to:o.link||""},{default:I(()=>[m(v(o.title||o.iri),1)]),_:2},1032,["to"]))),256))])]))])]),key:"1"}:j.value.showButton&&!H.value?{name:"bottom",fn:I(()=>[i("tr",null,[i("th",null,v(j.value.childrenTitle),1),i("td",null,[le(c,{to:`${w(s).path}${j.value.buttonLink}`,class:"btn"},{default:I(()=>[m(v(j.value.buttonTitle),1)]),_:1},8,["to"])])])]),key:"2"}:void 0]),1032,["item","properties","blankNodes","prefixes","hiddenPreds"])):w(re)?(a(),k(Ye,{key:1})):w(ne)?(a(),k(Xe,{key:2,message:w(ne)},null,8,["message"])):A("",!0),V.value?(a(),k(Ve,{key:3,to:"#right-bar-content"},[N.value?(a(),k(He,{key:0,flavour:N.value,query:M.value},null,8,["flavour","query"])):A("",!0)])):A("",!0)],64))}}});const Xt=O(zt,[["__scopeId","data-v-ef639ea3"]]);export{Xt as default};
