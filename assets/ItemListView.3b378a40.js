import{d as R,c as v,F as N,r as K,h as s,e as f,w as T,a as C,t as h,f as b,b as r,R as D,H as ie,q as I,_ as G,x as d,k as Q,y as ne,z as ce,A as pe,J as de,p as fe,j as ve,i as W,L as he,u as _e,v as ge,s as me,M as be,o as Pe,m as H,T as ke,B as ye,N as Ce,l as $e,D as Le}from"./index.e4d92927.js";import{A as Se}from"./AdvancedSearch.2815feb0.js";import{P as Ie,S as ze}from"./SortableTabularList.ca09465f.js";import{E as Ee,L as je}from"./LoadingMessage.480e75a7.js";import{e as Te}from"./helpers.6e404483.js";const De={class:"list"},Ne={class:"list-item-left"},we={class:"list-item-title"},Fe={key:0,class:"list-item-desc"},Ve=R({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(y){const a=y,P=200;return(k,e)=>(s(),v("div",De,[(s(!0),v(N,null,K(a.items,o=>(s(),f(r(D),{class:"list-item",to:o.link?o.link:""},{default:T(()=>[C("div",Ne,[C("h4",we,h(o.title||o.iri),1),o.description?(s(),v("div",Fe,h(o.description.length>=P?o.description.slice(0,P)+"...":o.description),1)):b("",!0)]),a.childLink?(s(),f(r(D),{key:0,onClick:e[0]||(e[0]=ie(()=>{},["stop"])),to:o.link+a.childLink,class:"btn outline sm child-btn"},{default:T(()=>[I(h(a.childName),1)]),_:2},1032,["to"])):b("",!0)]),_:2},1032,["to"]))),256))]))}});const Ae=G(Ve,[["__scopeId","data-v-2f043e05"]]),J=y=>(fe("data-v-94c14714"),y=y(),ve(),y),Be={class:"pagination"},xe={key:1},qe=J(()=>C("i",{class:"fa-regular fa-ellipsis"},null,-1)),Me=[qe],Re=["value"],Oe={key:4},Ue=J(()=>C("i",{class:"fa-regular fa-ellipsis"},null,-1)),We=[Ue],He=R({__name:"PaginationComponent",props:{totalCount:null,perPage:null,currentPage:null,url:null},setup(y){const a=y,P=d(a.currentPage),k=d(Number(a.perPage)),e=Q(()=>Math.ceil(a.totalCount/k.value));return ne(P,(o,i)=>{o!==i&&de.push(`${a.url}?page=${o}&per_page=${k.value}`)}),(o,i)=>(s(),v("div",Be,[a.currentPage>2?(s(),f(r(D),{key:0,to:`${a.url}?page=1&per_page=${k.value}`,class:"btn outline pagination-btn"},{default:T(()=>[I(" 1 ")]),_:1},8,["to"])):b("",!0),a.currentPage>3?(s(),v("div",xe,Me)):b("",!0),a.currentPage>1?(s(),f(r(D),{key:2,to:`${a.url}?page=${a.currentPage-1}&per_page=${k.value}`,class:"btn outline pagination-btn"},{default:T(()=>[I(h(a.currentPage-1),1)]),_:1},8,["to"])):b("",!0),ce(C("select",{class:"pagination-btn",name:"",id:"",title:"Select page","onUpdate:modelValue":i[0]||(i[0]=$=>P.value=$)},[(s(!0),v(N,null,K([...Array(r(e))].map(($,t)=>t+1),$=>(s(),v("option",{value:$},h($),9,Re))),256))],512),[[pe,P.value]]),a.currentPage<r(e)?(s(),f(r(D),{key:3,to:`${a.url}?page=${a.currentPage+1}&per_page=${k.value}`,class:"btn outline pagination-btn"},{default:T(()=>[I(h(a.currentPage+1),1)]),_:1},8,["to"])):b("",!0),a.currentPage<r(e)-2?(s(),v("div",Oe,We)):b("",!0),a.currentPage<r(e)-1?(s(),f(r(D),{key:5,to:`${a.url}?page=${r(e)}&per_page=${k.value}`,class:"btn outline pagination-btn"},{default:T(()=>[I(h(r(e)),1)]),_:1},8,["to"])):b("",!0)]))}});const Ke=G(He,[["__scopeId","data-v-94c14714"]]),Ge={class:"page-title"},Qe=["href"],Je={key:0},at=R({__name:"ItemListView",setup(y){const{namedNode:a}=Le,P=W(ye),k=W(Ce),e=he(),o=_e(),{store:i,parseIntoStore:$,qnameToIri:t}=ge(),{data:X,profiles:A,loading:B,error:O,doRequest:Y}=me(),Z=[t("rdfs:label")],ee=[t("dcterms:description")],te=[t("dcat:Catalog"),t("dcat:Dataset"),t("skos:ConceptScheme"),t("skos:Collection"),t("prof:Profile"),t("prez:CatPrezProfile"),t("prez:SpacePrezProfile"),t("prez:VocPrezProfile")],x="lt-prfl:alt-profile",L=d([]),n=d({uri:"",label:""}),q=d(0),w=d(!1),c=d(null),z=d(null),ae=d(!1),le=d({}),F=d({showButton:!1,buttonTitle:"",buttonLink:""}),V=d(Number(k)),se=Q(()=>e.query&&e.query.page?parseInt(e.query.page):1);function g(l){switch(n.value.uri=l,l){case t("dcat:Catalog"):n.value.label="Catalogs";break;case t("dcat:Dataset"):n.value.label="Datasets",F.value={showButton:!0,buttonTitle:"Collections",buttonLink:"/collections"};break;case t("geo:FeatureCollection"):n.value.label="Feature Collections",F.value={showButton:!0,buttonTitle:"Features",buttonLink:"/items"};break;case t("geo:Feature"):n.value.label="Features";break;case t("skos:ConceptScheme"):n.value.label="Vocabularies";break;case t("skos:Collection"):n.value.label="Collections";break;case t("prof:Profile"):case t("prez:CatPrezProfile"):case t("prez:SpacePrezProfile"):case t("prez:VocPrezProfile"):n.value.label="Profiles";break}}function re(){let l=[];c.value&&l.push({name:$e(c.value)+" Home",url:`/${c.value[0].toLowerCase()}`});const u=e.path.split("/").slice(1);let E=!1;return u.forEach((M,m)=>{if(E){E=!1;return}switch(M){case"catalogs":l.push({name:"Catalogs",url:"/c/catalogs"});break;case"datasets":l.push({name:"Datasets",url:"/s/datasets"}),m+1!==u.length&&(l.push({name:"Dataset",url:`/s/datasets/${e.params.datasetId}`}),E=!0);break;case"collections":l.push({name:"Feature Collections",url:`/s/datasets/${e.params.datasetId}/collections`}),m+1!==u.length&&(l.push({name:"Feature Collection",url:`/s/datasets/${e.params.datasetId}/collections/${e.params.featureCollectionId}`}),E=!0);break;case"items":l.push({name:"Features",url:`/s/datasets/${e.params.datasetId}/collections/${e.params.featureCollectionId}/items`});break;case"vocab":l.push({name:"Vocabularies",url:"/v/vocab"});break;case"collection":l.push({name:"Collections",url:"/v/collection"});break;case"profiles":l.push({name:"Profiles",url:`${c.value?c.value[0].toLowerCase():""}/profiles`});break}}),w.value&&l.push({name:"Alternate Profiles",url:`${e.path}?_profile=${x}`}),l}function oe(){let l=[];const u=i.value.getQuads(null,a(t("prez:count")),null,null)[0];q.value=parseInt(u.object.value),te.includes(u.subject.value)?l=i.value.getSubjects(a(t("a")),u.subject,null):l=i.value.getObjects(u.subject,a(t("rdfs:member")),null);const E=z.value.labelPredicates.length>0?z.value.labelPredicates:Z,M=z.value.descriptionPredicates.length>0?z.value.labelPredicates:ee;l.forEach(m=>{let _={iri:m.id,extras:{}};i.value.forEach(p=>{if(E.includes(p.predicate.value))_.title=p.object.value;else if(M.includes(p.predicate.value))_.description=p.object.value;else if(p.predicate.value===t("prez:link"))_.link=p.object.value;else if(c.value==="VocPrez"&&p.predicate.value===t("reg:status")){const S={iri:p.object.value,label:U(p.object.value)};i.value.forObjects(j=>{S.label=j.value},p.object,t("rdfs:label"),null),i.value.forObjects(j=>{S.color=j.value},p.object,t("sdo:color"),null),_.extras.status=S}else c.value==="VocPrez"&&p.predicate.value===t("prov:qualifiedDerivation")&&i.value.forObjects(S=>{const j={iri:S.value,label:U(S.value)};i.value.forObjects(ue=>{j.label=ue.value},S,t("rdfs:label"),null),_.extras.derivationMode=j},p.object,t("prov:hadRole"),null)},m,null,null,null),L.value.push(_)}),L.value.sort((m,_)=>m.title&&_.title?m.title.localeCompare(_.title):m.title?-1:_.title?1:m.iri.localeCompare(_.iri))}function U(l){let u=l.split("#");return u.length===1?u[0].split("/").slice(-1)[0]:u.slice(-1)[0]}return be(()=>{e.path.startsWith("/c/")?(c.value="CatPrez",e.path.match(/c\/profiles/)?g(t("prof:Profile")):e.path.match(/c\/catalogs/)&&g(t("dcat:Catalog"))):e.path.startsWith("/s/")&&(c.value="SpacePrez",e.path.match(/s\/profiles/)?g(t("prof:Profile")):e.path.match(/s\/datasets\/.+\/collections\/.+\/items/)?g(t("geo:Feature")):e.path.match(/s\/datasets\/.+\/collections/)?g(t("geo:FeatureCollection")):e.path.match(/s\/datasets/)&&g(t("dcat:Dataset"))),e.path.startsWith("/v/")?(c.value="VocPrez",e.path.match(/v\/profiles/)?g(t("prof:Profile")):e.path.match(/v\/vocab/)?g(t("skos:ConceptScheme")):e.path.match(/v\/collection/)&&g(t("skos:Collection"))):e.path.startsWith("/profiles")&&g(t("prof:Profile")),e.query._profile===x&&!e.query._mediatype&&(w.value=!0),e.query.per_page&&(V.value=Number(e.query.per_page))}),Pe(()=>{B.value=!0;let l=Object.keys(e.query).length>0?e.query.per_page?e.fullPath:e.fullPath+`&per_page=${V.value}`:e.path+`?per_page=${V.value}`;Te().then(()=>{Y(`${P}${l}`,()=>{z.value=o.profiles[A.value.find(u=>u.default).uri],e.query&&e.query._profile&&(e.query._mediatype||![z.value.token,x].includes(e.query._profile))&&window.location.replace(`${P}${e.path}?_profile=${e.query._profile}${e.query._mediatype?`&_mediatype=${e.query._mediatype}`:""}`),w.value?o.rightNavConfig={enabled:!1}:o.rightNavConfig={enabled:!0,profiles:A.value,currentUrl:e.path},$(X.value),oe(),document.title=`${n.value.label} | Prez`,o.breadcrumbs=re()})})}),(l,u)=>w.value?(s(),f(Ie,{key:0,profiles:r(A),path:r(e).path},null,8,["profiles","path"])):(s(),v(N,{key:1},[C("h1",Ge,h(n.value.label),1),C("p",null,[I("A list of "),C("a",{href:n.value.uri,target:"_blank",rel:"noopener noreferrer"},h(n.value.label)+".",9,Qe)]),!r(B)&&L.value.length>0?(s(),v("p",Je,"Showing "+h(L.value.length)+" of "+h(q.value)+" items.",1)):b("",!0),r(O)?(s(),f(Ee,{key:1,message:r(O)},null,8,["message"])):r(B)?(s(),f(je,{key:2})):L.value.length>0?(s(),v(N,{key:3},[c.value==="VocPrez"?(s(),f(ze,{key:0,items:L.value,predicates:["description","status","derivationMode"]},null,8,["items"])):(s(),f(Ae,{key:1,items:L.value,childName:F.value.buttonTitle,childLink:F.value.buttonLink},null,8,["items","childName","childLink"])),H(Ke,{url:r(e).path,totalCount:q.value,currentPage:r(se),perPage:V.value},null,8,["url","totalCount","currentPage","perPage"])],64)):(s(),v(N,{key:4},[I("No "+h(n.value.label)+" found.",1)],64)),ae.value&&c.value?(s(),f(ke,{key:5,to:"#search-teleport"},[H(Se,{flavour:c.value,query:le.value},null,8,["flavour","query"])])):b("",!0)],64))}});export{at as default};
