import{d as M,i as U,L as V,u as $,s as D,v as T,x as f,y as F,o as O,c as r,m as w,b as d,e as b,F as k,a as s,r as G,f as S,B as K,h as e,w as H,t as C,p as W,j as J,D as Q,O as X,_ as Y}from"./index.cba3b563.js";import{A as Z}from"./AdvancedSearch.dea55ddc.js";import{E as ee,L as se}from"./LoadingMessage.4d3be192.js";import{_ as te}from"./MapClient.vue_vue_type_script_setup_true_lang.4fbcc6d6.js";const _=p=>(W("data-v-c6d36f45"),p=p(),J(),p),ae=_(()=>s("h1",{class:"page-title"},"Advanced Search",-1)),le=_(()=>s("h3",null,"Loading...",-1)),oe={key:2,class:"container"},re={class:"left-panel"},ce=_(()=>s("h2",null,"Results",-1)),ue=_(()=>s("div",{class:"results-cols"},[s("span",null,"Title"),s("span",null,"Source")],-1)),ne={key:0,class:"results"},ie={style:{color:"black"}},de={key:1},_e={key:0,class:"right-panel"},pe=_(()=>s("div",{class:"results-title"},"Spatial Results",-1)),he=M({__name:"SearchView",setup(p){const{namedNode:v}=Q,I=["skos:prefLabel","dcterms:title","rdfs:label","sdo:name"],q=U(K),a=V(),m=$(),{data:B,loading:E,error:R,doRequest:A}=D(),{store:g,parseIntoStore:x,qnameToIri:l}=T(),N=f(a.query),h=f([]),P=f(),n=f([]);function L(){a.query&&a.query.term&&(h.value=[],n.value=[],A(`${q}${a.fullPath}`,()=>{x(B.value);const i=I.map(o=>l(o));g.value.forSubjects(o=>{let c=o.value,t,j="",y;g.value.forEach(u=>{i.includes(u.predicate.value)?t=u.object.value:u.predicate.value===l("prez:searchResultSource")?j=u.object.value.replace(l("prez:"),""):u.predicate.value===l("geo:hasGeometry")&&g.value.forEach(z=>{y=z.object.value},u.object,v(l("geo:asWKT")),null,null)},o,null,null,null),h.value.push({uri:c,label:t,source:j}),y&&n.value.push({uri:c,link:`/object?uri=${c}`,label:t||c,fcLabel:"",wkt:y})},v(l("a")),v(l("prez:SearchResult")),null)}))}return F(()=>a.query,(i,o)=>{Object.keys(i).length>0&&i!==o&&L()},{deep:!0}),O(()=>{m.rightNavConfig={enabled:!1},document.title="Advanced Search | Prez",m.pageHeading={name:"Prez",url:"/"},m.breadcrumbs=[{name:"Advanced Search",url:"/search"}],Object.keys(a.query).length>0&&L()}),(i,o)=>{const c=X("RouterLink");return e(),r(k,null,[ae,w(Z,{query:N.value,fullPage:""},null,8,["query"]),d(R)?(e(),b(ee,{key:0,message:d(R)},null,8,["message"])):d(E)?(e(),r(k,{key:1},[le,w(se)],64)):d(a).query&&d(a).query.term?(e(),r("div",oe,[s("div",re,[ce,ue,h.value.length>0?(e(),r("div",ne,[(e(!0),r(k,null,G(h.value,t=>(e(),b(c,{class:"result",to:`/object?uri=${encodeURIComponent(t.uri)}`},{default:H(()=>[s("span",null,C(t.label||t.uri),1),s("span",ie,C(t.source),1)]),_:2},1032,["to"]))),256))])):(e(),r("p",de,"No results found."))]),n.value.length?(e(),r("div",_e,[pe,n.value.length?(e(),b(te,{key:0,ref_key:"searchMapRef",ref:P,"geo-w-k-t":n.value},null,8,["geo-w-k-t"])):S("",!0)])):S("",!0)])):S("",!0)],64)}}});const ye=Y(he,[["__scopeId","data-v-c6d36f45"]]);export{ye as default};
