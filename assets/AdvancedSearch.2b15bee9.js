import{d as D,m as V,n as I,r as b,q as L,o as H,a as u,c as r,s as S,v as x,b as t,F as O,t as B,D as J,i as N,x as E,j as R,k as T,y as se,z as te,A as Z,g as C,e as F,B as ee,C as G,E as w,l as K,p as ne,h as ue,G as re,_ as ce}from"./index.3da81066.js";const ie={class:"search-form"},de=t("label",{for:"catalog"},"Catalogs",-1),ve=["value"],pe=D({__name:"CatPrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(m,{emit:c}){const _=m,{namedNode:l}=J,{apiBaseUrl:i}=N(T,R),{data:g,loading:j,error:U,doRequest:q}=V(),{store:f,parseIntoStore:o,qname:e}=I(),y=b([]),d=b(_.defaultSelected?.split(",")||[]);return L(()=>_.defaultSelected,(v,s)=>{v&&v!==""&&(d.value=v.split(","),c("updateOptions",{catalog:d.value.join(",")}))}),H(()=>{q(`${i}/c/catalogs`,()=>{o(g.value);const v=f.value.getSubjects(l(e("a")),l(e("rdf:bag")),null)[0];f.value.forObjects(s=>{let a={iri:s.value};f.value.forEach($=>{$.predicate.value===e("dcterms:title")&&(a.title=$.object.value)},s,null,null,null),y.value.push(a)},v,l(e("rdfs:member")),null)})}),(v,s)=>(u(),r("div",ie,[de,S(t("select",{name:"catalog",id:"catalog","onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),onChange:s[1]||(s[1]=a=>c("updateOptions",{catalog:d.value.join(",")})),multiple:""},[(u(!0),r(O,null,B(y.value,a=>(u(),r("option",{value:a.iri},E(a.title||a.iri),9,ve))),256))],544),[[x,d.value]])]))}}),fe={class:"search-form"},be=t("label",{for:"dataset"},"Datasets",-1),_e=["disabled"],me=["value"],he=t("label",{for:"collection"},"Feature Collections",-1),Se=["disabled"],ge=["value"],ye=t("label",{for:"use-cql"},"Use CQL",-1),$e=t("label",{for:"cql"},"CQL Query",-1),je=["disabled"],qe=D({__name:"SpacePrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(m,{emit:c}){const _=m,{namedNode:l}=J,{apiBaseUrl:i}=N(T,R),{data:g,loading:j,error:U,doRequest:q}=V(),{store:f,parseIntoStore:o,qname:e}=I(),y=b([]),d=b(_.defaultSelected?.dataset?.split(",")||[]),v=b([]),s=b(_.defaultSelected?.collection?.split(",")||[]),a=b(!1),$=b("");function A(){let h={};d.value.length>0&&(h.dataset=d.value.join(",")),s.value.length>0&&(h.collection=s.value.join(",")),c("updateOptions",h)}return L(()=>_.defaultSelected,(h,p)=>{h&&!Object.values(h).every(n=>n==="")&&(d.value=h.dataset?.split(",")||[],s.value=h.collection?.split(",")||[],A())},{deep:!0}),H(()=>{q(`${i}/s/datasets`,()=>{o(g.value);const h=f.value.getSubjects(l(e("a")),l(e("rdf:bag")),null)[0];f.value.forObjects(p=>{let n={iri:p.value},M="";if(f.value.forEach(k=>{k.predicate.value===e("dcterms:title")?n.title=k.object.value:k.predicate.value===e("prez:link")&&(M=k.object.value)},p,null,null,null),y.value.push(n),M!==""){const{data:k,loading:we,error:Ke,doRequest:le}=V(),{store:Q,parseIntoStore:ae,qname:P}=I();le(`${i}${M}/collections`,()=>{ae(k.value);const oe=Q.value.getSubjects(l(P("a")),l(P("rdf:bag")),null)[0];Q.value.forObjects(W=>{let X={iri:W.value};Q.value.forEach(Y=>{Y.predicate.value===P("dcterms:title")&&(X.title=Y.object.value)},W,null,null,null),v.value.push(X)},oe,l(P("rdfs:member")),null)})}},h,l(e("rdfs:member")),null)})}),(h,p)=>(u(),r("div",fe,[be,S(t("select",{name:"dataset",id:"dataset","onUpdate:modelValue":p[0]||(p[0]=n=>d.value=n),onChange:p[1]||(p[1]=n=>A()),multiple:"",disabled:a.value},[(u(!0),r(O,null,B(y.value,n=>(u(),r("option",{value:n.iri},E(n.title||n.iri),9,me))),256))],40,_e),[[x,d.value]]),he,S(t("select",{name:"collection",id:"collection","onUpdate:modelValue":p[2]||(p[2]=n=>s.value=n),onChange:p[3]||(p[3]=n=>A()),multiple:"",disabled:a.value},[(u(!0),r(O,null,B(v.value,n=>(u(),r("option",{value:n.iri},E(n.title||n.iri),9,ge))),256))],40,Se),[[x,s.value]]),ye,S(t("input",{type:"checkbox",name:"use-cql",id:"use-cql","onUpdate:modelValue":p[4]||(p[4]=n=>a.value=n)},null,512),[[se,a.value]]),$e,S(t("textarea",{name:"cql",id:"cql","onUpdate:modelValue":p[5]||(p[5]=n=>$.value=n),cols:"30",rows:"3",placeholder:"CQL query",disabled:!a.value},null,8,je),[[te,$.value]])]))}}),Ce={class:"search-form"},ke=t("label",{for:"vocab"},"Vocabs",-1),Oe=["value"],ze=D({__name:"VocPrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(m,{emit:c}){const _=m,{namedNode:l}=J,{apiBaseUrl:i}=N(T,R),{data:g,loading:j,error:U,doRequest:q}=V(),{store:f,parseIntoStore:o,qname:e}=I(),y=b([]),d=b(_.defaultSelected?.split(",")||[]);return L(()=>_.defaultSelected,(v,s)=>{v&&v!==""&&(d.value=v.split(","),c("updateOptions",{vocab:d.value.join(",")}))}),H(()=>{q(`${i}/v/vocab`,()=>{o(g.value);const v=f.value.getSubjects(l(e("a")),l(e("rdf:bag")),null)[0];f.value.forObjects(s=>{let a={iri:s.value};f.value.forEach($=>{$.predicate.value===e("skos:prefLabel")&&(a.title=$.object.value)},s,null,null,null),y.value.push(a)},v,l(e("rdfs:member")),null)})}),(v,s)=>(u(),r("div",Ce,[ke,S(t("select",{name:"vocab",id:"vocab","onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),onChange:s[1]||(s[1]=a=>c("updateOptions",{vocab:d.value.join(",")})),multiple:""},[(u(!0),r(O,null,B(y.value,a=>(u(),r("option",{value:a.iri},E(a.title||a.iri),9,Oe))),256))],544),[[x,d.value]])]))}}),z=m=>(ne("data-v-a8665e9d"),m=m(),ue(),m),xe={class:"search-bar-container"},Ue=["placeholder"],Pe=z(()=>t("i",{class:"fa-regular fa-xmark"},null,-1)),Ve=[Pe],Ie={key:0,type:"submit",class:"btn submit-btn"},Be=z(()=>t("i",{class:"fa-regular fa-magnifying-glass"},null,-1)),Ee=[Be],De={class:"search-below"},Le=z(()=>t("option",{value:"all"},"All",-1)),Ne={key:0,value:"catprez"},Re={key:1,value:"spaceprez"},Te={key:2,value:"vocprez"},Ae=z(()=>t("i",{class:"fa-regular fa-chevron-up"},null,-1)),Me=z(()=>t("i",{class:"fa-regular fa-chevron-down"},null,-1)),Qe={key:0,type:"submit",class:"btn submit-btn"},Fe=z(()=>t("i",{class:"fa-regular fa-magnifying-glass"},null,-1)),Ge=D({__name:"AdvancedSearch",props:{flavour:null,query:null,fullPage:{type:Boolean,default:!1}},setup(m){const c=m,{enabledPrezs:_}=N(T,R),l=b(!1),i=b(c.flavour?c.flavour:c.query&&c.query.searchType||"all"),g=b(c.query?c.query.filter:""),j=b({});L(i,(f,o)=>{f!==o&&f==="all"&&(l.value=!1)});function U(){re.push({name:"search",query:{filter:g.value,searchType:i.value!=="all"?i.value:void 0,...j.value}})}function q(){g.value=""}return(f,o)=>(u(),r("form",{onSubmit:o[7]||(o[7]=ee(e=>U(),["stop","prevent"]))},[t("div",{class:Z(`search-form ${c.fullPage?"lg":""}`)},[t("div",xe,[t("div",{class:Z(`search-bar ${l.value?"full-width":""}`)},[S(t("input",{type:"search",name:"filter",id:"",class:"search-input","onUpdate:modelValue":o[0]||(o[0]=e=>g.value=e),placeholder:`${i.value==="all"?"Global search...":"Search..."}`},null,8,Ue),[[te,g.value]]),t("button",{type:"button",onClick:o[1]||(o[1]=e=>q()),class:"clear-btn"},Ve)],2),l.value?C("",!0):(u(),r("button",Ie,Ee))]),t("div",De,[c.flavour?C("",!0):S((u(),r("select",{key:0,name:"searchType",id:"",class:"search-type","onUpdate:modelValue":o[2]||(o[2]=e=>i.value=e)},[Le,F(_).includes("CatPrez")?(u(),r("option",Ne,"CatPrez")):C("",!0),F(_).includes("SpacePrez")?(u(),r("option",Re,"SpacePrez")):C("",!0),F(_).includes("VocPrez")?(u(),r("option",Te,"VocPrez")):C("",!0)],512)),[[x,i.value]]),i.value!=="all"?(u(),r("button",{key:1,type:"button",class:"collapse-btn",onClick:o[3]||(o[3]=ee(e=>l.value=!l.value,["prevent"]))},[l.value?(u(),r(O,{key:0},[G("Collapse "),Ae],64)):(u(),r(O,{key:1},[G("Expand "),Me],64))])):C("",!0)]),S(t("div",null,[K(pe,{onUpdateOptions:o[4]||(o[4]=e=>j.value=e),defaultSelected:c.query?.catalog},null,8,["defaultSelected"])],512),[[w,i.value==="catprez"&&l.value]]),S(t("div",null,[K(qe,{onUpdateOptions:o[5]||(o[5]=e=>j.value=e),defaultSelected:{dataset:c.query?.dataset,collection:c.query?.collection}},null,8,["defaultSelected"])],512),[[w,i.value==="spaceprez"&&l.value]]),S(t("div",null,[K(ze,{onUpdateOptions:o[6]||(o[6]=e=>j.value=e),defaultSelected:c.query?.vocab},null,8,["defaultSelected"])],512),[[w,i.value==="vocprez"&&l.value]]),l.value?(u(),r("button",Qe,[G("Search "),Fe])):C("",!0)],2)],32))}});const Je=ce(Ge,[["__scopeId","data-v-a8665e9d"]]);export{Je as A};
