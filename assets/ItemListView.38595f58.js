import{d as I,a as s,c as o,F as m,t as D,f as h,w as $,b as _,x as u,g as v,e as r,R as B,B as F,C as y,_ as z,u as R,n as V,m as H,r as U,H as W,o as A,l as E,T as M,D as G,i as K,I as O,j as q,k as J}from"./index.3da81066.js";import{A as Q}from"./AdvancedSearch.2b15bee9.js";const X={class:"list"},Y={class:"list-item-left"},Z={class:"list-item-title"},ee={key:0,class:"list-item-desc"},te=I({__name:"ItemList",props:{items:null,childName:null,childLink:null},setup(k){const e=k;return(c,d)=>(s(),o("div",X,[(s(!0),o(m,null,D(e.items,t=>(s(),h(r(B),{class:"list-item",to:t.link?t.link:""},{default:$(()=>[_("div",Y,[_("h4",Z,u(t.title||t.iri),1),t.description?(s(),o("div",ee,u(t.description),1)):v("",!0)]),e.childLink?(s(),h(r(B),{key:0,onClick:d[0]||(d[0]=F(()=>{},["stop"])),to:t.link+e.childLink,class:"btn outline sm child-btn"},{default:$(()=>[y(u(e.childName),1)]),_:2},1032,["to"])):v("",!0)]),_:2},1032,["to"]))),256))]))}});const ae=z(te,[["__scopeId","data-v-b886a2c8"]]),se={class:"page-title"},ne=I({__name:"ItemListView",props:{title:null,parentType:null,itemPred:null,childButton:null,titlePred:null,descPred:null,enableSearch:{type:Boolean}},setup(k){const e=k,{namedNode:c}=G,{apiBaseUrl:d}=K(J,q),t=O(),p=R(),{store:g,parseIntoStore:N,qname:n}=V(),{data:C,profiles:S,loading:j,error:L,doRequest:w}=H(),P=U([]),l=W(()=>t.path.startsWith("/c/")?"CatPrez":t.path.startsWith("/s/")?"SpacePrez":t.path.startsWith("/v/")?"VocPrez":void 0);function x(){let a=[];return l.value?(a.push({name:l.value,url:`/${l.value[0].toLowerCase()}`}),e.parentType&&(["dcat:Dataset","geo:FeatureCollection"].includes(e.parentType)&&(a.push({name:"Datasets",url:"/s/datasets"}),a.push({name:"Dataset",url:`/s/datasets/${t.params.datasetId}`})),["geo:FeatureCollection"].includes(e.parentType)&&(a.push({name:"Feature Collections",url:`/s/datasets/${t.params.datasetId}/collections`}),a.push({name:"Feature Collection",url:`/s/datasets/${t.params.datasetId}/collections/${t.params.featureCollectionId}`})))):e.parentType==="prof:Profile"&&a.push({name:"Profiles",url:"/profiles"}),a}function T(){return e.enableSearch?{}:{}}return A(()=>{w(`${d.replace(/\/$/,"")}${t.path}`,()=>{N(C.value);const a=g.value.getSubjects(c(n("a")),c(n("rdf:bag")),null)[0];g.value.forObjects(b=>{let f={iri:b.id};g.value.forEach(i=>{i.predicate.value===n(e.titlePred)?f.title=i.object.value:i.predicate.value===n(e.descPred)?f.description=i.object.value:i.predicate.value===n("prez:link")&&(f.link=i.object.value)},b,null,null,null),P.value.push(f)},a,c(n(e.itemPred)),null),p.rightNavConfig={enabled:!0,profiles:S.value,currentUrl:t.path},document.title=`${e.title} | Prez`,l.value?p.pageHeading={name:l.value,url:`/${l.value[0].toLowerCase()}`}:p.pageHeading={name:"Prez",url:"/"},p.breadcrumbs=[...x(),{name:e.title,url:t.path}]})}),(a,b)=>(s(),o(m,null,[_("h1",se,u(e.title),1),_("div",null,[r(C)?(s(),h(ae,{key:0,items:P.value,childName:e.childButton?.name,childLink:e.childButton?.url},null,8,["items","childName","childLink"])):r(j)?(s(),o(m,{key:1},[y("loading...")],64)):r(L)?(s(),o(m,{key:2},[y("Network error: "+u(r(L)),1)],64)):v("",!0)]),e.enableSearch?(s(),h(M,{key:0,to:"#right-bar-content"},[E(Q,{flavour:r(l)?r(l).toLowerCase():void 0,query:T()},null,8,["flavour","query"])])):v("",!0)],64))}});export{ne as default};
