import{d as D,l as V,m as B,r as b,n as L,o as K,a as u,c as r,q as S,v as P,b as t,F as z,s as I,D as w,i as N,t as E,x as H,y as oe,z as ee,A as Y,g as q,e as M,B as Z,C as Q,E as F,k as G,p as se,h as ne,j as ue,G as re,_ as ce}from"./index.0b20cfe3.js";const ie={class:"search-form"},de=t("label",{for:"catalog"},"Catalogs",-1),ve=["value"],pe=D({__name:"CatPrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(m,{emit:c}){const _=m,{namedNode:l}=w,i=N(H),{data:g,loading:j,error:x,doRequest:C}=V(),{store:f,parseIntoStore:o,qname:e}=B(),y=b([]),d=b(_.defaultSelected?.split(",")||[]);return L(()=>_.defaultSelected,(v,s)=>{v&&v!==""&&(d.value=v.split(","),c("updateOptions",{catalog:d.value.join(",")}))}),K(()=>{C(`${i}/c/catalogs`,()=>{o(g.value);const v=f.value.getSubjects(l(e("a")),l(e("rdf:bag")),null)[0];f.value.forObjects(s=>{let a={iri:s.value};f.value.forEach($=>{$.predicate.value===e("dcterms:title")&&(a.title=$.object.value)},s,null,null,null),y.value.push(a)},v,l(e("rdfs:member")),null)})}),(v,s)=>(u(),r("div",ie,[de,S(t("select",{name:"catalog",id:"catalog","onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),onChange:s[1]||(s[1]=a=>c("updateOptions",{catalog:d.value.join(",")})),multiple:""},[(u(!0),r(z,null,I(y.value,a=>(u(),r("option",{value:a.iri},E(a.title||a.iri),9,ve))),256))],544),[[P,d.value]])]))}}),fe={class:"search-form"},be=t("label",{for:"dataset"},"Datasets",-1),_e=["disabled"],me=["value"],he=t("label",{for:"collection"},"Feature Collections",-1),Se=["disabled"],ge=["value"],ye=t("label",{for:"use-cql"},"Use CQL",-1),$e=t("label",{for:"cql"},"CQL Query",-1),je=["disabled"],Ce=D({__name:"SpacePrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(m,{emit:c}){const _=m,{namedNode:l}=w,i=N(H),{data:g,loading:j,error:x,doRequest:C}=V(),{store:f,parseIntoStore:o,qname:e}=B(),y=b([]),d=b(_.defaultSelected?.dataset?.split(",")||[]),v=b([]),s=b(_.defaultSelected?.collection?.split(",")||[]),a=b(!1),$=b("");function R(){let h={};d.value.length>0&&(h.dataset=d.value.join(",")),s.value.length>0&&(h.collection=s.value.join(",")),c("updateOptions",h)}return L(()=>_.defaultSelected,(h,p)=>{h&&!Object.values(h).every(n=>n==="")&&(d.value=h.dataset?.split(",")||[],s.value=h.collection?.split(",")||[],R())},{deep:!0}),K(()=>{C(`${i}/s/datasets`,()=>{o(g.value);const h=f.value.getSubjects(l(e("a")),l(e("rdf:bag")),null)[0];f.value.forObjects(p=>{let n={iri:p.value},T="";if(f.value.forEach(k=>{k.predicate.value===e("dcterms:title")?n.title=k.object.value:k.predicate.value===e("prez:link")&&(T=k.object.value)},p,null,null,null),y.value.push(n),T!==""){const{data:k,loading:Ke,error:we,doRequest:te}=V(),{store:A,parseIntoStore:le,qname:U}=B();te(`${i}${T}/collections`,()=>{le(k.value);const ae=A.value.getSubjects(l(U("a")),l(U("rdf:bag")),null)[0];A.value.forObjects(J=>{let W={iri:J.value};A.value.forEach(X=>{X.predicate.value===U("dcterms:title")&&(W.title=X.object.value)},J,null,null,null),v.value.push(W)},ae,l(U("rdfs:member")),null)})}},h,l(e("rdfs:member")),null)})}),(h,p)=>(u(),r("div",fe,[be,S(t("select",{name:"dataset",id:"dataset","onUpdate:modelValue":p[0]||(p[0]=n=>d.value=n),onChange:p[1]||(p[1]=n=>R()),multiple:"",disabled:a.value},[(u(!0),r(z,null,I(y.value,n=>(u(),r("option",{value:n.iri},E(n.title||n.iri),9,me))),256))],40,_e),[[P,d.value]]),he,S(t("select",{name:"collection",id:"collection","onUpdate:modelValue":p[2]||(p[2]=n=>s.value=n),onChange:p[3]||(p[3]=n=>R()),multiple:"",disabled:a.value},[(u(!0),r(z,null,I(v.value,n=>(u(),r("option",{value:n.iri},E(n.title||n.iri),9,ge))),256))],40,Se),[[P,s.value]]),ye,S(t("input",{type:"checkbox",name:"use-cql",id:"use-cql","onUpdate:modelValue":p[4]||(p[4]=n=>a.value=n)},null,512),[[oe,a.value]]),$e,S(t("textarea",{name:"cql",id:"cql","onUpdate:modelValue":p[5]||(p[5]=n=>$.value=n),cols:"30",rows:"3",placeholder:"CQL query",disabled:!a.value},null,8,je),[[ee,$.value]])]))}}),qe={class:"search-form"},ke=t("label",{for:"vocab"},"Vocabs",-1),ze=["value"],Oe=D({__name:"VocPrezSearch",props:{defaultSelected:null},emits:["updateOptions"],setup(m,{emit:c}){const _=m,{namedNode:l}=w,i=N(H),{data:g,loading:j,error:x,doRequest:C}=V(),{store:f,parseIntoStore:o,qname:e}=B(),y=b([]),d=b(_.defaultSelected?.split(",")||[]);return L(()=>_.defaultSelected,(v,s)=>{v&&v!==""&&(d.value=v.split(","),c("updateOptions",{vocab:d.value.join(",")}))}),K(()=>{C(`${i}/v/vocab`,()=>{o(g.value);const v=f.value.getSubjects(l(e("a")),l(e("rdf:bag")),null)[0];f.value.forObjects(s=>{let a={iri:s.value};f.value.forEach($=>{$.predicate.value===e("skos:prefLabel")&&(a.title=$.object.value)},s,null,null,null),y.value.push(a)},v,l(e("rdfs:member")),null)})}),(v,s)=>(u(),r("div",qe,[ke,S(t("select",{name:"vocab",id:"vocab","onUpdate:modelValue":s[0]||(s[0]=a=>d.value=a),onChange:s[1]||(s[1]=a=>c("updateOptions",{vocab:d.value.join(",")})),multiple:""},[(u(!0),r(z,null,I(y.value,a=>(u(),r("option",{value:a.iri},E(a.title||a.iri),9,ze))),256))],544),[[P,d.value]])]))}}),O=m=>(se("data-v-2a1f0183"),m=m(),ne(),m),Pe={class:"search-bar-container"},xe=["placeholder"],Ue=O(()=>t("i",{class:"fa-regular fa-xmark"},null,-1)),Ve=[Ue],Be={key:0,type:"submit",class:"btn submit-btn"},Ie=O(()=>t("i",{class:"fa-regular fa-magnifying-glass"},null,-1)),Ee=[Ie],De={class:"search-below"},Le=O(()=>t("option",{value:"all"},"All",-1)),Ne={key:0,value:"CatPrez"},Re={key:1,value:"SpacePrez"},Te={key:2,value:"VocPrez"},Ae=O(()=>t("i",{class:"fa-regular fa-chevron-up"},null,-1)),Me=O(()=>t("i",{class:"fa-regular fa-chevron-down"},null,-1)),Qe={key:0,type:"submit",class:"btn submit-btn"},Fe=O(()=>t("i",{class:"fa-regular fa-magnifying-glass"},null,-1)),Ge=D({__name:"AdvancedSearch",props:{flavour:null,query:null,fullPage:{type:Boolean,default:!1}},setup(m){const c=m,_=N(ue),l=b(!1),i=b(c.flavour?c.flavour:c.query&&c.query.searchType||"all"),g=b(c.query?c.query.filter:""),j=b({});L(i,(f,o)=>{f!==o&&f==="all"&&(l.value=!1)});function x(){re.push({name:"search",query:{filter:g.value,searchType:i.value!=="all"?i.value:void 0,...j.value}})}function C(){g.value=""}return(f,o)=>(u(),r("form",{onSubmit:o[7]||(o[7]=Z(e=>x(),["stop","prevent"]))},[t("div",{class:Y(`search-form ${c.fullPage?"lg":""}`)},[t("div",Pe,[t("div",{class:Y(`search-bar ${l.value?"full-width":""}`)},[S(t("input",{type:"search",name:"filter",id:"",class:"search-input","onUpdate:modelValue":o[0]||(o[0]=e=>g.value=e),placeholder:`${i.value==="all"?"Global search...":"Search..."}`},null,8,xe),[[ee,g.value]]),t("button",{type:"button",onClick:o[1]||(o[1]=e=>C()),class:"clear-btn"},Ve)],2),l.value?q("",!0):(u(),r("button",Be,Ee))]),t("div",De,[c.flavour?q("",!0):S((u(),r("select",{key:0,name:"searchType",id:"",class:"search-type","onUpdate:modelValue":o[2]||(o[2]=e=>i.value=e)},[Le,M(_).includes("CatPrez")?(u(),r("option",Ne,"CatPrez")):q("",!0),M(_).includes("SpacePrez")?(u(),r("option",Re,"SpacePrez")):q("",!0),M(_).includes("VocPrez")?(u(),r("option",Te,"VocPrez")):q("",!0)],512)),[[P,i.value]]),i.value!=="all"?(u(),r("button",{key:1,type:"button",class:"collapse-btn",onClick:o[3]||(o[3]=Z(e=>l.value=!l.value,["prevent"]))},[l.value?(u(),r(z,{key:0},[Q("Collapse "),Ae],64)):(u(),r(z,{key:1},[Q("Expand "),Me],64))])):q("",!0)]),S(t("div",null,[G(pe,{onUpdateOptions:o[4]||(o[4]=e=>j.value=e),defaultSelected:c.query?.catalog},null,8,["defaultSelected"])],512),[[F,i.value==="CatPrez"&&l.value]]),S(t("div",null,[G(Ce,{onUpdateOptions:o[5]||(o[5]=e=>j.value=e),defaultSelected:{dataset:c.query?.dataset,collection:c.query?.collection}},null,8,["defaultSelected"])],512),[[F,i.value==="SpacePrez"&&l.value]]),S(t("div",null,[G(Oe,{onUpdateOptions:o[6]||(o[6]=e=>j.value=e),defaultSelected:c.query?.vocab},null,8,["defaultSelected"])],512),[[F,i.value==="VocPrez"&&l.value]]),l.value?(u(),r("button",Qe,[Q("Search "),Fe])):q("",!0)],2)],32))}});const Je=ce(Ge,[["__scopeId","data-v-2a1f0183"]]);export{Je as A};
