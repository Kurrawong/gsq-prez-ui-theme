import{d as M,c as o,F as j,r as A,h as a,e as k,w as N,a as x,t as g,f as $,b as y,R as E,v as ue,q as z,_ as K,x as m,k as q,y as ie,z as ne,A as ce,B as pe,p as de,j as ve,m as J,C as fe,i as Z,D as he,u as _e,E as ge,G as be,H as me,I as Q,o as ke,J as Pe,K as ye,L as $e,S as Ce,T as Le,M as Ie,N as xe,O as V,l as Se,P as ze,Q as we,U as je,V as Be}from"./index-b30f1d84.js";import{P as Te}from"./SortableTabularList.vue_vue_type_style_index_0_scoped_c914986c_lang-1ed53b1a.js";import{E as Re,L as Ne}from"./LoadingMessage-e2ab0b21.js";const Ee={class:"list"},Ve={class:"list-item-left"},De={class:"list-item-title"},Fe={key:0,class:"list-item-desc"},ee=200,Ae=M({__name:"ItemList",props:{items:{},childName:{},childLink:{}},setup(C){const s=C;return(h,b)=>(a(),o("div",Ee,[(a(!0),o(j,null,A(s.items,p=>(a(),k(y(E),{class:"list-item",to:p.link?p.link:""},{default:N(()=>[x("div",Ve,[x("h4",De,g(p.title||p.iri),1),p.description?(a(),o("div",Fe,g(p.description.length>=ee?p.description.slice(0,ee)+"...":p.description),1)):$("",!0)]),s.childLink?(a(),k(y(E),{key:0,onClick:b[0]||(b[0]=ue(()=>{},["stop"])),to:p.link+s.childLink,class:"btn outline sm child-btn"},{default:N(()=>[z(g(s.childName),1)]),_:2},1032,["to"])):$("",!0)]),_:2},1032,["to"]))),256))]))}});const Me=K(Ae,[["__scopeId","data-v-2f043e05"]]),ae=C=>(de("data-v-94c14714"),C=C(),ve(),C),Ue={class:"pagination"},Oe={key:1},We=ae(()=>x("i",{class:"fa-regular fa-ellipsis"},null,-1)),Qe=[We],qe=["value"],Ke={key:4},Ge=ae(()=>x("i",{class:"fa-regular fa-ellipsis"},null,-1)),He=[Ge],Je=M({__name:"PaginationComponent",props:{totalCount:{},perPage:{},currentPage:{},url:{}},setup(C){const s=C,h=m(s.currentPage),b=m(Number(s.perPage)),p=q(()=>Math.ceil(s.totalCount/b.value));return ie(h,(e,S)=>{e!==S&&pe.push(`${s.url}?page=${e}&per_page=${b.value}`)}),(e,S)=>(a(),o("div",Ue,[s.currentPage>2?(a(),k(y(E),{key:0,to:`${s.url}?page=1&per_page=${b.value}`,class:"btn outline pagination-btn"},{default:N(()=>[z(" 1 ")]),_:1},8,["to"])):$("",!0),s.currentPage>3?(a(),o("div",Oe,Qe)):$("",!0),s.currentPage>1?(a(),k(y(E),{key:2,to:`${s.url}?page=${s.currentPage-1}&per_page=${b.value}`,class:"btn outline pagination-btn"},{default:N(()=>[z(g(s.currentPage-1),1)]),_:1},8,["to"])):$("",!0),ne(x("select",{class:"pagination-btn",name:"",id:"",title:"Select page","onUpdate:modelValue":S[0]||(S[0]=r=>h.value=r)},[(a(!0),o(j,null,A([...Array(p.value)].map((r,P)=>P+1),r=>(a(),o("option",{value:r},g(r),9,qe))),256))],512),[[ce,h.value]]),s.currentPage<p.value?(a(),k(y(E),{key:3,to:`${s.url}?page=${s.currentPage+1}&per_page=${b.value}`,class:"btn outline pagination-btn"},{default:N(()=>[z(g(s.currentPage+1),1)]),_:1},8,["to"])):$("",!0),s.currentPage<p.value-2?(a(),o("div",Ke,He)):$("",!0),s.currentPage<p.value-1?(a(),k(y(E),{key:5,to:`${s.url}?page=${p.value}&per_page=${b.value}`,class:"btn outline pagination-btn"},{default:N(()=>[z(g(p.value),1)]),_:1},8,["to"])):$("",!0)]))}});const Xe=K(Je,[["__scopeId","data-v-94c14714"]]),Ye={key:0,class:"fa-solid fa-arrow-up-a-z"},Ze={key:1,class:"fa-solid fa-arrow-down-z-a"},et={key:2,class:"fa-thin fa-arrow-up-a-z"},tt=M({__name:"ItemListSortButton",props:{id:{},state:{type:[Boolean,null]}},setup(C){return(s,h)=>(a(),o("span",{class:"pointer",onClick:h[0]||(h[0]=b=>s.$emit("clicked",s.id))},[s.state===!0?(a(),o("i",Ye)):s.state===!1?(a(),o("i",Ze)):(a(),o("i",et))]))}}),at=K(tt,[["__scopeId","data-v-01076186"]]),st={class:"table",role:"grid"},lt={role:"row"},rt={class:"row",role:"row"},ot={key:1},ut={key:2},it=["href"],nt=M({__name:"SortableTabularList",props:{items:{},predicates:{}},setup(C){const s=C,h=m("title-asc"),b=q(()=>["title",...s.predicates]),p=q(()=>{const[r,P]=h.value.split("-"),u=P==="asc";return s.items.sort((l,w)=>{if(r==="title"||r==="description")return l[r]&&w[r]?u?l[r].localeCompare(w[r]):w[r].localeCompare(l[r]):l[r]?u?-1:1:w[r]?u?1:-1:0;if(l.extras[r]&&w.extras[r]){const t=l.extras[r].label,U=w.extras[r].label;return u?t.localeCompare(U):U.localeCompare(t)}else return l.extras[r]?u?-1:1:w.extras[r]?u?1:-1:0})});function e(r){h.value.startsWith(r)?h.value=`${r}-${h.value.endsWith("asc")?"desc":"asc"}`:h.value=`${r}-asc`}function S(r){const P=r.replace(/([A-Z])/g," $1");return P.charAt(0).toUpperCase()+P.slice(1)}return(r,P)=>(a(),o("table",st,[x("thead",null,[x("tr",lt,[(a(!0),o(j,null,A(b.value,u=>(a(),o("th",null,[z(g(S(u))+"Â  ",1),J(at,{id:u,state:h.value.startsWith(u)?h.value.endsWith("asc"):null,onClicked:P[0]||(P[0]=l=>e(l))},null,8,["id","state"])]))),256))])]),x("tbody",null,[(a(!0),o(j,null,A(p.value,u=>(a(),o("tr",rt,[(a(!0),o(j,null,A(b.value,l=>(a(),o("td",null,[l==="title"?(a(),k(y(E),{key:0,to:u.link?u.link:""},{default:N(()=>[z(g(u.title||u.iri),1)]),_:2},1032,["to"])):l==="description"&&u.description?(a(),o("div",ot,g(u.description.substring(0,80)+"..."),1)):u.extras[l]?(a(),o("div",ut,[u.extras[l].iri?(a(),o("a",{key:0,href:u.extras[l].iri,target:"_blank",rel:"noopener noreferrer"},g(u.extras[l].label),9,it)):(a(),o(j,{key:1},[z(g(u.extras[l].label),1)],64)),u.extras[l].color?(a(),o("span",{key:2,style:fe({color:u.extras[l].color,marginLeft:"6px"}),class:"fa-solid fa-circle fa-2xs"},null,4)):$("",!0)])):$("",!0)]))),256))]))),256))])]))}}),te=K(nt,[["__scopeId","data-v-c914986c"]]),ct={class:"page-title"},pt=["href"],dt={key:0},_t=M({__name:"ItemListView",setup(C){const{namedNode:s,literal:h}=Be,b=Z(Ie),p=Z(xe),e=he(),S=_e(),{loading:r,error:P,apiGetRequest:u}=ge(),{store:l,parseIntoStore:w,qnameToIri:t,iriToQname:U}=be(),se=[t("dcat:Catalog"),t("dcat:Dataset"),t("skos:ConceptScheme"),t("skos:Collection"),t("prof:Profile"),t("prez:CatPrezProfile"),t("prez:SpacePrezProfile"),t("prez:VocPrezProfile")],B=m([]),d=m({uri:"",label:""}),G=m(0),D=m(!1),L=m(null),X=m(null),T=m(!1);m({});const F=m({showButton:!1,buttonTitle:"",buttonLink:""}),O=m(Number(p)),H=m({}),le=q(()=>e.query&&e.query.page?parseInt(e.query.page):1);function I(i){switch(d.value.uri=i,i){case t("dcat:Catalog"):d.value.label="Catalogs",T.value=!0,F.value={showButton:!0,buttonTitle:"Resources",buttonLink:"/resources"};break;case t("dcat:Resource"):d.value.label="Resources",T.value=!0;break;case t("dcat:Dataset"):d.value.label="Datasets",T.value=!0,F.value={showButton:!0,buttonTitle:"Collections",buttonLink:"/collections"};break;case t("geo:FeatureCollection"):d.value.label="Feature Collections",T.value=!0,F.value={showButton:!0,buttonTitle:"Features",buttonLink:"/items"};break;case t("geo:Feature"):d.value.label="Features",T.value=!0;break;case t("skos:ConceptScheme"):d.value.label="Vocabularies",T.value=!0;break;case t("skos:Collection"):d.value.label="Collections";break;case t("prof:Profile"):case t("prez:CatPrezProfile"):case t("prez:SpacePrezProfile"):case t("prez:VocPrezProfile"):d.value.label="Profiles";break}}function re(){let i=[];const v=e.path.split("/").slice(1);v.forEach((c,_)=>{const R=l.value.getQuads(null,s(t("dcterms:identifier")),h(c,s(t("prez:identifier"))),null);if(R.length>0){let Y={id:c,uri:R[0].subject.value};Y.title=V(R[0].subject.value,l.value),i.push(Y)}});let n=[];L.value&&n.push({name:Se(L.value)+" Home",url:`/${L.value[0].toLowerCase()}`});let f=!1;return v.forEach((c,_)=>{if(f){f=!1;return}switch(c){case"catalogs":n.push({name:"Catalogs",url:"/c/catalogs"}),_+1!==v.length&&(n.push({name:i[0].title||i[0].uri,url:`/c/catalogs/${e.params.catalogId}`}),f=!0);break;case"resources":n.push({name:"Resources",url:`/c/catalogs/${e.params.catalogId}/resources`});break;case"datasets":n.push({name:"Datasets",url:"/s/datasets"}),_+1!==v.length&&(n.push({name:i[0].title||i[0].uri,url:`/s/datasets/${e.params.datasetId}`}),f=!0);break;case"collections":n.push({name:"Feature Collections",url:`/s/datasets/${e.params.datasetId}/collections`}),_+1!==v.length&&(n.push({name:i[1].title||i[1].uri,url:`/s/datasets/${e.params.datasetId}/collections/${e.params.featureCollectionId}`}),f=!0);break;case"items":n.push({name:"Features",url:`/s/datasets/${e.params.datasetId}/collections/${e.params.featureCollectionId}/items`});break;case"vocab":n.push({name:"Vocabularies",url:"/v/vocab"});break;case"collection":n.push({name:"Collections",url:"/v/collection"});break;case"profiles":n.push({name:"Profiles",url:`${L.value?L.value[0].toLowerCase():""}/profiles`});break}}),D.value&&n.push({name:"Alternate Profiles",url:`${e.path}?_profile=${Q}`}),n}function oe(){let i=[];const v=l.value.getQuads(null,s(t("prez:count")),null,null)[0];if(G.value=parseInt(v.object.value),se.includes(v.subject.value))i=l.value.getSubjects(s(t("a")),v.subject,null),H.value={baseClass:d.value.uri};else{i=l.value.getObjects(v.subject,s(t("dcterms:hasPart")),null);const n=U(ze(e.path.slice(0,e.path.lastIndexOf("/"))).iri);H.value={containerUri:v.subject.value,containerBaseClass:n==="geo:FeatureCollection"?"dcat:Dataset":n}}i.forEach(n=>{let f={iri:n.id,extras:{}};f.title=V(f.iri,l.value),f.description=we(f.iri,l.value),l.value.forEach(c=>{if(c.predicate.value===t("prez:link"))f.link=c.object.value;else if(L.value==="VocPrez"&&c.predicate.value===t("reg:status")){const _={iri:c.object.value,label:V(c.object.value,l.value)||W(c.object.value)};l.value.forObjects(R=>{_.color=R.value},c.object,t("sdo:color"),null),f.extras.status=_}else if(L.value==="VocPrez"&&c.predicate.value===t("prov:qualifiedDerivation"))l.value.forObjects(_=>{const R={iri:_.value,label:V(_.value,l.value)||W(_.value)};f.extras.derivationMode=R},c.object,t("prov:hadRole"),null);else if(d.value.uri===t("dcat:Resource")&&c.predicate.value===t("dcterms:publisher")){const _={iri:c.object.value,label:V(c.object.value,l.value)||W(c.object.value)};f.extras.publisher=_}else if(d.value.uri===t("dcat:Resource")&&c.predicate.value===t("dcterms:creator")){const _={iri:c.object.value,label:V(c.object.value,l.value)||W(c.object.value)};f.extras.creator=_}else if(d.value.uri===t("dcat:Resource")&&c.predicate.value===t("dcterms:issued")){const _={label:c.object.value};f.extras.issued=_}},n,null,null,null),B.value.push(f)}),B.value.sort(je)}function W(i){let v=i.split("#");return v.length===1?v[0].split("/").slice(-1)[0]:v.slice(-1)[0]}return me(()=>{e.path.startsWith("/c/")?(L.value="CatPrez",e.path.match(/c\/profiles/)?I(t("prof:Profile")):e.path.match(/c\/catalogs\/.+\/resources/)?I(t("dcat:Resource")):e.path.match(/c\/catalogs/)&&I(t("dcat:Catalog"))):e.path.startsWith("/s/")&&(L.value="SpacePrez",e.path.match(/s\/profiles/)?I(t("prof:Profile")):e.path.match(/s\/datasets\/.+\/collections\/.+\/items/)?I(t("geo:Feature")):e.path.match(/s\/datasets\/.+\/collections/)?I(t("geo:FeatureCollection")):e.path.match(/s\/datasets/)&&I(t("dcat:Dataset"))),e.path.startsWith("/v/")?(L.value="VocPrez",e.path.match(/v\/profiles/)?I(t("prof:Profile")):e.path.match(/v\/vocab/)?I(t("skos:ConceptScheme")):e.path.match(/v\/collection/)&&I(t("skos:Collection"))):e.path.startsWith("/profiles")&&I(t("prof:Profile")),e.query._profile===Q&&!e.query._mediatype&&(D.value=!0),e.query.per_page&&(O.value=Number(e.query.per_page))}),ke(async()=>{r.value=!0;let i="";Object.keys(e.query).length>0?(i=e.fullPath,D.value&&(i=i.replace(`_profile=${Q}`,"")),e.query.per_page||(i+=`&per_page=${O.value}`)):i=`${e.path}?per_page=${O.value}`;const{data:v,profiles:n}=await u(i);v&&n.length>0&&!P.value&&(X.value=S.profiles[n.find(f=>f.current).uri],e.query&&e.query._profile&&(e.query._mediatype||![X.value.token,Q].includes(e.query._profile))&&window.location.replace(`${b}${e.path}?_profile=${e.query._profile}${e.query._mediatype?`&_mediatype=${e.query._mediatype}`:""}`),S.rightNavConfig={enabled:!D.value,profiles:n,currentUrl:e.path},w(v),await Pe(),oe(),document.title=`${d.value.label} | Prez`,S.breadcrumbs=re())}),(i,v)=>D.value?(a(),k(Te,{key:0})):(a(),o(j,{key:1},[x("h1",ct,g(d.value.label),1),x("p",null,[z("A list of "),x("a",{href:d.value.uri,target:"_blank",rel:"noopener noreferrer"},g(d.value.label)+".",9,pt)]),!y(r)&&B.value.length>0?(a(),o("p",dt,"Showing "+g(B.value.length)+" of "+g(G.value)+" items.",1)):$("",!0),y(P)?(a(),k(Re,{key:1,message:y(P)},null,8,["message"])):y(r)?(a(),k(Ne,{key:2})):B.value.length>0?(a(),o(j,{key:3},[L.value==="VocPrez"?(a(),k(te,{key:0,items:B.value,predicates:["description","status","derivationMode"]},null,8,["items"])):d.value.uri===y(t)("dcat:Resource")?(a(),k(te,{key:1,items:B.value,predicates:["publisher","creator","issued"]},null,8,["items"])):(a(),k(Me,{key:2,items:B.value,childName:F.value.buttonTitle,childLink:F.value.buttonLink},null,8,["items","childName","childLink"])),J(Xe,{url:y(e).path,totalCount:G.value,currentPage:le.value,perPage:O.value},null,8,["url","totalCount","currentPage","perPage"])],64)):(a(),o(j,{key:4},[z("No "+g(d.value.label)+" found.",1)],64)),T.value?(a(),k(Le,{key:5,to:"#search-teleport"},[J(Ce,ye($e(H.value)),null,16)])):$("",!0)],64))}});export{_t as default};
