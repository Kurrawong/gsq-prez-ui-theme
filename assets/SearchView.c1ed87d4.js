import{_ as E}from"./MapClient.vue_vue_type_script_setup_true_lang.e1a63fa6.js";import{d as M,i as U,M as V,u as $,s as z,v as P,x as f,y as D,o as F,c as r,l as G,b as _,e as y,F as b,a as e,r as K,f as k,B as O,h as s,w as T,t as j,p as H,j as W,D as J,N as Q,_ as X}from"./index.6f5c308d.js";import{A as Y}from"./AdvancedSearch.da6fa321.js";import{E as Z}from"./ErrorMessage.f3d82b45.js";const i=p=>(H("data-v-cab33332"),p=p(),W(),p),ee=i(()=>e("h1",{class:"page-title"},"Advanced Search",-1)),se=i(()=>e("h3",null,"Loading...",-1)),te=i(()=>e("span",{class:"loading-icon"},null,-1)),ae={key:2,class:"container"},le={class:"left-panel"},oe=i(()=>e("h2",null,"Results",-1)),re=i(()=>e("div",{class:"results-cols"},[e("span",null,"Title"),e("span",null,"Source")],-1)),ne={key:0,class:"results"},ue={style:{color:"black"}},ce={key:1},ie={key:0,class:"right-panel"},de=i(()=>e("div",{class:"results-title"},"Spatial Results",-1)),_e=M({__name:"SearchView",setup(p){const{namedNode:w}=J,q=U(O),t=V(),v=$(),{data:C,loading:x,error:S,doRequest:B}=z(),{store:m,prefixes:pe,parseIntoStore:L,qname:a}=P(),N=f(t.query),h=f([]),I=f(),d=f([]);function R(){t.query&&t.query.term&&(h.value=[],d.value=[],B(`${q}${t.fullPath}`,()=>{L(C.value),m.value.forSubjects(n=>{let l=n.value,u,o="",g;m.value.forEach(c=>{[a("skos:prefLabel"),a("dcterms:title"),a("rdfs:label")].includes(c.predicate.value)&&(u=c.object.value),c.predicate.value===a("prez:searchResultSource")&&(o=c.object.value.replace(a("prez:"),"")),c.predicate.value===a("geo:hasGeometry")&&m.value.forEach(A=>{g=A.object.value},c.object,w(a("geo:asWKT")),null,null)},n,null,null,null),h.value.push({uri:l,label:u,source:o}),g&&d.value.push({uri:l,link:`/object?uri=${l}`,label:u||l,fcLabel:"",wkt:g})},null,null,null)}))}return D(()=>t.query,(n,l)=>{Object.keys(n).length>0&&n!==l&&R()},{deep:!0}),F(()=>{v.rightNavConfig={enabled:!1},document.title="Advanced Search | Prez",v.pageHeading={name:"Prez",url:"/"},v.breadcrumbs=[{name:"Advanced Search",url:"/search"}],Object.keys(t.query).length>0&&R()}),(n,l)=>{const u=Q("RouterLink");return s(),r(b,null,[ee,G(Y,{query:N.value,fullPage:""},null,8,["query"]),_(S)?(s(),y(Z,{key:0,message:_(S)},null,8,["message"])):_(x)?(s(),r(b,{key:1},[se,te],64)):_(t).query&&_(t).query.term?(s(),r("div",ae,[e("div",le,[oe,re,h.value.length>0?(s(),r("div",ne,[(s(!0),r(b,null,K(h.value,o=>(s(),y(u,{class:"result",to:`/object?uri=${encodeURIComponent(o.uri)}`},{default:T(()=>[e("span",null,j(o.label||o.uri),1),e("span",ue,j(o.source),1)]),_:2},1032,["to"]))),256))])):(s(),r("p",ce,"No results found."))]),d.value.length?(s(),r("div",ie,[de,d.value.length?(s(),y(E,{key:0,ref_key:"searchMapRef",ref:I,"geo-w-k-t":d.value},null,8,["geo-w-k-t"])):k("",!0)])):k("",!0)])):k("",!0)],64)}}});const ge=X(_e,[["__scopeId","data-v-cab33332"]]);export{ge as default};
